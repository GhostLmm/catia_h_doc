<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPMInterfaces/PublicInterfaces/ENOVQueryResult.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>VPMInterfaces/PublicInterfaces/ENOVQueryResult.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="ENOVQObjectIdentity.html">‚Üê ‰∏ä‰∏ÄÈ°µ: ENOVQObjectIdentity.h</a></div>
        <div><a href="ENOVRegDictionary.html">‰∏ã‰∏ÄÈ°µ: ENOVRegDictionary.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">#ifndef ENOVQueryResult_H
#define ENOVQueryResult_H
// COPYRIGHT DASSAULT SYSTEMES 2003
/** @CAA2Required */
/**********************************************************************/
/* DON T DIRECTLY INCLUDE THIS HEADER IN YOUR APPLICATION CODE. IT IS */
/* REQUIRED TO BUILD CAA APPLICATIONS BUT IT MAY DISAPEAR AT ANY TIME */
/**********************************************************************/

/**  est-ce que VPMInterfaces est la bonne place ??? */ 


#include &quot;CATListPV.h&quot;
#include &quot;CATListOfInt.h&quot;

#include &quot;IUnknown.h&quot;

class CATUnicodeString;

#include &quot;CATListOfCATUnicodeString.h&quot;
#include &quot;GUIDVPMInterfaces.h&quot;
#include &quot;CATAssert.h&quot;
#include &quot;ENOVQObjectIdentity.h&quot;



class ExportedByGUIDVPMInterfaces ENOVQueryResult
 {
private:
   
   //This is to prevent the use of  Copy Constructor and Assignment Operator
   ENOVQueryResult(const ENOVQueryResult &amp;);
   ENOVQueryResult&amp; operator=(const ENOVQueryResult &amp;);
       
  
public:
   /**
    * @nodoc
    */
   ENOVQueryResult( const CATListOfCATUnicodeString &amp; iListOfPathExpressionToValuate );
   /**
    * @nodoc
    */
  ~ENOVQueryResult();
    
   /**
    * @nodoc
    * check if a returned PathExpression is unset.
    * @param iPathExpressionPosition [in]
    * the position in _ListOfPathExpressionToValuate of the path expression
    * @param iValuePosition [in]
    * the position of the value in the ordered result.
    * It should be between 1 and _Max_Size
    * @param oStatusValue [out]
    * 1 if it is UNSET , if it is SET.
    * @return
    * An HRESULT value. 
    *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
    *   &lt;dl&gt;
    *     &lt;dt&gt;S_OK&lt;/dt&gt;
    *     &lt;dd&gt;&lt;/dd&gt;
    *     &lt;dt&gt;E_FAIL&lt;/dt&gt;
    *     &lt;dd&gt;invalid parameter&lt;/dd&gt;
    *   &lt;/dl&gt;		
    */ 
   HRESULT isUNSET(int   iPathExpressionPosition  ,
                   int   iValuePosition           ,
                   int &amp; oStatusValue             );
    
   CATListOfInt                 _PathExpressionTypes          ;
   CATListOfCATUnicodeString    _ListOfPathExpressionToValuate;
   CATListOfENOVQObjectIdentity _ListRootIdentifiers          ;
   CATRawCollPV *               _ValuesList                   ;

   /**
    * @nodoc
    */
   int **   _ValuesStatus;
   /**
    * @nodoc
    */
   int      _Max_Size;

 public:
   /**
    * @nodoc
    */
   void RemoveQId( const ENOVQObjectIdentity &amp; QId );

 };


enum  ENOVPEType
{
     PE_UNKNOWN                      ,
     PE_BOOLEAN                      ,
     PE_INTEGER                      ,
     PE_REAL                         ,
     PE_STRING                       ,
     PE_BINARY                       ,
     PE_DATE                         ,
     PE_OBJECT                       ,
     PE_AGGR_BOOLEAN                 ,
     PE_AGGR_INTEGER                 ,
     PE_AGGR_REAL                    ,
     PE_AGGR_STRING                  ,
     PE_AGGR_BINARY                  ,
     PE_AGGR_DATE                    ,
     PE_AGGR_OBJECT                   
} ;  



/*
This function do the same thing as the function intToIndex in
QueryManager/ProtectedInterfaces/BitMaskUtilities.
Need to redefine it here because could not prereq QM in VPMIInterfaces
It returns -1 if the given position is out of range [0;31]. 
*/


inline  int ExportedByGUIDVPMInterfaces  intToPosition(int iInt)
{
  switch(iInt)
   {
   case 0  : return 0x80000000;
   case 1  : return 0x40000000;
   case 2  : return 0x20000000;
   case 3  : return 0x10000000;
   case 4  : return 0x08000000;
   case 5  : return 0x04000000;
   case 6  : return 0x02000000;
   case 7  : return 0x01000000;
   case 8  : return 0x00800000;
   case 9  : return 0x00400000;
   case 10 : return 0x00200000;
   case 11 : return 0x00100000;
   case 12 : return 0x00080000;
   case 13 : return 0x00040000;
   case 14 : return 0x00020000;
   case 15 : return 0x00010000;
   case 16 : return 0x00008000;
   case 17 : return 0x00004000;
   case 18 : return 0x00002000;
   case 19 : return 0x00001000;
   case 20 : return 0x00000800;
   case 21 : return 0x00000400;
   case 22 : return 0x00000200;
   case 23 : return 0x00000100;
   case 24 : return 0x00000080;
   case 25 : return 0x00000040;
   case 26 : return 0x00000020;
   case 27 : return 0x00000010;
   case 28 : return 0x00000008;
   case 29 : return 0x00000004;
   case 30 : return 0x00000002;
   case 31 : return 0x00000001;
     // @anchor err_15 CATAssert ? { CATAssert(/*0&lt;=iInt &amp;&amp; */iInt&lt;32); return 1U&lt;&lt;(31-iInt); }
   default : CATAssert(0) ;
   }
  return -1;
};




 
/**
 * @nodoc
 * RemoveAStatus:
 *  1- Removes the Status of the BIT positioned at iIndex;
 *     iIndex Must be between 1 and _Max_Size 
 *     (because it refers to Query Results Index )
 *  2- Shifts the following BITs by one slot (one BIT) to the Left
 *    
 */

HRESULT  ReorganizeBitSequence(int iIndex, int &amp; iStatusArray_Size, int* &amp; ioStatusArray);



     
   /**
    * @nodoc
    * returns an int corresponding to a specific BITs sequence 
    * iPos MUST be between 0 and 31
    * The trown int has 1 set as BIT from pos 0 to the given iPos
    * Sample : 
    * The 4th element corresponds to the element that has 
    * all its BITS from 0 to 4 position set to 1 (there are 5 bits set to 1)
    * |1111100000...0 |
    * 0   
    */
   
 unsigned  int getLeft(int iPos);
   
   /**
    * @nodoc
    * returns the iPos Elements of _Right
    * iPos MUST be between 0 and 31
    * The 5th element corresponds to the element that has 
    * all its BITS from 31 to 27 position set to 1 (there are 5 bits set to 1)
    * | 00000...011111 |
    * 0
    * We count the Bit from the postion 31
    */   
   
 unsigned  int getRight(int iPos);










#endif



</div>
    
    <div class="navigation">
        <div><a href="ENOVQObjectIdentity.html">‚Üê ‰∏ä‰∏ÄÈ°µ: ENOVQObjectIdentity.h</a></div>
        <div><a href="ENOVRegDictionary.html">‰∏ã‰∏ÄÈ°µ: ENOVRegDictionary.h ‚Üí</a></div>
    </div>
</body>
</html>