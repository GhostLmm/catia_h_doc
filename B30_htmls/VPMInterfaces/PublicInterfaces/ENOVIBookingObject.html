<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPMInterfaces/PublicInterfaces/ENOVIBookingObject.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>VPMInterfaces/PublicInterfaces/ENOVIBookingObject.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="ENOVIAttachGCoEvent.html">‚Üê ‰∏ä‰∏ÄÈ°µ: ENOVIAttachGCoEvent.h</a></div>
        <div><a href="ENOVIChangeOwnerEvent.html">‰∏ã‰∏ÄÈ°µ: ENOVIChangeOwnerEvent.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">// COPYRIGHT DASSAULT SYSTEMES 2000
//=============================================================================
//
// ENOVIBookingObject.h
// Check the contraints on an object.Book the object if there is no violated
// constraint.
//=============================================================================
//=============================================================================
// November 2000     Creation                  SMI
//=============================================================================
#ifndef ENOVIBookingObject_h
#define ENOVIBookingObject_h

class CATTimeSpan;
#include &quot;CATUnicodeString.h&quot;
#include &quot;CATBaseUnknown.h&quot;
#include &quot;GUIDVPMInterfaces.h&quot;


#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByGUIDVPMInterfaces IID IID_ENOVIBookingObject;
#else
extern &quot;C&quot; const IID IID_ENOVIBookingObject;
#endif

/**
 * @CAA2Level L1 
 * @CAA2Usage U3
 */ 

class ENOVIObjectInfo ;

class ExportedByGUIDVPMInterfaces ENOVIBookingObject : public CATBaseUnknown
{
  CATDeclareInterface;
  
  public :
    
    enum BookState
      {
	BOOKED         = 1 ,   // the object is created in the database or
	                       // the object is booked for the user.
  
	BOOKABLE       = 2 ,   // the object is free to be booked or,
			       // the object has been booked in another session or,
			       // the object has been booked in another session but 
			       // the delay expired
      
	NOTBOOKABLE    = 3     // someone has booked the object or,
			       // another object has booked the constraints in your session.
      };
  
  // S_OK   : the object is booked
  // S_FALSE: the object has not been booked return the faulty object if exists
  // E_FAIL : system error
  virtual HRESULT bookObject (CATBaseUnknown_var&amp; oObject       ,
			      const CATTimeSpan * tDelay = NULL)=0;
  
  // S_OK   : all booking are destroyed
  // S_FALSE: a booking can t be destroyed then no booking has been destroyed
  // E_FAIL : system error
  virtual HRESULT deleteObjectBooking()=0;
  
  // change the value of the expiration delay.
  virtual HRESULT setDefaultDelay(const CATTimeSpan * tDefaultDelay)=0;
  
  // get the BookState of the object.
  // if BookState is NOTBOOKABLE the ownerOfTheBooking (logical user) is valuated
  // if return code is E_FAIL then status and ownerOfTheBooking aren t valuated.
  virtual HRESULT isObjectBooked (BookState&amp;        status           ,
				  CATUnicodeString&amp; ownerOfTheBooking)=0;

  // S_OK   : The attribute iAttribute is valuated with a generated identifier (VPMIIdentifierGeneratorMgr)
  // S_FALSE: The attribute is already valuated, use iForce=1 if you want replace the value.
  // E_FAIL : system error
  virtual HRESULT SetIdentifierValue(const CATUnicodeString&amp; iAttribute, const int iForce=0)=0;


  //-- JDC+ V5R11. ID GENERATION + BOOKING coupling. 
  /**
   * book the object with an already created Booking (see
   * VPMIBookingManager::CreateNBookingWithConsecutiveIDs).
   * @param iAssignee [in] the string owning the booking
   * @param iForce [in] to force the use of the booking
   * @return
   * S_OK: the object can use the booking
   * S_FALSE: the booking is in use or the booking doesn&#x27;t exist
   * E_FAIL
   */
  virtual HRESULT UseBooking(const CATUnicodeString&amp; iAssignee,
                             int                     iForce   =0)=0;
  
  //-- JDC- V5R11. ID GENERATION + BOOKING coupling. 
};
                                              
                                                
CATDeclareHandler(ENOVIBookingObject, CATBaseUnknown); 
#endif 







</div>
    
    <div class="navigation">
        <div><a href="ENOVIAttachGCoEvent.html">‚Üê ‰∏ä‰∏ÄÈ°µ: ENOVIAttachGCoEvent.h</a></div>
        <div><a href="ENOVIChangeOwnerEvent.html">‰∏ã‰∏ÄÈ°µ: ENOVIChangeOwnerEvent.h ‚Üí</a></div>
    </div>
</body>
</html>