<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPMInterfaces/PublicInterfaces/CATIVpmQuery.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>VPMInterfaces/PublicInterfaces/CATIVpmQuery.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATIVpmPredicate.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIVpmPredicate.h</a></div>
        <div><a href="CATIVpmSCLogin.html">‰∏ã‰∏ÄÈ°µ: CATIVpmSCLogin.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">//=============================================================================
// COPYRIGHT DASSAULT SYSTEMES 2001
//=============================================================================
#ifndef CATIVpmQuery_h_
#define CATIVpmQuery_h_

///////////////////////////////////////////////////////////////////////////////
//   PROJECT:...........VPM                                                  //
//   FRAMEWORK:.........                                                     //
//   AUTHOR:............Ivan Sarti (IDC Ltd., for Dassault Systemes)         //
//   DATE:..............17/06/1997                                           //
//             -----------------------------------------------               //
//   AUTHOR:............Ivan Sarti                                           //
//   MODIFICATION:......Added new method, ListOf.                            //
//   DATE:..............23/06/97                                             //
//             -----------------------------------------------               //
//   AUTHOR:............Jerome Poitreau                                      //
//   MODIFICATION:......Review                                               //
//   DATE:..............27/06/97                                             //
///////////////////////////////////////////////////////////////////////////////


// ========================================================================= //
//   COMMENT                                                                 //
//   =======                                                                 //
// ========================================================================= //
//#define WANT_DICTIONARY

#include &quot;CATBaseUnknown.h&quot;
#include &quot;CATLISTV_CATBaseUnknown.h&quot;
#include &quot;CATUnicodeString.h&quot;
#include &quot;CATListOfCATUnicodeString.h&quot;

#include &quot;CATIVpmPathExpression.h&quot;
#include &quot;CATIVpmPredicate.h&quot;
#include &quot;GUIDVPMInterfaces.h&quot;

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByGUIDVPMInterfaces IID IID_CATIVpmQuery;
#else
extern &quot;C&quot; const IID IID_CATIVpmQuery;
#endif

/**
 *  @CAA2Level L1
 *  @CAA2Usage U3
 */ 

/**
 * This class supplies methods to manage queries.
 * &lt;b&gt;role&lt;/b&gt;: This class enables to get all information related to the query definition
 * &lt;b&gt;warning&lt;/b&gt;: To use this interface, do not consider only the module and framework shown at the bottom of this
 * page. 
 * You must also add the GUIDVPMQueryBuilder module in your Imakefile.mk file, and the framework VPMQueryBuilder in your 
 * framework Identity card.
 */

class ExportedByGUIDVPMInterfaces CATIVpmQuery : public CATBaseUnknown
{
    // --&gt; RTTI
	CATDeclareInterface;

  public:
    // --&gt; Obvious queries ...
	// 1 - depending on query type:
/**
 * @nodoc
 */
    virtual int                          IsMultiObject() = 0;
	// 1 - a) for single-object queries
/**
 * @nodoc
 */
    virtual CATUnicodeString             GetEntity() = 0;
/**
 * @nodoc
 */
    virtual CATIVpmPathExpression_var    GetFromList() = 0;
/**
 * @nodoc
 */
    virtual CATUnicodeString             GetOrderBy() = 0;
/**
 * @nodoc
 */
    virtual CATIVpmPredicate_var         GetPredicate() = 0;
	// 1 - b) for multi-objects queries
/**
 * @nodoc
 */
    virtual HRESULT  GetEntity(CATListOfCATUnicodeString      &amp;oObjList) = 0;
/**
 * @nodoc
 */
    virtual HRESULT  GetFromList(CATLISTV(CATBaseUnknown_var) &amp;oFromList) = 0;
/**
 * @nodoc
 */
    virtual HRESULT  GetPredicate(CATLISTV(CATBaseUnknown_var) &amp;oPredicates) = 0;
/**
 * Specifies that the query will be non case sensitive.
 */
    virtual HRESULT  SetCaseUnsensitive() = 0;
/**
 * Specifies that the query will be case sensitive.
 */
    virtual HRESULT  SetCaseSensitive() = 0;
/**
 * @nodoc
 */
    virtual int      IsCaseUnsensitive()  = 0;


 /**
  *  Sets the time limit over which the Query will be stopped.
  *
  *  @param iTime
  *  This time value should be given in second.
  *  If  &lt;tt&gt; iTime &lt;/tt&gt; is &amp;lt= 0 , the query will not be interrupted
  *  and the @href #GetTimeLimit returns 0. 
  *
  *  @return S_OK in all cases
 */
	virtual  HRESULT   SetTimeLimit (int iTime )  = 0;

        
        
	
 /**
  *  Gets the time limit over which the Query will be stopped.
  *
  *  @return The current time limit value expressed in second.
  *  If it returns 0 (the default value), then the query keeps
  *  running until it ends. 
  * 
  */
	virtual int  GetTimeLimit()  = 0;




};



CATDeclareHandler(CATIVpmQuery,CATBaseUnknown);



/**
 * Creates a Query.
 * @param iEntityName  : Query result type
 * @param iFromList    : Query scope      
 * @param iWhereClause : Where clause
 * @param iOrderBy     : Attribute name accroding to which the result will be sorted
 * @return : The created CATIVpmQuery_var handler
 */
extern ExportedByGUIDVPMInterfaces
    CATIVpmQuery_var CreateQuery(const CATUnicodeString    &amp;iEntityName,
				 CATIVpmPathExpression_var iFromList,
				 CATIVpmPredicate_var      iWhereClause,
				 const char                *iOrderBy = &quot;&quot;);
/**
 * Creates a multi-objects query.
 * @param iEntityNames : List of query result types
 * @param iFromList    : List of Query scopes     
 * @param iPredicates  : List of predicates
 * @param oQuery       : The list of created query handlers
 * @return : The created CATIVpmQuery_var handler
 */
extern ExportedByGUIDVPMInterfaces
    HRESULT CreateQuery(CATIVpmQuery_var                   &amp;oQuery,
			const CATListOfCATUnicodeString    &amp;iEntityNames,
			const CATLISTV(CATBaseUnknown_var) &amp;iFromList,
			const CATLISTV(CATBaseUnknown_var) &amp;iPredicates);

#endif // CATIVpmQuery_h_

</div>
    
    <div class="navigation">
        <div><a href="CATIVpmPredicate.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIVpmPredicate.h</a></div>
        <div><a href="CATIVpmSCLogin.html">‰∏ã‰∏ÄÈ°µ: CATIVpmSCLogin.h ‚Üí</a></div>
    </div>
</body>
</html>