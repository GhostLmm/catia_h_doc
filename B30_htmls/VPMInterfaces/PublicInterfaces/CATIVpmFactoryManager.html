<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPMInterfaces/PublicInterfaces/CATIVpmFactoryManager.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>VPMInterfaces/PublicInterfaces/CATIVpmFactoryManager.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATIVpmAttribute.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIVpmAttribute.h</a></div>
        <div><a href="CATIVpmFactoryObject.html">‰∏ã‰∏ÄÈ°µ: CATIVpmFactoryObject.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">// --------------------------------------------------------            
// VPM (c) Copyright Dassault Systemes 1996                           
// -------------------------------------------------------------       
// Responsable: AHC                                                     
// --------------------------------------------------------------       
// Macro: CATIVpmFactoryManager.h                                      
// --------------------------------------------------------------       
// Contenu:  VPM Manager, gestion des objets du VPM         
// --------------------------------------------------------------       
// Historique:                                                          
// Creation : 96/09/12 &gt; AHC                                           
// --------------------------------------------------------------       
//
/**
*	@CAA2Level L1
*	@CAA2Usage U3
*/
#ifndef CATIVpmFactoryManager_H_
#define CATIVpmFactoryManager_H_
//
#include &quot;GUIDVPMInterfaces.h&quot;
#include &quot;CORBAAnyDef.h&quot;
#include &quot;sequence_CORBAAny.h&quot;
#include &quot;CATAttributeDescription.h&quot;
#include &quot;CATListOfVPMCA.h&quot;
#include &quot;CATBaseUnknown.h&quot;
#include &quot;CATUnicodeString.h&quot;
#include &quot;CATInterfaceObject.h&quot;
#include &quot;CATLISTV_CATBaseUnknown.h&quot;
#include &quot;CATLISTV_sequence_octet.h&quot;
#include &quot;CATListOfCATIVpmFactoryObject.h&quot;
#include &quot;CATIVpmQuery.h&quot;

#include &quot;GUIDVPMInterfaces.h&quot;

#include &quot;ENOVQueryResult.h&quot;
#include &quot;CATListOfENOVFetchedRange.h&quot;

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByGUIDVPMInterfaces IID IID_CATIVpmFactoryManager ;
#else
extern &quot;C&quot; const IID IID_CATIVpmFactoryManager ;
#endif

class CATIVpmPropertiesManager_var ;
class CATIVpmObjectRules_var ;
class CATIVpmObjectPool_var ;
class CATIVpmGraphMng_var ;
class ENOVIObjectInfo_var ;
class CATIContainer_var ;

class ENOVQueryResult;

//
// -------------------------------
// Definition de la classe Interface
// -------------------------------
//
/**
 * Interface to the VPM factory manager.
 * &lt;b&gt;Role&lt;/b&gt;: This interface manages the environment, creates, 
retrieves, loads, and binds objects,
 * runs queries, and retrieves a pool manager.   
 */
class ExportedByGUIDVPMInterfaces CATIVpmFactoryManager : public CATBaseUnknown   
  {
  //
  CATDeclareInterface;
  //
  public:
  // Manage the current Environment
  //---------------------------------------------------------

/**
*   Push the environment.
*   @param iEnvironment
*   The name of the environment.
*   @return
*   An HRESULT value. 
*   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
*   &lt;dl&gt;
*     &lt;dt&gt;S_OK&lt;/dt&gt;
*     &lt;dd&gt;Push successful&lt;/dd&gt;
*     &lt;dt&gt;E_FAIL&lt;/dt&gt;
*     &lt;dd&gt;Bad environment&lt;/dd&gt;
*   &lt;/dl&gt;		
*/
  virtual HRESULT push_Environment(const CATUnicodeString&amp; iEnvironment) = 0 ;

/**
*   Pop the environment.
*   @return
*   An HRESULT value. 
*   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
*   &lt;dl&gt;
*     &lt;dt&gt;S_OK&lt;/dt&gt;
*     &lt;dd&gt;Pop successful&lt;/dd&gt;
*     &lt;dt&gt;E_FAIL&lt;/dt&gt;
*     &lt;dd&gt;No environment found&lt;/dd&gt;
*   &lt;/dl&gt;		
*/
  virtual HRESULT pop_Environment() = 0 ;

/** @nodoc */
  virtual const CATUnicodeString GetCurrentEnvironment() = 0 ;

/**
 * @deprecated V5R14
 *
*   VPMobject Bind.
*   @param iObjectInfo
*   .
*   @param iCont
*   Container to parse.
*   @param iRealObject
*   Object to bind
*   @param oVpmObject
*   VPMObject found
*   @return
*   An HRESULT value. 
*   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
*   &lt;dl&gt;
*     &lt;dt&gt;S_OK&lt;/dt&gt;
*     &lt;dd&gt;VPMObject found&lt;/dd&gt;
*     &lt;dt&gt;E_FAIL&lt;/dt&gt;
*     &lt;dd&gt;VPMObject not found or errors occured during process&lt;/dd&gt;
*   &lt;/dl&gt;		
*/
  virtual HRESULT BindVPMObjectP
                          ( const ENOVIObjectInfo_var&amp;  iObjectInfo    , 
                            const CATIContainer_var&amp;    iCont          , 
                            void*                       iRealObject    ,
                            CATIVpmFactoryObject_var&amp;   oVpmObject     ) = 0 ;

/**
*   VPMobject creation with identifier.
*   @param iDomainName
*   Name of the domain.
*   @param iContainer
*   The receptacle container.
*   @param iLateEntityName
*   The late type of the entity.
*   @param iIdentifier
*   The Identifier.
*   @return
*   The created VPMObject. 
*/
  virtual CATIVpmFactoryObject_var  CreateVPMObjectWithIdentifier
                          ( const CATUnicodeString&amp;  iDomainName     , 
                            const CATIContainer_var&amp; iContainer      ,
                            const CATUnicodeString&amp;  iLateEntityName ,
                            const CORBAAny&amp;          iIdentifier      ) = 0 ;

/**
*   VPMobject creation without identifier.
*   @param iDomainName
*   Name of the domain.
*   @param iContainer
*   The receptacle container.
*   @param iLateEntityName
*   The late type of the entity.
*   @return
*   The created VPMObject. 
*/
  virtual CATIVpmFactoryObject_var  CreateVPMObject
                          ( const CATUnicodeString&amp;  iDomainName , 
                            const CATIContainer_var&amp; iContainer,
                            const CATUnicodeString&amp;  iLateEntityName ) = 0 ;

/**
*   VPMobject Query.
*   @param iQuery
*   The query to run.
*   @param iDomainName
*   Name of the domain.
*   @param iContainer
*   The target container.
*   @param oList
*   The list of objects found.
*   @param iResultLimit
*   .
*   @param iMemory
*   .
*   @return
*   An HRESULT value. 
*   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
*   &lt;dl&gt;
*     &lt;dt&gt;S_OK&lt;/dt&gt;
*     &lt;dd&gt;Query successful&lt;/dd&gt;
*     &lt;dt&gt;E_FAIL&lt;/dt&gt;
*     &lt;dd&gt;VPMObject not found or errors occured during process&lt;/dd&gt;
*   &lt;/dl&gt;		 
*/
  virtual HRESULT RunQuery
		 ( const CATIVpmQuery_var&amp;              iQuery,
		   const CATUnicodeString&amp;              iDomainName,
		   const CATIContainer_var&amp;             iContainer, 
		   CATLISTV(CATBaseUnknown_var)*&amp;       oList,
		   int iResultLimit = 0,
		   int iMemory = 0) = 0;



//Method(s) added on April 2003
  /**
   * @nodoc
   * run a query without building the selected VPMObjects.
   * @param iQuery [in].
   * The query to run.
   * @param iContainer [in].
   * The target container.
   * @param iListOfPathExpressions [in].
   * The path expressions to valuate.
   * @param iSortAttr [in].
   * The path expression needed to sort the output result.
   * @param oQueryResult [out].
   * The query result .
   * @param iResultLimit [in].
   * the max number of results to select.
   * @param iMemory [in].
   * the query mode .
   */
  virtual  HRESULT RunQuery
		 ( const CATIVpmQuery_var&amp;           iQuery,
		   const CATIContainer_var&amp;          iContainer, 
		   const CATListOfCATUnicodeString &amp; iListOfPathExpressions,
                  const CATUnicodeString&amp; cSortPE,
		   ENOVQueryResult   *             &amp;  oQueryResult,
		   int iResultLimit = 0,
		   int iMemory = 0)= 0;
    
  

//  END Method(s) added on 2003


/**
 * @deprecated V5R14
 *
*   VPMobject Bind.
*   @param iDomainName
*   The name of the domain.
*   @param iContainer
*   Container to parse.
*   @param iRealObjectName
*   Name of the object to bind
*   @param iRealObject
*   Object to bind
*   @return
*   The created VPMObject.
*/
  virtual CATIVpmFactoryObject_var  BindVPMObjectP
                          ( const CATUnicodeString&amp;  iDomainName,
                            const CATIContainer_var&amp; iContainer    ,
                            const CATUnicodeString&amp;  iRealObjectName,
                            void*                    iRealObject    ) = 0;

/**
 * @deprecated V5R14
 *
*   Seek a VPMobject by Identifier.
*   @param iContainer
*   Container to parse.
*   @param iDomainName
*   The name of the domain.
*   @param iLateEntityName
*   Entity late type.
*   @param iIdentifier
*   The Identifier.
*   @return
*   The VPMObject found.
*/
  virtual CATIVpmFactoryObject_var  GetVPMObject
                                 ( const CATIContainer_var&amp; iContainer     ,
                                   const CATUnicodeString&amp;  iDomainName    ,
                                   const CATUnicodeString&amp;  iLateEntityName,
                                   const CORBAAny&amp;          iIdentifier ) = 0 ;

/**
 * @deprecated V5R14
 *
*   Get VPMobject Identifier.
*   @param iDomainName
*   The name of the domain.
*   @param iVPMObject
*   The VPMObject.
*   @return
*   The Identifier.
*/
  virtual CORBAAny  GetIdentifier
                   ( const CATUnicodeString&amp;  iDomainName       ,
                     const CATIVpmFactoryObject_var&amp; iVPMObject ) = 0 ;

  //
  // Get the list of Attributes access.
  //-----------------------------------------------------------------
/** @nodoc */
  virtual CATListOfVPMCA  GetVpmObjectAttributeNames
                  ( const CATUnicodeString&amp;  iDomainName    ,
                    const CATIContainer_var&amp; iContainer      ,
                    const CATUnicodeString&amp;  iLateEntityName , 
                    const AccessControl&amp;     iAccessControl  ) = 0;
  //
  // Get the specific Attribute access 
  //-----------------------------------------------------------------
/** @nodoc */
  virtual VPMCA    GetVpmObjectAttributeName
                  ( const CATUnicodeString&amp;  iDomainName     ,
                    const CATIContainer_var&amp; iContainer      ,
                    const CATUnicodeString&amp;  iLateEntityName , 
                    const CATUnicodeString&amp;  iAttributeName  , 
                    const AccessControl&amp;     iAccessControl  ) = 0;

/**
*   Get a Graph Manager.
*   @param iGraphName
*   The name of the graph.
*   @param iRules
*   .
*   @return
*   The graph manager.
*/
  virtual CATIVpmGraphMng_var GetGraphManager 
                         ( const CATUnicodeString&amp;   iGraphName       , 
                           const CATBaseUnknown_var&amp; iRules)= 0;
  //
  // Get the Property Manager given a Domain name (PEOPLE, PRODUCT, etc)
  //---------------------------------------------------------

/** @nodoc */
  virtual HRESULT GetPropertiesManager
                  ( const CATUnicodeString        &amp;iDomainName,
                    CATIVpmPropertiesManager_var  &amp;oTheMgr) = 0;
  //
  // Get the current Property Manager name (PEOPLE, PRODUCT, etc)
  //---------------------------------------------------------

/** @nodoc */
  virtual HRESULT GetCurrentPropertiesManagerName
                  ( CATUnicodeString&amp; oDomainName ) = 0 ;

/**
*   Get a Pool Manager.
*   @param PoolManager
*   The pool manager found.
*   @return
*   An HRESULT value. 
*   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
*   &lt;dl&gt;
*     &lt;dt&gt;S_OK&lt;/dt&gt;
*     &lt;dd&gt;.&lt;/dd&gt;
*   &lt;/dl&gt;		 
*/
  virtual HRESULT GetPoolManager 
                  (CATIVpmObjectPool_var&amp; PoolManager) = 0 ; 

/**
 * @deprecated V5R14
 *
*   Retrieve VPMobject by Name (Default= All).
*   @param iName
*   The name of the VPMObject (Default= All).
*   @return
*   The list of VPMObjects.
*/
  virtual CATLISTV(CATIVpmFactoryObject_var) GetFactoryObjectList(const CATUnicodeString&amp; iName=&quot;&quot;) = 0 ;

/** @nodoc
 * @deprecated V5R14
 *
*   Retrieve VPMobject related to a Real object.
*   @param iRealObjectHandler
*   A Handler on a real object).
*   @return
*   The VPMObject found.
*/
  virtual CATIVpmFactoryObject_var GetFactoryObject
			(const CATInterfaceObject_var&amp; iRealObjectHandler)= 0 ;

/**
 * @deprecated V5R14
 *
*   Retrieve VPMobject related to a Real object.
*   @param iRealObject
*   A pointer on a real object).
*   @return
*   The VPMObject found.
*/
  virtual CATIVpmFactoryObject_var GetRealObject
			          (void* iRealObject)= 0 ;

/**
 * @deprecated V5R14
 *
*   Retrieve object UUID by domain.
*   @param iDomainName
*   Name of the domain.
*   @param ListOfObjectId
*   The list of octet sequences found.
*   @return
*   An HRESULT value. 
*   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
*   &lt;dl&gt;
*     &lt;dt&gt;S_OK&lt;/dt&gt;
*     &lt;dd&gt;Octet sequences found&lt;/dd&gt;
*     &lt;dt&gt;S_FALSE&lt;/dt&gt;
*     &lt;dd&gt;Empty domain&lt;/dd&gt; 
*     &lt;dt&gt;E_FAIL&lt;/dt&gt;
*     &lt;dd&gt;An error occured during the process&lt;/dd&gt;
*   &lt;/dl&gt;		
*/
  virtual  HRESULT GetObjectIdentifierList ( const CATUnicodeString&amp; iDomainName ,
                                             CATLISTV(_SEQUENCE_octet) &amp; ListOfObjectId ) =0 ;

/**
*   Load objects from their sequence.
*   @param ListOfObjectId
*   The list of octet sequences.
*   @return
*   An HRESULT value. 
*   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
*   &lt;dl&gt;
*     &lt;dt&gt;S_OK&lt;/dt&gt;
*     &lt;dd&gt;Load is OK (in the container of the first object)&lt;/dd&gt; 
*     &lt;dt&gt;E_FAIL&lt;/dt&gt;
*     &lt;dd&gt;Load failed&lt;/dd&gt;
*   &lt;/dl&gt;		
*/
  virtual  HRESULT LoadListOfInstances  ( const CATLISTV(_SEQUENCE_octet) &amp; ListOfObjectId ) =0 ;


/**
*   Load a list of objects linked by reference attribute from a list of object.
*   example :   object  
*             &lt; attref1 --&gt; object1   
*                          &lt; attref2 --&gt;  object 2
*   @param iListOfVPMobject
*   The list of VPM objects.
*   @param iAttributePath
*   string defining attribute path  ( name of attribute separated by dot )   
*   example :  attref1.attref2 
*   current limitation :  all input VPM object must have the same type
*   maximum level of depth is 2   i.e : path = entity::att1.att2  
*   works only for single reference attribute ( reference aggregate not allowed )
*   @return
*   An HRESULT value. 
*   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
*   &lt;dl&gt;
*     &lt;dt&gt;S_OK&lt;/dt&gt;
*     &lt;dd&gt;Load is OK&lt;/dd&gt; 
*     &lt;dt&gt;E_FAIL&lt;/dt&gt;
*     &lt;dd&gt;Load failed&lt;/dd&gt;
*   &lt;/dl&gt;		
*/
  virtual  HRESULT LoadListOfLinkedObject ( CATLISTV(CATBaseUnknown_var)* &amp; iListOfVPMobject, 
	                                        const CATUnicodeString &amp; iAttributPath ) =0 ;


/** @nodoc */
  virtual HRESULT Register 
            ( const CATUnicodeString&amp; iEvent         ,
              const CATIVpmFactoryObject_var&amp; iObject) = 0 ;
  /**
   * @nodoc
   * initializes the query in fetched mode.
   * @param iQuery [in].
   * The query to run.
   * @param iContainer [in].
   * The target container.
   * @param iListOfPathExpressions [in].
   * The path expressions to valuate.
   * @param iSortAttr [in].
   * The path expression needed to sort the output result.
   * @param oQueryResult [out].
   * The query result on the first range.
   * @param oListOfFetchedRanges [out].
   * The computed query ranges.
   * @param oNbSelectedObjectsBeforeSecurity [out].
   * The number of objects selected before having apply the security rules.
   * @param oNbSelectedObjectsAfterSecurity [out].
   * The number of objects selected after having apply the security rules.
   * @param iNbLinesPerPage [in].
   * The number of result per page (or range ) .
   * @return
   *   An HRESULT value. 
   *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
   *   &lt;dl&gt;
   *     &lt;dt&gt;S_OK&lt;/dt&gt;
   *     &lt;dt&gt;E_FAIL&lt;/dt&gt;
   *   &lt;/dl&gt;		
   */
  virtual HRESULT InitFetchedQuery ( const CATIVpmQuery_var&amp;           iQuery,
                                    const CATIContainer_var&amp;          iContainer, 
                                    const CATListOfCATUnicodeString &amp; iListOfPathExpressions,
                                    const CATUnicodeString          &amp; iSortAttr,
                                    ENOVQueryResult   *             &amp; oQueryResult,
                                    CATListOfENOVFetchedRange       &amp; oListOfFetchedRanges,
                                    int&amp;                              oNbSelectedObjectsBeforeSecurity,
                                    int&amp;                              oNbSelectedObjectsAfterSecurity ,						  
                                    int iNbLinesPerPage) =0;
  /**
   * @nodoc
   * executes a query in fetched mode on a specific range.
   * @param iQuery [in].
   * The query to run.
   * @param iContainer [in].
   * The target container.
   * @param iListOfPathExpressions [in].
   * The path expressions to valuate.
   * @param iSortAttr [in].
   * The path expression needed to sort the output result. 
   * @param iWantedRange [in].
   * the requested range of values.
   * @param oQueryResult [out].
   * the query result.
   * @return
   *   An HRESULT value. 
   *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
   *   &lt;dl&gt;
   *     &lt;dt&gt;S_OK&lt;/dt&gt;
   *     &lt;dt&gt;E_FAIL&lt;/dt&gt;
   *   &lt;/dl&gt;		
   */
  virtual HRESULT ExecuteFetchedQuery ( const CATIVpmQuery_var&amp;           iQuery,
                                       const CATIContainer_var&amp;          iContainer, 
                                       const CATListOfCATUnicodeString &amp; iListOfPathExpressions,
                                       const CATUnicodeString          &amp; iSortAttr,
                                       const ENOVFetchedRange * iWantedRange,
                                       ENOVQueryResult   *             &amp; oQueryResult)=0;
  

  
  };
  CATDeclareHandler(CATIVpmFactoryManager,CATBaseUnknown);
//
// --------------------------------------------------------------
// Fin de la macro                                                    
// --------------------------------------------------------------       
#endif








</div>
    
    <div class="navigation">
        <div><a href="CATIVpmAttribute.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIVpmAttribute.h</a></div>
        <div><a href="CATIVpmFactoryObject.html">‰∏ã‰∏ÄÈ°µ: CATIVpmFactoryObject.h ‚Üí</a></div>
    </div>
</body>
</html>