<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPMInterfaces/PublicInterfaces/VPMIBookingManager.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>VPMInterfaces/PublicInterfaces/VPMIBookingManager.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="VPMIAdmin.html">‚Üê ‰∏ä‰∏ÄÈ°µ: VPMIAdmin.h</a></div>
        <div><a href="VPMIIdentifierGeneratorMgr.html">‰∏ã‰∏ÄÈ°µ: VPMIIdentifierGeneratorMgr.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">//
// COPYRIGHT DASSAULT SYSTEMES 1999
//=============================================================================
//
// VPMIBookingManager.h
// Check the contraints on an object.Book the object if there is no violated
// constraint.
// trace             : BOOKINGMANAGER 
//=============================================================================
//=============================================================================
// November 2000     Creation                  JDC
//=============================================================================
#include &quot;GUIDVPMInterfaces.h&quot;

#ifndef VPMIBookingManager_h
#define VPMIBookingManager_h

class CATListPtrSdaiAppInstance;
class CATTimeSpan   ;
class SdaiAppInstance  ;

#include &quot;CATUnicodeString.h&quot;
#include &quot;CATCollec.h&quot;
#include &quot;ENOVIObjectInfo.h&quot;

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByGUIDVPMInterfaces IID IID_VPMIBookingManager;
#else
extern &quot;C&quot; const IID IID_VPMIBookingManager;
#endif
/**
 * @CAA2Level L1 
 * @CAA2Usage U3
 */ 
class ExportedByGUIDVPMInterfaces VPMIBookingManager : public CATBaseUnknown
{
  CATDeclareInterface;
  
  public :
    
  enum BookState
    {
      BOOKED         = 1 ,   // the object is created in the database or
                             // the object is booked for the user.
  
      BOOKABLE       = 2 ,   // the object is free to be booked or,
                             // the object has been booked in another session or,
                             // the object has been booked in another session but 
                             // the delay expired
      
      NOTBOOKABLE    = 3     // someone has booked the object or,
                             // another object has booked the constraints in your session.
    };
  
  //
  //methods called by the VPMSession
  //
  //
  virtual HRESULT init(int mode = 0)=0 ;
  virtual HRESULT end()=0           ;
  // 
  
public:
  // try to book a list of instances. if tDelay is not set,then use the default delay
  // value for the expiration date
  //
  // S_OK   : all objects are booked
  // S_FALSE: an object can&#x27;t be booked then no object has been booked
  // E_FAIL : system error
  virtual HRESULT bookObjects(const CATListPtrSdaiAppInstance * lObjects     ,
			      const CATTimeSpan *              tDelay = NULL)=0;
  // S_OK   : the object is booked
  // S_FALSE: the object has not been booked return the faulty object if exists
  // E_FAIL : system error
  virtual HRESULT bookObject (SdaiAppInstance *  iObject       ,
			      SdaiAppInstance *&amp; oObject       ,
			      const CATTimeSpan * tDelay = NULL)=0;
  
  // S_OK   : all booking are destroyed
  // S_FALSE: a booking can&#x27;t be destroyed then no booking has been destroyed
  // E_FAIL : system error
  virtual HRESULT deleteObjectsBooking(const  CATListPtrSdaiAppInstance* lObjects)=0;
  
  //
  // change the value of the expiration delay.
  //
  virtual HRESULT setDefaultDelay(const CATTimeSpan * tDefaultDelay)=0;

  //
  // get the BookState of the object.
  // 
  // if BookState is NOTBOOKABLE the ownerOfTheBooking (logical user) is valuated
  // if return code is E_FAIL then status and ownerOfTheBooking aren&#x27;t valuated.
  virtual HRESULT isObjectBooked (SdaiAppInstance * iObject          ,
				  BookState*        status           ,
				  CATUnicodeString&amp; ownerOfTheBooking)=0;

  //-- JDC+ V5R11. ID GENERATION + BOOKING coupling. 
 
  virtual HRESULT UseBooking(SdaiAppInstance  * iObject       ,
                             const CATUnicodeString&amp; iAssignee,
                             int                     iForce   =0)=0;
  //-- JDC- V5R11. ID GENERATION + BOOKING coupling.
  /**
   * Create n line in Database to book the generated IDs for a given type.
   * @param iObjectInfo [in] the object info of the type.
   * @param iAssignee [in] the string that owns the booking
   * @param iNbBookingToCreate [in] the number of identifier to book.
   * @param iPrefix [in] the prefix of the generated identifier.
   * @param iSeparator [in] the separator of the generated identifier.
   * @param iPadding [in] the padding to use to generate the identifier.
   * @param iMaxSize [in] the max size of the generated identifier.
   * @param iDelay [in] the delay of availability of the booking.
   * @return 
   * S_OK : the booking are created.
   * E_FAIL: cannot book these IDs
   */
  virtual HRESULT CreateNBookingWithConsecutiveIDs(ENOVIObjectInfo_var&amp;       iObjectInfo,
                                                   const CATUnicodeString&amp; iAssignee ,
                                                   int iNbBookingToCreate            ,
                                                   const CATUnicodeString&amp; iPrefix   ,
                                                   const CATUnicodeString&amp; iSeparator,
                                                   int iPadding                      ,
                                                   int iMaxSize                      ,
                                                   const CATTimeSpan * tDelay = NULL) = 0;
  /**
   * get the list of the free IDs
   *
   * @param iObjectInfo [in] the object info of the type.
   * @param iAssignee [in] the string that owns the booking.
   * @param olFreeIds[out] the values of the availale booked IDs.
   * @param olFreeButInUse [out] a list of int (0/1) to known which one are in use
   * @return
   * S_OK
   * E_FAIL
   */
  virtual HRESULT GetFreeBookedIDs(ENOVIObjectInfo_var&amp;           iObjectInfo   ,
                                   const CATUnicodeString&amp;     iAssignee     ,
                                   CATListOfCATUnicodeString&amp;  olFreeIDs     ,
                                   CATListOfInt&amp;               olFreeButInUse) = 0;
};

CATDeclareHandler(VPMIBookingManager, CATBaseUnknown); 

ExportedByGUIDVPMInterfaces HRESULT GetVPMIBookingManager(VPMIBookingManager *&amp; oiBookManager   );

#endif 







</div>
    
    <div class="navigation">
        <div><a href="VPMIAdmin.html">‚Üê ‰∏ä‰∏ÄÈ°µ: VPMIAdmin.h</a></div>
        <div><a href="VPMIIdentifierGeneratorMgr.html">‰∏ã‰∏ÄÈ°µ: VPMIIdentifierGeneratorMgr.h ‚Üí</a></div>
    </div>
</body>
</html>