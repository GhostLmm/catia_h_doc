<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OptimizationInterfaces/PublicInterfaces/CATOptAlgorithmAdapter.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>OptimizationInterfaces/PublicInterfaces/CATOptAlgorithmAdapter.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATOptAddTypeLibraryDefines.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATOptAddTypeLibraryDefines.h</a></div>
        <div><a href="CATOptAlgorithmUIFactoryAdapter.html">‰∏ã‰∏ÄÈ°µ: CATOptAlgorithmUIFactoryAdapter.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">// COPYRIGHT DASSAULT SYSTEMES 2002
#ifndef CATOptAlgorithmAdapter_H
#define CATOptAlgorithmAdapter_H

#include &quot;OptimizationItfCPP.h&quot;

// System
#include &quot;CATEventSubscriber.h&quot;
#include &quot;CATCallbackManager.h&quot;
#include &quot;CATNotification.h&quot;
#include &quot;CATLISTV_CATBaseUnknown.h&quot;

// OptimizationInterfaces
#include &quot;CATIOptOptimization.h&quot;
class CATIOptAlgorithmUpdateHelper;

/** 
 * @CAA2Level L1
 * @CAA2Usage U2 
 */

/**   
 * CAA Adapter to CATIOptAlgorithm Interface.
 * &lt;b&gt;Role&lt;/b&gt;: This class should be derived to implement features extension to @href CATIOptAlgorithm.&lt;br&gt;
 * @href CATIOptAlgorithm is the interface used by the product PEO to indentify and use the new algorithms.&lt;br&gt;
 */
class ExportedByOptimizationItfCPP CATOptAlgorithmAdapter: public CATEventSubscriber
{
	
public:
	

	CATOptAlgorithmAdapter ();
	virtual ~CATOptAlgorithmAdapter ();

    /**
    * Triggers the computation of the user algorithm.
	* &lt;b&gt;Role&lt;/b&gt;: This method must be overloaded in derived classes.
	* Write your algorithm code here. It may be a loop of the following type :
	* while the termination criteria are not reached, do a modification of
	* the inputs values, update the outputs and check the termination criteria.
	* To do that, you will have to call the protected methods of this class in the
	* following order :
	* &lt;pre&gt;
	* InitUpdate()
	* BeforeFirstUpdate()
	*
	* While (...)
	* {
	*		If(&quot;it is the last update&quot;)
	*			BeforeLastUpdate()
	*
	*		LaunchUpdate()		
	* }
	*
	* AfterLastUpdate()
	* &lt;/pre&gt;
	* @param spiOptim
	* The optimization linked to this algorithm. It is used to access the update
	* engine used in the @href #InitUpdate() and @href #LaunchUpdate() methods. In most cases
	* the algorithm is working on its optimization free parameters and goals, so
	* that the optimization may be used to get the inputs and outputs to update.
	* @return
	* S_OK if the operation succeeded, E_FAIL else
	*/
	virtual HRESULT Run (CATIOptOptimization_var &amp; spiOptim) = 0;
	
    /**
	* Sets an algorithm setting. This setting is defined by its attribute name.
	* For pre-requisites restriction constraints, you have to overload it in derived classes.
	*
	* @example
	* &lt;pre&gt;
	* Here is the code you have to write in your derived class --
	* {	
	*	CATISpecAttrAccess_var access = this;
	*	if (!access)
	*		return E_FAIL;
	*
	*	CATISpecAttrKey_var key = access-&gt;GetAttrKey(attrName);
	*	if (!key)
	*		return E_FAIL;
	*
	*	key-&gt;Release();
	*	
    *	CATAttrKind type = key-&gt;GetType();
	*	if (type == tk_integer)
	*		access-&gt;SetInteger(key, (int)content);
	*	else if (type == tk_double)
	*		access-&gt;SetDouble(key, content);
	*	else
	*		return E_FAIL;
	*
	*	return S_OK;
	* }
	* &lt;/pre&gt;
	* @param iAttrName
	* The name of the settings attribute to set.
	* @param iContent
	* The value of the setting to set. it is given as a double but can be an integer.
	* @return
	* S_OK if the operation succeeded, E_FAIL else (non existing attribute)
	*/
	HRESULT SetSetting(const char* iAttrName, double iContent);


	/**
	* Gets an algorithm setting. The setting is defined by its attribute name.
	* For pre-requisites restriction constraints, you have to overload it in derived classes.
	*
	* @example
	* &lt;pre&gt;
	* Here is the code you have to write in your derived class
	* {
	*	CATISpecAttrAccess_var access = this;
	*	if (!access)
	*		return E_FAIL;	
	*
	*	CATISpecAttrKey_var key = access-&gt;GetAttrKey(attrName);
	*	if (!key)
	*		return E_FAIL;
	*
	*	key-&gt;Release();
	*
	*	CATAttrKind type = key-&gt;GetType();
	*	if (type == tk_integer)
	*		content = (double) access-&gt;GetInteger(key);
	*	else if (type == tk_double)
	*		content = access-&gt;GetDouble(key);
	*	else
	*		return E_FAIL;
	*
	*	return S_OK;
	* }
	* &lt;/pre&gt;
	* @param iAttrName
	* The name of the settings attribute to get.
	* @param oContent
	* The returned value of the setting. it is given as a double but can be an integer.
	* @return
	* S_OK if the operation succeeded, E_FAIL else (non existing attribute)
	*/
	HRESULT GetSetting(const char* iAttrName, double &amp;oContent);

    /**
    * Retrieves the event send when an iteration of the algorithm is done.
	* If you use the @href #SendEndIterationNotification() method after each iteration,
	* this event is triggered when the algorithm has finished an iteration	
	* (each iteration corresponds to a model update)&lt;p&gt;	
	* In your dialog, put a callback on this method to receive the
	* end iteration notification.
	*/
	CATCallbackEvent GetEndIterationNotification () const ;

	/**
	* Returns the index of the Opimization Log corresponding to the best solution found according to the problem defined.
	* @param oBestResultIndex
	* The index of the best point found by the optimizer.
	* @return
	* S_OK if the best is found. E_FAIL if it was not found. E_NOTIMPLEMENTED for algorithms (such as DOEs) for which this notion 
	* is meaningless.
	*/
	HRESULT GetBestResultIndex(int&amp; oBestResultIndex);

	/**
	* Returns a string describing the history of the optimization algorithm.
	* @return
	* The string containing the evolution of the free parameters, objective and constraints. 
	* Contains additional information with respect to the design table output of the optimization.
	*/
	virtual CATUnicodeString AllHistoricToString();

	/**
	* @param oBestResultIndex
	* The index of the historic to be dumped.
	* Returns a string describing the history of the optimization algorithm.
	* @return
	* The string containing the evolution of the free parameters, objective and constraints. 
	* Contains additional information with respect to the design table output of the optimization.	*/
	virtual CATUnicodeString OneHistoricToString(int iHistoricIndex);
	
protected:
	

	/**
	* Sends the end of iteration notification.
	* It can be caugth everywhere you want (for example, in the stop dialog in order to update it during the run).
	* @param
	* The notification you want to send.
	* @return
	* S_OK if the operation succeeded, E_FAIL else.
	*/
	virtual HRESULT SendEndIterationNotification(CATNotification* iNotif);

	/**
	* Initializes the update management engine.
	* It has to be called (at least) one time , before running the others (@href #LaunchUpdate, @href #BeforeFirstUpdate, 
	* @href #BeforeLastUpdate and @href #AfterLastUpdate) else each one of those methods will do nothing but returning E_FAIL !
	* @param iOptim
	* the optimization whose settings have to be used during the update (like Visu/No Visu). In most cases, it is
	* the optimization linked to the algorithm.
	* @param iInputs
	* The inputs that have to be updated (in most cases, they are the given optimization free parameters, but 
	* they may be different).
	* @param iOutputs
	* The outputs that have to be updated (in most cases, they are the given optimization goals, but 
	* they may be different).
	* Return E_FAIL if something fails.
	*/
	HRESULT InitUpdate(const CATIOptOptimization_var&amp; iOptim, const CATLISTV(CATBaseUnknown_var)* iInputs, const CATLISTV(CATBaseUnknown_var)* iOutputs);
	
	/**
	* Asks the update management engine to launch the update of the inputs/outputs.
    * This update is given in the @href #InitUpdate method, according to the settings of the given optimization.
	* @return
	* E_FAIL if something fails (update management engine not initialized...).
	*/
	HRESULT LaunchUpdate();

	/**
	* Initializes Settings.
	* This method modifies some settings (measure) to assure that the model will be
	* correctly updated according to the given optimization settings (visu/no visu).
	* It has to be called one time :
	* - after the @href #InitUpdate method
	* - before calling the @href #LaunchUpdate() method for the first time.
	* @return
	* E_FAIL if something fails (update management engine not initialized...).
	*/
	HRESULT BeforeFirstUpdate();

	/**
	* Allows to restore the visualization settings for the last update.
	* It has to be called one time, before running the last update.
	* @return
	* E_FAIL if something fails (update management engine not initialized...).
	*/
	HRESULT BeforeLastUpdate();

	/**
	* Allows to restore the settings impacted by the BeforeFirstUpdate() method.
	* @href #BeforeFirstUpdate().
	* It has to be called one time, after running the last update.
	* @return
	* E_FAIL if something fails (update management engine not initialized...).
	*/
	HRESULT AfterLastUpdate();


		
private:
	// The copy constructor and the equal operator must not be implemented
	// -------------------------------------------------------------------
	CATOptAlgorithmAdapter (CATOptAlgorithmAdapter &amp;);
	CATOptAlgorithmAdapter&amp; operator=(CATOptAlgorithmAdapter&amp;);

	// define the event can be published by this class
	CATDefineCBEvent(EventEndIteration)
	int _Version;

	// For internal use only.
	CATIOptAlgorithmUpdateHelper* _UpdateHelper;

};

//-----------------------------------------------------------------------

#endif
</div>
    
    <div class="navigation">
        <div><a href="CATOptAddTypeLibraryDefines.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATOptAddTypeLibraryDefines.h</a></div>
        <div><a href="CATOptAlgorithmUIFactoryAdapter.html">‰∏ã‰∏ÄÈ°µ: CATOptAlgorithmUIFactoryAdapter.h ‚Üí</a></div>
    </div>
</body>
</html>