<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OptimizationInterfaces/PublicInterfaces/CATIOptimizationLog.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>OptimizationInterfaces/PublicInterfaces/CATIOptimizationLog.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATIOptValuesAndDerivativesAccess.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIOptValuesAndDerivativesAccess.h</a></div>
        <div><a href="CATOptAddTypeLibraryDefines.html">‰∏ã‰∏ÄÈ°µ: CATOptAddTypeLibraryDefines.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">// COPYRIGHT DASSAULT SYSTEMES 2000
//===================================================================
//
// CATIOptSolutions.h
// Define the CATIOptSolutions interface
//
//===================================================================
/** 
 * @CAA2Level L1
 * @CAA2Usage U3
 */
#ifndef CATIOptimizationLog_H
#define CATIOptimizationLog_H

#include &quot;OptimizationItfCPP.h&quot;
#include &quot;CATBaseUnknown.h&quot;

class CATUnicodeString;
class CATIDesignTable_var;
class CATICkeParm_var;

#include &quot;CATLISTV_CATBaseUnknown.h&quot;
#include &quot;CATListOfInt.h&quot;

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByOptimizationItfCPP IID IID_CATIOptimizationLog ;
#else
extern &quot;C&quot; const IID IID_CATIOptimizationLog ;
#endif

/**
* Interface for the management of the data stored in the type late OptSolutions.
* This type is used by the OptOptimization feature to store parameters values during optimization
* and to store the best configurations with respect to optimization problem definition
*/
class ExportedByOptimizationItfCPP CATIOptimizationLog: public CATBaseUnknown
{
	CATDeclareInterface;
	
public:
	

	/**
	* Creates and initializes the optimization logging tools. 
	* The optim log will allow you to capture the current parameters configuration (i.e. the values of the parameters 
	* given in the iParmsList) and to store it in the output file, so
	* that the ouput file gives an historic of the optimization run.
	* Each column of the optim log gives one parameter variation, and each row represents
	* a given parameters values configuration.
	* @param
	* iPath
	* The path of the output file that will be created. If iPath = &quot;&quot;, the historic is stored
	* in the model (persistent).
	* @param
	* iParmsList
	* The list of parameters whose values will be stored in the historic. You should give all the
	* free parameters, the constraints, the goal parameter(s) and your own parameters if needed.
	* @param
	* iWithBestParm
	* Set it to 1 if you want to have a persistent parameter that gives the best result variation,
	* else, set it to 0. If you create it, you will be able to retrieve it
	* (for example : in the algorithm Run in order to valuate it) by using the
	* GetBestParameter() method.
	* @return
	* S_OK if the operation succeeded, E_FAIL else.
	*/
	virtual HRESULT InitializeOptimLog(const CATUnicodeString &amp;iPath, 
									   const CATLISTV(CATBaseUnknown_var)* iParmsList,
									   int iWithBestParm = 0) = 0;

	/**
	* Captures the current values of the parameters given while creating the optim log and store them next to the last row of parameters configuration.
	* @param
	* iWithSynchro
	* If you did not choose the model storage format while initializing the optimization log,
	* set it to 1 if you want to do the synchronization between the file content and 
	* the data stored in buffer. For optimization purpose, you should always set it to 0
	* except when you call this method for the last time.
	* (If you chose the model storage format while initializing the optimization log, the
	*  model is always up to date with the data stored in buffer so that we don&#x27;t care about
	* the iWithSynchro value).
	* @return
	* S_OK if the operation succeeded, E_FAIL else.
	*/
	virtual HRESULT AddRowInOptimLog(const int iWithSynchro = 1) = 0;

	/**
	* Fills the given list with the content of the optimization log row.
	* @param iRowIndex
	* The index of row that you want to get (the first one as the index 1 and contains the column names).
	* @param oRowContent
	* the list filled with the row content. If this list is not empty, its content is
	* removed before filling it.
	* @return
	* S_OK if the operation succeeded, E_FAIL else (the row number iRowIndex does not exist).
	*/
	virtual HRESULT GetRowFromOptimLog(const int iRowIndex, CATListOfCATUnicodeString&amp; oRowContent) = 0;


	/**
	* Adds an additional column corresponding to a parameter.
	* If you did not give one parameter when you call the CreateOptimizationLog() method, you can use this one to add one column associated to the given parameter.
	* @param
	* spiParm
	* the parameter that you want to add in the optimization log in order to log
	* its variation.
	* @return
	* S_OK if the operation succeeded, E_FAIL else.
	* Notice that this method has to be called after the CreateOptimizationLog() one.
	*/
	virtual HRESULT AddParameterInOptimLog(CATICkeParm_var spiParm) = 0;

	/**
	* Returns the Optimization Log path.
	* @return
	* the optimization log path given while calling CreateOptimizationLog() or
	* &quot;&quot; if the optim log doesn&#x27;t exist or if the file has been moved after
	* it creation, so that it can&#x27;t be retrieved.
	*/
	virtual CATUnicodeString GetOptimLogPath() = 0;

	/**
	* Returns the parameter valuated by the best value of the goal parameter.
	* @return
	* This method returns the parameter which was created if the optionnal parameter &quot;iWithBestParm&quot;
	* was choosen while calling CreateOptimizationLog().
	*/
	virtual CATICkeParm_var GetBestParameter() = 0;

	/**
	* Returns the list of Optimization log rows.
	* @return
	* The list of optimization log rows indexes. Can be used to
	* save the best results indexes or the indexes of rows for which
	* the optimization update failed.
	*/
	virtual CATListOfInt* GetOptimLogRowsIndexes() = 0;
	
	/**
	* Adds the index in the list of indexes. 
	* It is appended to the list.
	*/
	virtual void AddIndex(int index) = 0;
	
	/**
	* Removes the i th element in the list of indexes.
	*/
	virtual void RemoveIndex(int i) = 0;
	
	/**
	* Exports the optimization historic in a file.
	* If you have chosen to store the historic in the model (you called the 
	* method InitializeOptimLog with argument iPath = &quot;&quot; ), you have the
	* possibility to export the historic content in a file.
	* Notice that if you go on modifying the historic after the export, the
	* file won&#x27;t be synchronized with the historic content (because the file
	* is just an image of the historic at the instant of the method call).
	* @param iPath
	* The path of the file that will be created. If it contains :
	* - &quot;.xls&quot;, an excel file will be created
	* - &quot;.123&quot;, a Lotus file will be created
	* else, a text file will be created.
	* @param iReplaceFileIfExist
	* If you give a path that corresponds to an existing file, you have to set it to 1
	* to force the file replacement (else this method will fail). By default, this
	* argument is set to 0 in order to keep the existing file.
	* @return
	* E_FAIL if the file creation or the file filling failed, and S_OK else.
	* Possible reasons of failure : you did not call the CATIOptimizationLog::InitializeOptimLog 
	*								method with an empty path (historic not stored in the
	*								model but already in a file,
	*								iPath is empty, file exists and is not in Read/Write mode,
	*								you are not allowed to write in the given location ...							
	*/
	virtual HRESULT ExportOptimLogToFile(const CATUnicodeString &amp;iPath, int iReplaceFileIfExist = 0) = 0;


	/**
	* Returns the number of rows currently in the optimization log.
	*/
	virtual HRESULT GetMaxRowIndex(int&amp; oNumbderOfRows) = 0;
};

CATDeclareHandler( CATIOptimizationLog, CATBaseUnknown );

#endif
</div>
    
    <div class="navigation">
        <div><a href="CATIOptValuesAndDerivativesAccess.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIOptValuesAndDerivativesAccess.h</a></div>
        <div><a href="CATOptAddTypeLibraryDefines.html">‰∏ã‰∏ÄÈ°µ: CATOptAddTypeLibraryDefines.h ‚Üí</a></div>
    </div>
</body>
</html>