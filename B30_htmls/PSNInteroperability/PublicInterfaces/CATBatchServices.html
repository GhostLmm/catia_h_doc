<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PSNInteroperability/PublicInterfaces/CATBatchServices.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>PSNInteroperability/PublicInterfaces/CATBatchServices.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="../../PPRInterfaces/PublicGenerated/win_b64/TIE_CATIAPPRProducts.html">‚Üê ‰∏ä‰∏ÄÈ°µ: TIE_CATIAPPRProducts.h</a></div>
        <div><a href="CATBatchServices2.html">‰∏ã‰∏ÄÈ°µ: CATBatchServices2.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">/* -*-c++-*- */
#ifndef CATBatchServices__H
#define CATBatchServices__H

// COPYRIGHT DASSAULT SYSTEMES  1999

/**
* @CAA2Level L1
* @CAA2Usage U1
*/

#include &quot;CATPinServices.h&quot;
#include &quot;CATIProductDatabase.h&quot;
#include &quot;CATBaseUnknown.h&quot;
#include &quot;CATUnicodeString.h&quot;
#include &quot;CATListOfCATUnicodeString.h&quot;
#include &quot;CATDocument.h&quot;
#include &quot;CATBoolean.h&quot;
class CATIDocId;


/**
* Initializes the V5 session to communicate with ENOVIAvpm V4.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method initializes the CATIA V5 session and 
*     establishes the connection with ENOVIAvpm V4.
* &lt;br&gt;
* This method creates a CATIA V5 session if it is not yet initialized. 
* Use @href CATTerminateBatch at the end of the application to close this session.
* &lt;br&gt;
* If there is no ENOVIAvpm V4 application (client or server) running to which this method can connect to, 
* a new ENOVIAvpm V4 server is launched on the local Unix host by submitting 
* the &lt;tt&gt;StartVPMBatchFromV5Batch.sh&lt;/tt&gt; shell script.
* &lt;br&gt;
* the &lt;tt&gt;CV5VpmStart&lt;/tt&gt; environment variable can be declared to set the unix directory where the 
*  &lt;tt&gt;StartVPMBatchFromV5Batch.sh&lt;/tt&gt; shell script is located.
* &lt;br&gt;
* This method can be used for Unix client only. 
* @see @href CATInitBatchOnHost for submission from Windows client or 
*    from Unix client on a dedicated Unix host.
* &lt;/p&gt;
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The communication channel is successfuly established&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
*   &lt;ul&gt;
*      &lt;li&gt;&lt;tt&gt;ERR_2001&lt;/tt&gt;: ENOVIAvpm server cannot be launched&lt;/li&gt;    
*  &lt;/ul&gt;
*  &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATInitBatch ();

/**
* Connects a user to the ENOVIAvpm V4 database.
*
*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method connects a user to the ENOVIAvpm V4 database 
* with the specified Role while performing his authentication with his password.
* &lt;p&gt;
* This method must be called after the communication with ENOVIAvpm V4 is established
* by @href CATInitBatch or @href CATInitBatchOnHost.
* Use @href CATDisconnectFromVPM to disconnect the user from the database.
* &lt;br&gt;If the database is client authentified, 
*     iUser and iPass must be filled with an empty string (&lt;tt&gt;&quot;&quot;&lt;/tt&gt;).
* &lt;/p&gt;
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iServer
*    server name as defined in the CATIA V5 option settings
* @param iUser
*    name of the user to connect.
* @param iPass
*    password of the user declared with iUser.
* @param iRole
*   The selected role to connect the user to the ENOVIAvpm V4 database.
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The user is successfuly connected&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
*   &lt;ul&gt;
*      &lt;li&gt;&lt;tt&gt;ERR_12&lt;/tt&gt;: Server name not found in CATIA V5 settings&lt;/li&gt;
*      &lt;li&gt;&lt;tt&gt;ERR_101&lt;/tt&gt;: User authentication failed&lt;/li&gt;
*      &lt;li&gt;&lt;tt&gt;ERR_1002&lt;/tt&gt;: ENOVIAvpm cannot be detected &lt;/li&gt;
*      &lt;li&gt;&lt;tt&gt;ERR_2003&lt;/tt&gt;: Role not available &lt;/li&gt;
*  &lt;/ul&gt;
*  &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATConnectToVPM (CATUnicodeString &amp; iServer, CATUnicodeString &amp; iUser, CATUnicodeString &amp; iPass,  CATUnicodeString &amp; iRole);


/**
* Disconnects the application from ENOVIAvpm V4.
*
*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method first disconnects the user from the ENOVIAvpm V4 database then
* closes the connection with ENOVIAvpm V4. 
* If an ENOVIAvpm V4 server had been launched, it is stopped. 
* @see @href CATConnectToVPM.
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The application is successfuly disconnected&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
*   &lt;ul&gt;
*      &lt;li&gt;&lt;tt&gt;ERR_1002&lt;/tt&gt;: ENOVIAvpm server cannot be detected&lt;/li&gt;
*   &lt;/ul&gt;
*  &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATDisconnectFromVPM ();

/**
* Opens a Structure Exploded assembly within ENOVIAvpm V4.
*
*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method opens an assembly stored in Structure Exploded mode 
* within ENOVIAvpm V4 memory according to the specified parameters. 
* &lt;br&gt;Configured and non configured assemblies can be open using this method.
*
* &lt;p&gt;
* This method takes as input the root part identifier &lt;tt&gt;iRootPartId&lt;/tt&gt;. 
* Only the 42 first character of the string are relevant and must be structured as followed:
* &lt;ul&gt; 
*   &lt;li&gt; the Coid of the root part (database binary 8 crc long)
*    &lt;li&gt; the Compid of the root part (database binary 8 crc long)
*    &lt;li&gt; the VPM environment name of the root part (8 crc long). 
*       &lt;br&gt; For instance &lt;tt&gt;&quot;VPMENV  &quot;&lt;/tt&gt;
*    &lt;li&gt; the VPM PART table name of the root Part (18 crc long). 
*       &lt;br&gt; For instance &lt;tt&gt;&quot;PART_LIST        &quot;&lt;/tt&gt;
* &lt;/ul&gt;
* &lt;br&gt; The 8 crc long server name might be present in the string but will be ignored.
* &lt;br&gt;
* Use @href CATCloseAssemblyInVPM to close the open assembly.
* &lt;/p&gt;
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iLgId
*    length of the iRootPartId string
* @param iRootPartId
*    ENOVIAvpm root part identifier.
* @param iConfiguration
*    list of the Configuration handler.
*    The list must be allocated by caller and must not contain NULL pointers. 
*    This list must be empty for non configured assemblies or if the assembly explosion 
*   has to be performed without configuration.
* &lt;br&gt;
*&lt;b&gt;Note:&lt;/b&gt;Only the first element of the list is taken into account. 
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The configured assembly has been successfully open&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: ENOVIAvpm server cannot be detected&lt;/li&gt;
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: Configured assembly cannot be opened for input parameters&lt;/li&gt;
*  &lt;/ul&gt; 
*/
HRESULT ExportedByCATPinServices CATOpenConfiguredAssemblyInVPM (int iLgId,
                                                                 char * iRootPartId,
                                                                 CATLISTV(CATUnicodeString) * iConfiguration);

/**
* Opens a Structure Exploded assembly within ENOVIAvpm V4.
*
*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method opens an assembly stored in Structure Exploded mode 
* within ENOVIAvpm V4 memory according to the specified parameters. 
*&lt;br&gt;Configured and non configured assemblies can be open using this method.
*
*&lt;p&gt;
* Use this method before @href CATLoadChildrenFromVPM. 
* &lt;br&gt;
* Use @href CATCloseAssemblyInVPM to close the open assembly.
* &lt;/p&gt;
*
* @param iConfiguration
*    list of the Configuration handlers. 
*    The list must be allocated by caller and must not contain NULL pointers. 
*    This list must be empty for non configured assemblies or if the assembly explosion 
*   has to be performed without configuration.
* &lt;br&gt;
*&lt;b&gt;Note:&lt;/b&gt;Only the first element of the list is taken into account. 
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iCoid
*    the Coid of the root part (Hexadecimal 16 crc long)
*
* @param iCompid
*       the Compid of the root part (Hexadecimal 16 crc long)
*
* @param iCatenv
*    the VPM environment name of the root part (8 crc long)
*&lt;br&gt;For instance: &lt;tt&gt;&quot;VPMENV  &quot;&lt;/tt&gt;
*
* @param iCatab
*    the VPM PART table name of the root Part (18 crc long)
*&lt;br&gt;For instance: &lt;tt&gt;&quot;PART_LIST     &quot;&lt;/tt&gt;
*
* @param iCnxString
*    &lt;i&gt;(optional)&lt;/i&gt; if needed, in order to avoid a manual connection.
*&lt;br&gt; The connection string of the entity in VPM can be furnished here.
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The configured assembly has been successfully open&lt;/li&gt;
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: ENOVIAvpm server cannot be detected&lt;/li&gt;
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: Configured assembly cannot be opened for input parameters&lt;/li&gt;
*  &lt;/ul&gt; 
*/
HRESULT ExportedByCATPinServices CATOpenConfiguredAssemblyInVPM ( CATLISTV(CATUnicodeString) * iConfiguration,
                                                                  const CATUnicodeString &amp;iCoid,
                                                                  const CATUnicodeString &amp;iCompid,
                                                                  const CATUnicodeString &amp;iCatenv,
                                                                  const CATUnicodeString &amp;iCatab,
                                                                  const CATUnicodeString &amp;iCnxString = CATUnicodeString());

/**
* Closes a configured assembly open within ENOVIAvpm V4.
*
*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method closes the configured assembly that has been open previously 
* within ENOVIAvpm V4 in order to free memory space.
* &lt;br&gt;
* @see @href CATOpenConfiguredAssemblyInVPM to open configured assembly.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The configured assembly has been successfully closed&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: ENOVIAvpm server cannot be detected&lt;/li&gt;
*  &lt;/ul&gt; 
*/
HRESULT ExportedByCATPinServices CATCloseAssemblyInVPM ();

/**
* Creates an empty CATProduct dedicated to ENOVIAvpm V4 import.
*
*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method creates a new empty CATProduct document in session and 
* valuates the storage name of the corresponding CATDocument 
*  with the input identifier &lt;tt&gt;iRootPartId&lt;/tt&gt;.
* 
* &lt;p&gt;
* This method takes as input the root part identifier &lt;tt&gt;iRootPartId&lt;/tt&gt;. 
* Only the 42 first character of the string are relevant and are structured as followed:
*  &lt;ul&gt;
*    &lt;li&gt; the Coid of the root part (database binary 8 crc long)&lt;/li&gt;
*    &lt;li&gt; the Compid of the root part (database binary 8 crc long) &lt;/li&gt;
*    &lt;li&gt; the VPM environment name of the root part (8 crc long). 
*      &lt;br&gt;For instance, &lt;tt&gt;&quot;VPMENV  &quot;&lt;/tt&gt; &lt;/li&gt;
*    &lt;li&gt; the VPM PART table name of the root Part (18 crc long). 
*      &lt;br&gt;For instance &lt;tt&gt;&quot;PART_LIST        &quot;&lt;/tt&gt; &lt;/li&gt;
* &lt;/ul&gt;
* The 8 crc long server name might be present in the string but will be ignored. &lt;/li&gt;
*
* @param iLgId
*    length of the &lt;tt&gt;iRootPartId&lt;/tt&gt; string(should be 42)
* @param iRootPartId
*    ENOVIAvpm Root Id
* @param oDoc
*    the new document is session only if the method is successful
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The CATProduct document has been created successfuly&lt;/li&gt;
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: ENOVIAvpm server cannot be detected&lt;/li&gt;
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed&lt;/li&gt;
*  &lt;/ul&gt; 
*/
HRESULT ExportedByCATPinServices CATCreateVPMSession (int iLgId,
                                                      char * iRootPartId,
                                                      CATDocument *&amp; oDoc);

/**
* Creates an empty CATProduct dedicated to ENOVIAvpm import.
*
*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method opens a new empty CATProduct document in session and 
* valuates its the storage name with the input parameters.
* &lt;p&gt;
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param oDoc
*    the new document is session only if the method is successful
* @param iCoid
*    the Coid of the part (Hexadecimal 16 crc long)
* @param iCompid
*       the Compid of the part (Hexadecimal 16 crc long)
* @param 
*    the VPM environment name of the part (8 crc long)
*&lt;br&gt; For instance: &lt;tt&gt;&quot;VPMENV  &quot;&lt;/tt&gt;
*
* @param iCatab
*    the VPM PART table name of the Part (18 crc long)
*&lt;br&gt;For instance: &lt;tt&gt;&quot;PART_LIST        &quot;&lt;/tt&gt;
*
* @param iCnxString
*    &lt;i&gt;(optional)&lt;/i&gt; if needed, in order to avoid a manual connection.
*&lt;br&gt; The connection string of the entity in VPM can be furnished here.
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The CATProduct document has been created successfuly&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: ENOVIAvpm server cannot be detected&lt;/li&gt;
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed&lt;/li&gt;
*  &lt;/ul&gt; 
*/
HRESULT ExportedByCATPinServices CATCreateVPMSession (CATDocument *&amp; oDoc,
                                                      const CATUnicodeString &amp;iCoid,
                                                      const CATUnicodeString &amp;iCompid,
                                                      const CATUnicodeString &amp;iCatenv,
                                                      const CATUnicodeString &amp;iCatab,
                                                      const CATUnicodeString &amp;iCnxString = CATUnicodeString());

/**
* Creates a Product Structure from an assembly stored in Structure Exploded mode in ENOVIAvpm V4.
*
*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method creates a Product Structure from 
* an assembly stored in Structure Exploded mode in the ENOVIAvpm V4 database.
*&lt;br&gt;
* This method creates a new CATProduct document in session (see @href CATCreateVPMSession ), 
* loads all the children of the Structure Exploded up to iNbLevel levels from the Part
* identified as input parameters (see @href CATLoadChildrenFromVPM ),
* and loads the applicative objects related to this structure (see @href CATCompleteSessionFromVPM ).
* &lt;br&gt;
* The method valuates the CATDocument storage name with the input parameters.
* &lt;p&gt;
* The Structure Exploded assembly must have been open before using @href CATOpenConfiguredAssemblyInVPM 
* with the same part identifier parameters.
*&lt;/p&gt;
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
*
* @param oDoc
*    the new CATProduct document is session only if the method is successful
* @param iNbLevel
*    the depth from the father to import children.
*&lt;br&gt; &lt;b&gt;Note:&lt;/b&gt; &lt;tt&gt;0&lt;/tt&gt; for &quot;ANY&quot; to retrieve all the children, only supported.
*
* @param iCoid
*    the Coid of the root part (Hexadecimal 16 crc long)
* @param iCompid
*       the Compid of the root part (Hexadecimal 16 crc long)
* @param iCatenv
*    the VPM environment name of the root part (8 crc long)
*&lt;br&gt; For instance: &lt;tt&gt;&quot;VPMENV  &quot;&lt;/tt&gt;
*
* @param iCatab
*    the VPM PART table name of the root Part (18 crc long)
*&lt;br&gt;For instance: &lt;tt&gt;&quot;PART_LIST     &quot;&lt;/tt&gt;
*
* @param iCnxString
*    &lt;i&gt;(optional)&lt;/i&gt; if needed, in order to avoid a manual connection.
* &lt;br&gt; The connection string of the entity in VPM can be furnished here.
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The CATProduct has been created successfuly&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: ENOVIAvpm server cannot be detected&lt;/li&gt;
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed&lt;/li&gt;
*  &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATCreateVPMProductStructure ( CATDocument *&amp; oDoc,
                                                                int iNbLevel/* 0 for &quot;ANY&quot;*/,
                                                                const CATUnicodeString &amp;iCoid,
                                                                const CATUnicodeString &amp;iCompid,
                                                                const CATUnicodeString &amp;iCatenv,
                                                                const CATUnicodeString &amp;iCatab,
                                                                const CATUnicodeString &amp;iCnxString = CATUnicodeString());

/**
* Loads in session a document stored in an ENOVIAvpm V4 database.
*
*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method loads in session a document stored 
*  in Publication Exposed mode in the ENOVIAvpm V4 database and 
*  returns the corresponding CATDocument. 
*&lt;br&gt;The document can be any CATIA V5 type document.
*
* &lt;p&gt;
* This method takes as input the document identifier &lt;tt&gt;iDocId&lt;/tt&gt;. 
* Only the 42 first character of the string are relevant and are structured as followed:
* &lt;ul&gt;
*    &lt;li&gt; the Coid of the document (database binary 8 crc long) &lt;/li&gt;
*    &lt;li&gt; the Compid of the document (database binary 8 crc long) &lt;/li&gt;
*    &lt;li&gt; the VPM environment name of the root part (8 crc long). 
*           &lt;br&gt;   For instance &lt;tt&gt;&quot;VPMENV  &quot;&lt;/tt&gt; &lt;/li&gt;
*    &lt;li&gt; the VPM document table name  (18 crc long). 
*           &lt;br&gt;  For instance &lt;tt&gt;&quot;DOCUMENT         &quot;&lt;/tt&gt; &lt;/li&gt;
* &lt;/ul&gt;
* &lt;br&gt; The 8 crc long server name might be present in the string but will be ignored.
* &lt;/p&gt;
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iLgId
*    length of the string iDocId.
* @param iDocId
*    ENOVIAvpm document identifier.
* @param oDoc
*    the new document is session only if the method is successful
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The document is successfuly loaded in session&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: ENOVIAvpm server cannot be detected&lt;/li&gt;
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed&lt;/li&gt;
*  &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATLoadDocumentFromVPM (int iLgId,
                                                         char * iDocId,
                                                         CATDocument *&amp; oDoc);

/**
* Loads in session a document stored in an ENOVIAvpm V4 database.
*
*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method loads in session a document stored 
*   in Publication Exposed mode in the ENOVIAvpm V4 database and 
*   returns the corresponding CATDocument. 
*&lt;br&gt;The document can be any CATIA V5 type document.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param oDoc
*    if the operation is a success, the opened document
* @param iCoid
*    the Coid of the document (Hexadecimal 16 crc long)
* @param iCompid
*       the Compid of the document (Hexadecimal 16 crc long)
* @param iCatenv
*    the VPM environment name (8 crc long)
*&lt;br&gt; For instance: &lt;tt&gt;&quot;VPMENV  &quot;&lt;/tt&gt;
*
* @param iCatab
*    the VPM document table name of the document (18 crc long)
*&lt;br&gt;For instance: &lt;tt&gt;&quot;DOCUMENT         &quot;&lt;/tt&gt; for a V5 document
*
* @param iCnxString
*    &lt;i&gt;(optional)&lt;/i&gt; if needed, in order to avoid a manual connection.
* &lt;br&gt;The connection string of the entity in VPM can be furnished here.
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The document is successfuly loaded in session&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: ENOVIAvpm server cannot be detected&lt;/li&gt;
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed&lt;/li&gt;
*  &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATLoadDocumentFromVPM ( CATDocument *&amp; oDoc,
                                                          const CATUnicodeString &amp;iCoid,
                                                          const CATUnicodeString &amp;iCompid,
                                                          const CATUnicodeString &amp;iCatenv,
                                                          const CATUnicodeString &amp;iCatab,
                                                          const CATUnicodeString &amp;iCnxString = CATUnicodeString());

/** @nodoc */
HRESULT ExportedByCATPinServices CATLoadChildrenFromVPM (CATIProductDatabase_var &amp; iParent,
                                                         int iNbLevel/* 0 for &quot;ANY&quot;*/,
                                                         CATUnicodeString * puWhereClause = NULL);

/**
* Loads children of a product coming from ENOVIAvpm V4 database.
*
*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method loads all the children of the Structure Exploded 
* up to iNbLevel levels, from the Part identified as input parameters.
*   The input document must be associated to a Part coming from ENOVIAvpm V4 database.
*&lt;br&gt;
* The Structure Exploded assembly must have been open previously using 
* @href CATOpenConfiguredAssemblyInVPM with the same part identifier parameters.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iDoc
*    the father document
* @param iNbLevel
*    the depth from the father to import children.
* &lt;br&gt;&lt;tt&gt;0&lt;/tt&gt; for &quot;ANY&quot; to retrieve all the children
*
* @param puWhereClause
*    the Where Clause to choose representation. This is a SQL format.
* &lt;br&gt; For instance &lt;tt&gt;&quot; C_REVISION like &#x27;---&#x27; &quot;&lt;/tt&gt;.
* &lt;br&gt; If no Where Clause is specified, the first representation type as specified
* in the settings is loaded.
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The children documents have been successfuly loaded in session&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed&lt;/li&gt;
*  &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATLoadChildrenFromVPM (CATDocument * iDoc,
                                                         int iNbLevel/* 0 for &quot;ANY&quot;*/,
                                                         CATUnicodeString * puWhereClause = NULL);

/**
* Loads applicative objects from ENOVIAvpm V4 to complete the current session.

*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method loads applicative objects from the ENOVIAvpm V4 database
* to complete the current session.
* The input document must be a CATIA V5 document or a part coming from ENOVIAvpm V4. 
* This method retrieves from the ENOVIAvpm V4 database the applicative objects 
* associated with this part or document and all its children and loads them in the CATIA session.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
*
* @param iDoc
*    the document coming from ENOVIAvpm V4 
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The session has been successfuly completed with applicative objects&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed&lt;/li&gt;
*  &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATCompleteSessionFromVPM (CATDocument *iDoc);

/**
* Commit in VPM.
*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method commits the pending transaction in the ENOVIAvpm V4 database.
*
*&lt;br&gt; This method must be called after @href CATSaveInVPMFromCATIA or @href CATSaveInVPM.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: Commit successful&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: Commit failed&lt;/li&gt;
*  &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATCommitVPM ();


/**
* Terminates the VPM session.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method deletes the CATIA V5 session 
* opened using @href CATInitBatch or @href CATInitBatchOnHost. 
*&lt;br&gt; This method must be called before exiting the application.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The CATIA session is deleted&lt;/li&gt; 
*  &lt;/ul&gt;
*/ 
HRESULT ExportedByCATPinServices CATTerminateBatch ();

/**
* Saves a document in session and all its pointed documents in ENOVIAvpm V4 database.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method saves the input document back to the ENOVIAvpm V4 database. 
* Its pointed documents already loaded in session are also saved in the database.
*&lt;br&gt;If the document already exists in the database it is replaced.
*&lt;p&gt;
* The saved documents can be removed from the session at once 
* according to &lt;tt&gt;UnloadAfterSave&lt;/tt&gt; value.
*&lt;br&gt;
* Always use @href CATCommitVPM after to commit the changes in the ENOVIAvpm V4 database.
* &lt;/p&gt;
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iDoc
*    the main document
* @param UnloadAfterSave
*     &lt;tt&gt;TRUE&lt;/tt&gt;: the documents are removed from session after beeing saved in database
*&lt;br&gt; &lt;tt&gt;FALSE&lt;/tt&gt;: the saved documents are kept in session
* 
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The document(s) are successfuly saved&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed&lt;/li&gt; 
*  &lt;/ul&gt;
*
*/
HRESULT ExportedByCATPinServices CATSaveInVPMFromCATIA (CATDocument* iDoc,CATBoolean UnloadAfterSave=FALSE);

/**
* Saves a document and all its pointed documents in ENOVIAvpm V4 database.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method loads the input file document in session and all its
* pointed documents too and saves them in the ENOVIAvpm V4 database.
*&lt;br&gt;If the document already exists in the database it is replaced.
*&lt;p&gt;
* The saved documents can be removed from the session at once 
* according to &lt;tt&gt;UnloadAfterSave&lt;/tt&gt; value.
*&lt;br&gt;
* Always use @href CATCommitVPM after to commit the changes in the ENOVIAvpm V4 database.
*&lt;/p&gt;
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iPath
*    full path of the input main document
* @param UnloadAfterSave
*     &lt;tt&gt;TRUE&lt;/tt&gt;: the documents are removed from session after beeing saved in database
*&lt;br&gt; &lt;tt&gt;FALSE&lt;/tt&gt;: the saved documents are kept in session
* 
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The document(s) are successfuly saved&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed&lt;/li&gt; 
*  &lt;/ul&gt;
*
*/
HRESULT ExportedByCATPinServices CATSaveInVPMFromCATIA (const char* iPath,CATBoolean UnloadAfterSave=FALSE);


/**
* Retrieves the sorted list of object of what need to be saved.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method analyses the content of the current session and 
* identifies the list of objects that need to be saved prior to the input object because of 
* their impact on this input object.
* &lt;br&gt;
* This list is intended to be used as an input for @href CATSaveInVPM.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
*  @param iStarter
*    master object to analyse. 
* &lt;br&gt; &lt;b&gt;Note&lt;/b&gt;: Only CATDocument type is supported as iStarter object type. This method supports only documents from ENOVIAvpm V4.
*
*  @param oList
*    sorted list of what needs to be saved with the master object.
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The list is successfuly returned&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed&lt;/li&gt; 
*  &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices GetObjectToSaveSortedList(CATBaseUnknown *iStarter,CATLISTP(CATBaseUnknown)&amp; oList);


/**
*  Saves a sorted list of CATIA Object in ENOVIAvpm V4 database.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method saves in the ENOVIAvpm V4 database the objects contained
* in the input list. The input list must be computed with @href GetObjectToSaveSortedList.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
*  @param iList
*    sorted list of what needs to be saved
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The list of objects has been successfuly saved&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed&lt;/li&gt; 
*  &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATSaveInVPM(CATLISTP(CATBaseUnknown)&amp; iList);

/**
* Creates a DocId for a ENOVIAvpm V4 document.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method computes a ENOVIAvpm V4 DocId from the input parameters.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param oDocId
*    The DocId object.
* @param iCoid
*    the Coid of the entity in ENOVIAvpm V4(Hexadecimal 16 crc long)
* @param iCompid
*       the Compid of the entity in ENOVIAvpm V4(Hexadecimal 16 crc long)
* @param iCatenv
*    the VPM environment name of the entity  (8 crc long).
*&lt;br&gt; For instance &lt;tt&gt;&quot;VPMENV  &quot;&lt;/tt&gt;
*
* @param iCatab
*    the VPM PART table name of the entity (18 crc long). 
* &lt;br&gt; For instance &lt;tt&gt;&quot;PART_LIST        &quot;&lt;/tt&gt; for a part 
*        or         &lt;tt&gt;&quot;DOCUMENT      &quot;&lt;/tt&gt; for a V5 document
*
* @param iCnxString
*    &lt;i&gt;(optional)&lt;/i&gt; if needed, in order to avoid a manual connection.
* &lt;br&gt;The connection string of the entity in VPM can be furnished here.
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The DocID has been successfuly computed&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed&lt;/li&gt; 
*  &lt;/ul&gt; 
*/
HRESULT ExportedByCATPinServices CATComputeDocId (CATIDocId **oDocId,
                                                  const CATUnicodeString &amp;iCoid,
                                                  const CATUnicodeString &amp;iCompid,
                                                  const CATUnicodeString &amp;iCatenv,
                                                  const CATUnicodeString &amp;iCatab,
                                                  const CATUnicodeString &amp;iCnxString = CATUnicodeString());

/**
*  Valuates the ENOVIAvpm V4 DocID of a document in session.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method computes a ENOVIAvpm V4 DocId from the input parameters and
* valuates it on the CATDocument given in input.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
*  @param iDocument
*    The Document 
*  @param iCoid
*    the Coid of the document (8 crc long)
*  @param iCompid
*    the Compid of the document (8 crc long)
*  @param iCaenv
*    the Caenv of the document (8 crc long)
*&lt;br&gt; For instance &lt;tt&gt;&quot;VPMENV  &quot;&lt;/tt&gt;
*  @param iCatab
*    the Catab of the document (18 crc long)
* &lt;br&gt; For instance &lt;tt&gt;&quot;DOCUMENT      &quot;&lt;/tt&gt; 
*  @param iCnxString
*    &lt;i&gt;(optional)&lt;/i&gt; if needed, in order to avoid a manual connection.
*&lt;br&gt;  The connection string of the database can be furnished here.
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The DocId has been successfuly computed and valuated on the document&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: the connection to the database was not previously done &lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: some input parameters are incorrect&lt;/li&gt; 
*   &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATValuatePdmId (CATDocument* iDocument, const char * iCoid, const char * iCompid, 
                                                  const char * iCaenv, const char * iCatab,
                                                  const char * iCnxString = NULL);

/**
*  Valuates the ENOVIAvpm V4 DocID of a document in session.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method computes a ENOVIAvpm V4 DocId from the input parameters and
* valuates it on the CATDocument given in input.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iDocument
*    The Document 
* @param iCoid
*    the Coid of the entity in ENOVIAvpm V4(Hexadecimal 16 crc long)
* @param iCompid
*       the Compid of the entity in ENOVIAvpm V4(Hexadecimal 16 crc long)
* @param iCatenv
*    the VPM environment name of the entity  (8 crc long).
*&lt;br&gt; For instance &lt;tt&gt;&quot;VPMENV  &quot;&lt;/tt&gt;
*
* @param iCatab
*    the VPM PART table name of the entity (18 crc long). 
* &lt;br&gt; For instance &lt;tt&gt;&quot;PART_LIST        &quot;&lt;/tt&gt; for a part 
*                or &lt;tt&gt;&quot;DOCUMENT      &quot;&lt;/tt&gt; for a V5 document

* @param iCnxString
*    &lt;i&gt;(optional)&lt;/i&gt; if needed, in order to avoid a manual connection
*    The connection string of the entity in VPM can be furnished here.
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The DocId has been successfuly computed and valuated on the document&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: the connection to the database was not previously done &lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: some input parameters are incorrect&lt;/li&gt; 
*   &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATValuatePdmId (CATDocument* iDocument,
                                                  const CATUnicodeString &amp;iCoid,
                                                  const CATUnicodeString &amp;iCompid,
                                                  const CATUnicodeString &amp;iCatenv,
                                                  const CATUnicodeString &amp;iCatab,
                                                  const CATUnicodeString &amp;iCnxString = CATUnicodeString());

/**
* Opens a product structure from a PSN file.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method opens in session a product structure defined from
* a ENOVIAvpm V4 PSN file. Usually, the PSN file is saved from the ENOVIAvpm V4 client
* on unix. 
* The method returns the CATDocument associated to the root part of the product structure.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iuPSNPath
*   The full path of the ENOVIAvpm V4 psn file. 
*   This must be a Unix file path with .psn extension. 
*  Only files stored on unix are supported.
*
* @param iiMode
*   loading mode:
*  &lt;sl&gt;
*   &lt;li&gt;&lt;tt&gt;0&lt;/tt&gt; for static &lt;/li&gt;
*	&lt;li&gt;&lt;tt&gt;1&lt;/tt&gt; for dynamic &lt;/li&gt;
*	&lt;/sl&gt;
*
* @param iiSelection
*   The type of selection:
*  &lt;sl&gt;
*   &lt;li&gt;&lt;tt&gt;0&lt;/tt&gt; for selected instances &lt;/li&gt;
*	&lt;li&gt;&lt;tt&gt;1&lt;/tt&gt; for all instances &lt;/li&gt;
*	&lt;/sl&gt;
*
* @param opDoc
*   The CATProduct document created. 
*
* @param iLoadDoc
*   loading document:
*  &lt;sl&gt;
*   &lt;li&gt;&lt;tt&gt;TRUE&lt;/tt&gt; Open PSN Graph with loading the document &lt;/li&gt;
*   &lt;li&gt;&lt;tt&gt;FALSE&lt;/tt&gt;  Open PSN Graph without loading the document &lt;/li&gt;
*  &lt;/sl&gt;
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The PSN file has been successfuly loaded in session&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: the connection to the database was not previously done &lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: some input parameters are incorrect&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method failed&lt; /li&gt;
*   &lt;/ul&gt;
*/

HRESULT ExportedByCATPinServices OpenAPSNGraph(const CATUnicodeString &amp; iuPSNPath, int iiMode, int iiSelection, CATDocument *&amp; opDoc, CATBoolean iLoadDoc=TRUE);


/**
* Opens a product structure from a PSN file.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method opens in session a product structure defined from
* a ENOVIAvpm V4 PSN file. Usually, the PSN file is saved from the ENOVIAvpm V4 client
* on unix. 
* The method returns the CATDocument associated to the root part of the product structure.
* &lt;br&gt;
* A Where Clause can be used to choose the representation.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iuPSNPath
*   The full path of the ENOVIAvpm V4 psn file. 
*   This must be a Unix file path with .psn extension. 
*  Only files stored on unix are supported.
*
* @param iiMode
*   loading mode:
*  &lt;sl&gt;
*   &lt;li&gt;&lt;tt&gt;0&lt;/tt&gt; for static &lt;/li&gt;
*	&lt;li&gt;&lt;tt&gt;1&lt;/tt&gt; for dynamic &lt;/li&gt;
*	&lt;/sl&gt;
*
* @param iiSelection
*   The type of selection:
*  &lt;sl&gt;
*   &lt;li&gt;&lt;tt&gt;0&lt;/tt&gt; for selected instances &lt;/li&gt;
*	&lt;li&gt;&lt;tt&gt;1&lt;/tt&gt; for all instances &lt;/li&gt;
*	&lt;/sl&gt;
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param opDoc
*   The CATProduct document created.
*
* @param puWhereClause
*    the Where Clause to choose representation. This is a SQL format.
* &lt;br&gt; For instance &lt;tt&gt;&quot; C_REVISION like &#x27;---&#x27; &quot;&lt;/tt&gt;.
* &lt;br&gt; If no Where Clause is specified, the first representation type as specified
* in the settings is loaded.
*  
* @param iLoadDoc
*   loading document:
*  &lt;sl&gt;
*   &lt;li&gt;&lt;tt&gt;TRUE&lt;/tt&gt; Open PSN Graph with loading the document &lt;/li&gt;
*   &lt;li&gt;&lt;tt&gt;FALSE&lt;/tt&gt;  Open PSN Graph without loading the document &lt;/li&gt;
*  &lt;/sl&gt;
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The PSN file has been successfuly loaded in session&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed &lt;/li&gt; 
*   &lt;/ul&gt;
*/

HRESULT ExportedByCATPinServices OpenAPSNGraphWithClause(const CATUnicodeString &amp; iuPSNPath, int iiMode, int iiSelection, CATDocument *&amp; opDoc, CATUnicodeString * puWhereClause, CATBoolean iLoadDoc=TRUE);
/**
* Rebuilds a CATProduct from a downstream document refering to an assembly stored in the ENOVIAvpm V4 database.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method creates a CATProduct in session. This CATProduct contains
* the product structure with all the reference documents that are pointed by the downstream 
*  document. 
* Only the relevant instances that were loaded in session when 
* the downstream document was created will be contained in the CATProduct.
* The CATProduct will also contain all the constraints and the applicative objects associated
* to the root product. 
*&lt;br&gt; The input downstream document must point on an assembly stored in Structure Exploded in the ENOVIAvpm V4 database.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
*
* @param iMode
*	 loading mode
*&lt;br&gt; value &lt;tt&gt;1&lt;/tt&gt; is the only value mode supported.
*
* @param iAssDstDoc
*    CATDocument downstream document refering to an assembly stored in the ENOVIAvpm V4 database.
* @param oProdDoc
*    new CATProduct document if the method is successful
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The CATProduct document has been successfuly built&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed &lt;/li&gt; 
*   &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATRebuildAssemblyFromDstDocument (int iMode,
                                                                    CATDocument *iAssDstDoc,
                                                                    CATDocument *&amp;oProdDoc);

/**
* Returns the ENOVIAvpm V4 environment name of a document.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method returns the environment name of document loaded in session.
*  This returned name is exactly the same value used as &lt;tt&gt;iCatenv&lt;/tt&gt; parameters of following
* methods: 
*  @href CATComputeDocId ,
*  @href CATCreateVPMSession , 
*  @href CATCreateVPMProductStructure ,
*  @href CATOpenConfiguredAssemblyInVPM ,
*  @href CATValuatePdmId .
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iObject
*    CATProduct or CATDocument object 
* @param oEnvironment
*    Environment name
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The environment name is successfuly returned&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed &lt;/li&gt; 
*   &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATGetVPMEnvironment (CATBaseUnknown * iObject,
						       CATUnicodeString &amp;oEnvironment);

/**
*  Simple query on the specified table in the specified environment
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method does a simple query to the ENOVIAVpm V4 for a specified search string
* in the specified table and environment
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPinServices&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
*  @param iEnv
*    The environment to search in
*&lt;br&gt; For instance &lt;tt&gt;&quot;VPMENV  &quot;&lt;/tt&gt;
*  @param iTable
*    the name of the table to search in
* &lt;br&gt; For instance &lt;tt&gt;&quot;DOCUMENT      &quot;&lt;/tt&gt; 
*  @param istring
*    the string criteria for search
*  @param oListOfName
*    Output parameter consisting of list of PDMName matching the string criteria
*  @param oListOfCoid
*    Output parameter consisting of list of coid corresponding to the names searched
*  @param oListOfCompid
*    Output parameter consisting of list of compid corresponding to the names searched
*  @param oListOfCaenv
*    Output parameter consisting of list of environment name corresponding to the names searched
*  @param oListOfCatab
*    Output parameter consisting of list of table name corresponding to the names searched
*
* @return 
*   &lt;ul&gt;
*    &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: Search successful&lt;/li&gt; 
*    &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: Error in the search criteria specified &lt;/li&gt; 
*   &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATSimpleQueryToVPM (CATUnicodeString iEnv,
                                                      CATUnicodeString iTable,
                                                      CATUnicodeString istring,
                                                      CATListOfCATUnicodeString &amp; oListOfName,
                                                      CATListOfCATUnicodeString &amp; oListOfCoid,
                                                      CATListOfCATUnicodeString &amp; oListOfCompid,
                                                      CATListOfCATUnicodeString &amp; oListOfCaenv,
                                                      CATListOfCATUnicodeString &amp; oListOfCatab);

/**
*  Subscribe to CallBack on editor so that highlight in PSN works on batch.
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method subscribes to callback on editor
* After having called ::OpenAPSNGraph and created the editor
*  (CATIObjVisualization Show method) the customer must
*  call ::CATAddCBToCurrentEditor to subscribe to
*  events in the editor.
*&lt;p&gt;
* @return 
*   &lt;ul&gt;
*    &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: subscription successful&lt;/li&gt; 
*    &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: subscription failed &lt;/li&gt; 
*   &lt;/ul&gt;
*/
HRESULT ExportedByCATPinServices CATAddCBToCurrentEditor();


/**
  * Loads VPM objects into a new or existing product structure.
  * @param iRootPDMID
  * the PDMID of the root VPM part
  * @param iCLinkList
  * a list of Clinks representing the child VPM parts (each Clink represents the list of links leading from
  * the root to the child part)
  * @param iDocPDMIDList
  * a list of PDMIDs representing the corresponding documents of the child VPM parts. A PDMID 
  * can be null () if no document must be loaded.
  * @param iOpenAsNew
  * indicates whether the VPM objects should be loaded into a new structure or an existing one.
  * In the later case, a product structure with the same root must be already loaded.
  * @return
  * &lt;ul&gt;
  * &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: objects successfully loaded&lt;/li&gt;
  * &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: input are erroneous&lt;/li&gt;
  * &lt;/ul&gt;
  * &lt;b&gt;Note:&lt;/b&gt; 
  * &lt;ul&gt;
  * &lt;li&gt;PDMIDs of root or documents are expressed as 66 character strings (COID, COMPID, TABLE, ENV, DB)&lt;/li&gt;
  * &lt;li&gt;elements of iCLinkList are hexadecimal representations of Clink whose length is multiple of 16&lt;/li&gt;
  * &lt;li&gt;iCLinkList and iDocPDMIDList must have the same length&lt;/li&gt;
  * &lt;li&gt;elements of iDocPDMIDList can be null () if no document must be loaded&lt;/li&gt;
  * &lt;/ul&gt;           
  */
HRESULT ExportedByCATPinServices CATLoadFromVPM(const CATUnicodeString &amp;iRootPDMID,
                                                const CATListOfCATUnicodeString &amp;iCLinkList,
                                                const CATListOfCATUnicodeString &amp;iDocPDMIDList,
                                                CATBoolean iOpenAsNew);


#endif
</div>
    
    <div class="navigation">
        <div><a href="../../PPRInterfaces/PublicGenerated/win_b64/TIE_CATIAPPRProducts.html">‚Üê ‰∏ä‰∏ÄÈ°µ: TIE_CATIAPPRProducts.h</a></div>
        <div><a href="CATBatchServices2.html">‰∏ã‰∏ÄÈ°µ: CATBatchServices2.h ‚Üí</a></div>
    </div>
</body>
</html>