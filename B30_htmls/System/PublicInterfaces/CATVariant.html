<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System/PublicInterfaces/CATVariant.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>System/PublicInterfaces/CATVariant.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATUuid.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATUuid.h</a></div>
        <div><a href="CATWTypes.html">‰∏ã‰∏ÄÈ°µ: CATWTypes.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">
#ifndef CATVariant_h
#define CATVariant_h

// COPYRIGHT DASSAULT SYSTEMES 2000

/**
 * @CAA2Level L1
 * @CAA2Usage U1
 */

#include &quot;JS0CTYP.h&quot;
#include &quot;CATCORBAAny.h&quot;

#ifndef _WINDOWS_SOURCE

#include &quot;IUnknown.h&quot;
#include &quot;CATJHNTypeLib.h&quot;
#include &quot;CATBSTR.h&quot;
#include &quot;CATWTypes.h&quot;

interface IDispatch;
interface IRecordInfo;

/** @nodoc */
typedef struct tagSAFEARRAY CATSafeArray;

/** @nodoc */
typedef short VARIANT_BOOL;

/** @nodoc */
typedef VARIANT_BOOL _VARIANT_BOOL;

/** @nodoc */
typedef union tagCY {
 struct {
   LONG Hi;
   ULONG Lo;
 } u ;
 LONGLONG int64;
} CY;

/** @nodoc */
struct tagDEC_1_ {
  BYTE scale;
  BYTE sign;
};

/** @nodoc */
struct tagDEC_2_ {
  ULONG Mid32; ULONG Lo32 ;
};

/** @nodoc */
typedef struct tagDEC {
  unsigned short wReserved;
  union {
    struct tagDEC_1_ n1 ;
    unsigned short signscale;
  };
  ULONG Hi32;
  union {
    struct tagDEC_2_ n2 ;
    ULONGLONG Lo64;
  } ;
} DECIMAL;

/** @nodoc */
typedef struct tagVARIANT VARIANT;

/** @nodoc */
typedef VARIANT *LPVARIANT;

/** @nodoc */
typedef VARIANT VARIANTARG;

/** @nodoc */
struct tagVARIANT_1_
{
  void * pvRecord;
  IRecordInfo *pRecInfo;
};

/** @nodoc */
struct tagVARIANT
 {
   VARTYPE vt;
   WORD wReserved1;
   WORD wReserved2;
   WORD wReserved3;
   union
     {
       LONG lVal;
       BYTE bVal;
       short iVal;
       float fltVal;
       double dblVal;
       VARIANT_BOOL boolVal;
       _VARIANT_BOOL vbool;
       LONG scode;
       CY cyVal;
       double date;
       CATBSTR bstrVal;
       IUnknown *punkVal;
       IDispatch *pdispVal;
       CATSafeArray *parray;
       BYTE *pbVal;
       short *piVal;
       LONG *plVal;
       float *pfltVal;
       double *pdblVal;
       VARIANT_BOOL *pboolVal;
       _VARIANT_BOOL *pbool;
       LONG *pscode;
       CY *pcyVal;
       double *pdate;
       CATBSTR *pbstrVal;
       IUnknown * *ppunkVal;
       IDispatch * *ppdispVal;
       CATSafeArray * *pparray;
       VARIANT *pvarVal;
       void * byref;
       char cVal;
       unsigned short uiVal;
       ULONG ulVal;
       int intVal;
       unsigned int uintVal;
       DECIMAL *pdecVal;
       char *pcVal;
       unsigned short *puiVal;
       ULONG *pulVal;
       int *pintVal;
       unsigned int *puintVal;
       struct tagVARIANT_1_ brecVal ;
     } ;
 };

/** @nodoc */
struct _tagVARIANT
{
  union
    {
      struct tagVARIANT n2 ;
      DECIMAL decVal;
    } ;
};

/** @nodoc */
#define V_VT(X)          ((X)-&gt;vt)

/** @nodoc */
#define V_I4(X)          ((X)-&gt;lVal)

/** @nodoc */
#define V_BSTR(X)          ((X)-&gt;bstrVal)

/** @nodoc */
#define V_I2(X)          ((X)-&gt;iVal)

/** @nodoc */
#define V_R4(X)          ((X)-&gt;fltVal)

/** @nodoc */
#define V_R8(X)          ((X)-&gt;dblVal)

/** @nodoc */
#define V_DISPATCH(X)          ((X)-&gt;pdispVal)

/** @nodoc */
#define V_BOOL(X)          ((X)-&gt;boolVal)

/** @nodoc */
#define V_UNKNOWN(X)          ((X)-&gt;punkVal)

/** @nodoc */
#define V_I1(X)          ((X)-&gt;cVal)

/** @nodoc */
#define V_UI1(X)          ((X)-&gt;bVal)

/** @nodoc */
#define V_UI2(X)          ((X)-&gt;uiVal)

/** @nodoc */
#define V_UI4(X)          ((X)-&gt;ulVal)

/** @nodoc */
#define V_DATE(X)          ((X)-&gt;date)

/** 
 * Defines the variant type to be used by Automation interfaces.
 */
typedef VARIANT CATVariant;

#else
#include &quot;windows.h&quot;

/** 
 * Defines the variant type to be used by Automation interfaces.
 */
typedef VARIANT CATVariant;

#endif

/** 
 * Function to invoke to free &lt;tt&gt;CATVariant&lt;/tt&gt; types.
 */
ExportedByJS0CTYP HRESULT CATVariantClear(CATVariant * iVariant);

/** @nodoc */
ExportedByJS0CTYP HRESULT ConvertAnyToVariant(const any &amp; iAny, CATVariant* oVariant);

/** @nodoc */
ExportedByJS0CTYP any * BuildAnyFromVariant (const CATVariant &amp; iVariant);

#endif
</div>
    
    <div class="navigation">
        <div><a href="CATUuid.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATUuid.h</a></div>
        <div><a href="CATWTypes.html">‰∏ã‰∏ÄÈ°µ: CATWTypes.h ‚Üí</a></div>
    </div>
</body>
</html>