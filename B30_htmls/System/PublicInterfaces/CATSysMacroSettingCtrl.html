<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System/PublicInterfaces/CATSysMacroSettingCtrl.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>System/PublicInterfaces/CATSysMacroSettingCtrl.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATSysErrorLog.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATSysErrorLog.h</a></div>
        <div><a href="CATSysParamMap.html">‰∏ã‰∏ÄÈ°µ: CATSysParamMap.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">/* -*-c++-*- */
#ifndef CATSysMacSettingController_H
#define CATSysMacSettingController_H

// COPYRIGHT DASSAULT SYSTEMES 2003
/**
 * @CAA2Level L1
 * @CAA2Usage U1
 */

// System framework
#include &quot;IUnknown.h&quot;   
#include &quot;CATBaseObject.h&quot;
#include &quot;CATSafeArray.h&quot;
#include &quot;CATBoolean.h&quot;
#include &quot;CAT_VARIANT_BOOL.h&quot;
#include &quot;CATAutoConversions.h&quot;
#include &quot;CATDataType.h&quot;
#include &quot;JS0SETT.h&quot;
#include &quot;CATSettingInfo.h&quot;
#include &quot;CATSysSettingController.h&quot;
#include &quot;CATSysAutoSettingController.h&quot;
#include &quot;CATSysSettingCtrlNotif.h&quot;
#include &quot;CATCreateClassInstance.h&quot; // For CATAddOMFactoryFunction

// TIE for the 3 generic interfaces 
#include &quot;TIE_CATIASettingController.h&quot;
#include &quot;TIE_CATICreateInstance.h&quot;
#include &quot;TIE_CATISysSettingController.h&quot;

#include &quot;CATSysParamMap.h&quot;

/**
 * Declares a setting controller.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: Declares a class that implements a setting controller. 
 * The controller implements the interface @href CATISysSettingController
 * for managing the generic operations as (Save, Commit, ResetToAdminValues)
 * on the setting controller. To access the specific parameters it 
 * must implement an interface BrandIFWNameSettingAtt.
 * The name of the class must be BrandFWNameSettingCtrl. 
 * @param Brand
 *   The brand to which this controller belongs
 * @param FW
 *   The framework in which the controller is implemented
 * @param Name
 *   The name of the controller
 */
#define CATDeclareSettingCtrl(Brand,FW,Name)				\
CATDeclareClass;							\
private:								\
static Brand##FW##Name##SettingCtrl* _TheCtrl;				\
Brand##FW##Name##SettingCtrl (const char * iSettingName);		\
public:									\
static HRESULT GetTheController(const IID &amp; iIID,			\
				CATBaseUnknown**oItf)


/**
 * Declares a settings controller for Automation.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: Declares a class that implements a settings controller. 
 * The controller implements the interface @href CATIASettingController 
 * for managing the generic operations as (Save, Commit, ResetToAdminValues)
 * on the setting controller. To access the specific parameters it
 * must implement an interface BrandIAFWNameSettingAtt for Automation.
 * The name of the class must be BrandFWNameAutoSettingCtrl. 
 * This class will form an Object Modeler component with the 
 * BrandFWNameSettingCtrl that implement the five following interfaces:
 * &lt;ul&gt;
 *  &lt;li&gt;&lt;tt&gt; BrandIFWNameSettingAtt&lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt; BrandIANameSettingAtt&lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt; @href CATISysSettingController &lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt; @href CATIASettingController &lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt; @href CATICreateInstance &lt;/tt&gt;&lt;/li&gt;
 * &lt;/ul&gt;
 * @param Brand
 *  The brand to which this controller belongs
 * @param FW
 *   The framework in which the controller is implemented
 * @param Name
 *   The name of the controller
 */
#define CATDeclareAutoSettingCtrl(Brand,FW,Name)			\
CATDeclareClass;							\
public:									\
Brand##FW##Name##AutoSettingCtrl();					\
virtual ~Brand##FW##Name##AutoSettingCtrl()				\



/**
 * Macro used to define a setting controller.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: Defines a class that implements a settings controller. 
 * The controller implements the interface @href CATISysSettingController for 
 * managing the generic operations (Save, Commit, ResetToAdminValues) on the 
 * setting controller. To access the specific parameters it must 
 * implement an interface which name is BrandIFWNameSettingAtt.
 * It implements the new instantiation mechanism (CATAddOMFactoryFunction) too, 
 * the entry &quot;Brand##FW##Name##SettingCtrl OMFactoryFunctionType libMyLibrary&quot; must be added
 * to your framework .func dictionary.
 * Thus the following includes must be used in the source code:
 *	&lt;br&gt;&lt;tt&gt; #include &quot;TIE_BrandIFWNameSettingAtt.h&quot; &lt;/tt&gt;
 * @param Brand
 *   The brand to which this controller belongs
 * @param FW
 *   The framework in which the controller is implemented
 * @param Name
 *   The name of the controller
 * @param SettingName
 *   The name of the setting file used by the controller
 */
#define CATImplementSettingCtrlNew(Brand,FW,Name,SettingName)		\
CATBaseUnknown* Brand##FW##Name##SettingCtrlExtCreateInstance() \
{  \
  CATBaseUnknown * rcBU = NULL;  \
  HRESULT hres=Brand##FW##Name##SettingCtrl::GetTheController(IID_CATISysSettingController,&amp;rcBU); \
  if (FAILED(hres)) \
	rcBU = NULL;	\
  return rcBU ; \
} \
CATAddOMFactoryFunction(Brand##FW##Name##SettingCtrl,Brand##FW##Name##SettingCtrlExtCreateInstance) \
/* TIE for  CATISysSettingController and Name##Att*/			\
/* the include must be done in the code */				\
CATImplementClass(Brand##FW##Name##SettingCtrl,Implementation,		\
		  CATSysSettingController,CATNull);			\
TIEchain_CATISysSettingController(Brand##FW##Name##SettingCtrl);	\
TIEchain_##Brand##I##FW##Name##SettingAtt(Brand##FW##Name##SettingCtrl);\
									\
Brand##FW##Name##SettingCtrl*						\
		Brand##FW##Name##SettingCtrl::_TheCtrl=NULL;		\
static CATSysParamMap * Brand##FW##Name##ParamMap=NULL;		\
HRESULT Brand##FW##Name##SettingCtrl::GetTheController(const IID &amp;iIID,	\
			                     CATBaseUnknown**oItf)	\
{									\
   HRESULT hres =S_OK;			  				\
   if (oItf==NULL) return E_FAIL;					\
   if ( _TheCtrl==NULL)							\
     {									\
        _TheCtrl =new Brand##FW##Name##SettingCtrl( #SettingName);	\
        if (_TheCtrl==NULL) return E_OUTOFMEMORY;			\
        HRESULT hres =_TheCtrl-&gt;Initialize();			        \
        if (FAILED(hres)) return E_FAIL;				\
        /* first commit to begin the rollback system	*/		\
        hres =_TheCtrl-&gt;Commit();					\
     }									\
  /* in order to force a call to Initialize() in DumpMode*/		\
  /*if (CATSysSettingController::ReadDumpMode())*/			\
  /*  {							*/		\
  /*    CATSysSettingController *tmp= NULL;		*/		\
  /*    tmp =( CATSysSettingController *)_TheCtrl-&gt;GetImpl();*/		\
  /*     if ( tmp ) tmp-&gt;Dump();	*/				\
  /*  }	*/								\
									\
  _TheCtrl-&gt;_ParamMap = Brand##FW##Name##ParamMap;			\
  hres =  _TheCtrl-&gt;QueryInterface ( iIID, (void**) oItf);		\
  return hres;								\
}




/**
 * Macro used to define a setting controller.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: Defines a class that implements a settings controller. 
 * The controller implements the interface @href CATISysSettingController for 
 * managing the generic operations (Save, Commit, ResetToAdminValues) on the 
 * setting controller. To access the specific parameters it must 
 * implement an interface which name is BrandIFWNameSettingAtt.
 * It implements the @href CATICreateInstance interface too.
 * Thus the following includes must be used in the source code:
 *	&lt;br&gt;&lt;tt&gt; #include &quot;TIE_BrandIFWNameSettingAtt.h&quot; &lt;/tt&gt;
 * @param Brand
 *   The brand to which this controller belongs
 * @param FW
 *   The framework in which the controller is implemented
 * @param Name
 *   The name of the controller
 * @param SettingName
 *   The name of the setting file used by the controller
 */
#define CATImplementSettingCtrl(Brand,FW,Name,SettingName)		\
/* CATICreateInstance*/							\
class Brand##FW##Name##SettingCtrlExt : public CATBaseUnknown		\
{									\
CATDeclareClass;							\
public:									\
HRESULT __stdcall CreateInstance(void **oPPV);				\
};									\
CATImplementClass(Brand##FW##Name##SettingCtrlExt,CodeExtension,	\
                  CATBaseUnknown,Brand##FW##Name##SettingCtrl);		\
TIE_CATICreateInstance(Brand##FW##Name##SettingCtrlExt);		\
									\
HRESULT Brand##FW##Name##SettingCtrlExt::CreateInstance(void **oPPV)    \
{									\
  HRESULT hres= E_FAIL;							\
  if (oPPV == NULL)  return hres;					\
  CATISysSettingController *Ctrl=NULL;					\
  hres=Brand##FW##Name##SettingCtrl::GetTheController(			\
	     			IID_CATISysSettingController,		\
	                        (CATBaseUnknown**)&amp;Ctrl);		\
  if (( hres != S_OK) || ( Ctrl == NULL))  return E_FAIL;		\
  *oPPV = Ctrl;								\
  return S_OK;								\
}									\
/* TIE for  CATISysSettingController and Name##Att*/			\
/* the include must be done in the code */				\
CATImplementClass(Brand##FW##Name##SettingCtrl,Implementation,		\
		  CATSysSettingController,CATNull);			\
TIEchain_CATISysSettingController(Brand##FW##Name##SettingCtrl);	\
TIEchain_##Brand##I##FW##Name##SettingAtt(Brand##FW##Name##SettingCtrl);\
									\
Brand##FW##Name##SettingCtrl*						\
		Brand##FW##Name##SettingCtrl::_TheCtrl=NULL;		\
static CATSysParamMap * Brand##FW##Name##ParamMap=NULL;		\
HRESULT Brand##FW##Name##SettingCtrl::GetTheController(const IID &amp;iIID,	\
			                     CATBaseUnknown**oItf)	\
{									\
   HRESULT hres =S_OK;			  				\
   if (oItf==NULL) return E_FAIL;					\
   if ( _TheCtrl==NULL)							\
     {									\
        _TheCtrl =new Brand##FW##Name##SettingCtrl( #SettingName);	\
        if (_TheCtrl==NULL) return E_OUTOFMEMORY;			\
        HRESULT hres =_TheCtrl-&gt;Initialize();			        \
        if (FAILED(hres)) return E_FAIL;				\
        /* first commit to begin the rollback system	*/		\
        hres =_TheCtrl-&gt;Commit();					\
     }									\
  /* in order to force a call to Initialize() in DumpMode*/		\
  /*if (CATSysSettingController::ReadDumpMode())*/			\
  /*  {							*/		\
  /*    CATSysSettingController *tmp= NULL;		*/		\
  /*    tmp =( CATSysSettingController *)_TheCtrl-&gt;GetImpl();*/		\
  /*     if ( tmp ) tmp-&gt;Dump();	*/				\
  /*  }	*/								\
									\
  _TheCtrl-&gt;_ParamMap = Brand##FW##Name##ParamMap;			\
  hres =  _TheCtrl-&gt;QueryInterface ( iIID, (void**) oItf);		\
  return hres;								\
}





/**
 * Macro used to define a setting controller for Automation.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: Defines a class that implements a settings controller. 
 * The controller implements the interface @href CATIASettingController for 
 * managing the generic operations (Save, Commit, ResetToAdminValues) on the 
 * setting controller. To access the specific parameters it must 
 * implement an interface which name is BrandIANameSettingAtt.
 * Thus the following include must be used in the source code:
 *	&lt;br&gt;&lt;tt&gt; #include &quot;TIE_BrandIAFWNameSettingAtt.h&quot; &lt;/tt&gt;
 * This class will form an Object Modeler component with the 
 * BrandFWNameSettingCtrl that implements the five following interfaces:
 * &lt;ul&gt;
 *  &lt;li&gt;&lt;tt&gt; BrandIFWNameSettingAtt&lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt; BrandIANameSettingAtt&lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt; @href CATISysSettingController &lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt; @href CATIASettingController &lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt; @href CATICreateInstance &lt;/tt&gt;&lt;/li&gt;
 * &lt;/ul&gt;
 * @param Brand
 *   The brand to which belong this controller belongs
 * @param FW
 *   The framework in which the controller is implemented
 * @param Name
 *   The name of the controller
 */
#define CATImplAutoSettingCtrl(Brand,FW,Name)				\
/* The automation is an extension of the C++ */				\
CATImplementClass(Brand##FW##Name##AutoSettingCtrl,DataExtension,	\
		  CATBaseUnknown,					\
		  Brand##FW##Name##SettingCtrl);			\
TIEchain_##Brand##IA##Name##SettingAtt(Brand##FW##Name##AutoSettingCtrl);\
	       								\
Brand##FW##Name##AutoSettingCtrl::Brand##FW##Name##AutoSettingCtrl(){}  \
Brand##FW##Name##AutoSettingCtrl::~Brand##FW##Name##AutoSettingCtrl(){} \
									\





/**
 * Macro implementing the method retrieving information concerning a setting parameter.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: For each settings&#x27; attribute of a setting controller, 
 * the BrandIFWNameSettingAtt interface must define a CATSettingInfo 
 * retrieving method. The same method must be implemented too in the 
 * Automation context.
 * Thus the implementation class that has been defined with the 
 * macros @href CATDeclareAutoSettingCtrl and @href CATImplAutoSettingCtrl 
 * must implement the following method:
 *  &lt;br&gt;&lt;tt&gt; HRESULT BrandFWNameAutoSettingCtrl::GetParamNameInfo(CATBSTR &amp; AdminLevel,	unsigned char &amp;oModified, unsigned char &amp;oLocked)&lt;/tt&gt;
 * @param Brand
 *   The brand to which this controller belongs 
 * @param FW
 *   The framework in which the controller is implemented
 * @param Name
 *   The name of the controller
 * @param ParamName
 *   The name of the setting parameter
 */
#define CATImplAutoSettingCtrlInfoMethod(Brand,FW,Name,ParamName)	\
HRESULT Brand##FW##Name##AutoSettingCtrl::Get##ParamName##Info(		\
					CATBSTR &amp; AdminLevel,		\
					CATBSTR &amp; oLocked,		\
					CAT_VARIANT_BOOL &amp; oModif)		\
{									\
  HRESULT hres = E_FAIL;						\
  Brand##I##FW##Name##SettingAtt *Att=NULL;				\
  hres = QueryInterface ( IID_##Brand##I##FW##Name##SettingAtt,		\
			  (void**)&amp;Att);				\
  if (FAILED(hres))							\
    return hres;							\
  CATSettingInfo Info;							\
  hres = Att-&gt;Get##ParamName##Info( &amp;Info);				\
  if (FAILED(hres))							\
    return hres;							\
  CATUnicodeString Level;						\
  CATSysSettingController::MapLevel( Info, Level);			\
  Level.ConvertToBSTR(  &amp;AdminLevel);					\
  oModif = BOOL_TO_VARBOOL(Info._Explicit);				\
  CATUnicodeString Lock;						\
  CATSysSettingController::MapLock(Info, Lock);				\
  Lock.ConvertToBSTR(  &amp;oLocked);					\
  Att-&gt;Release();							\
  return S_OK;								\
}									\



/**
 * Begins the implementation sequence of the methods dealing with the locks of a setting parameter.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: For each parameter exposed by a setting controller 
 * in its interface BrandIFWNameSettingAtt, a method dealing with the lock
 * and a method retrieving the information concerning the parameter must be 
 * available. 
 * This macro begins the macro sequence that should be used in conjunction 
 * with @href CATSysAddImplSettingCtrlLocks 
 * and @href CATSysEndImplSettingCtrlLocks
 * This sequence will implement the two following methods:
 * &lt;ul&gt;
 *  &lt;li&gt;&lt;tt&gt;HRESULT BrandFWNameSettingCtrl::GetInfoParamName(CATSettingInfo* oInfo)&lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt;HRESULT BrandFWNameSettingCtrl::SetLockParamName (unsigned char iLock)&lt;/tt&gt;&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;p&gt;If the controller&#x27;s parameter is built from many
 * CATSysSettingController&#x27;s attributes then the name of the other attributes 
 * must be specified by using the @href CATSysAddImplSettingCtrlLocks macro for 
 * each attribute. These attributes are semantically bounded and thus are 
 * locked or unlocked together.&lt;/p&gt; 
 * @param Brand
 *   The brand to which this controller belongs
 * @param FW
 *   The framework in which the controller is implemented
 * @param Name
 *   The name of the controller
 * @param ParamName
 *   The name of the setting&#x27;s parameter used in the method&#x27;s name
  * @param AttrName
 *   The name of the first underlying setting&#x27;s attribute
 */
#ifdef _LINUX_SOURCE
#define CATSysBeginImplSettingCtrlLocks(Brand,FW,Name,ParamName,AttrName)\
HRESULT Brand##FW##Name##SettingCtrl::Get##ParamName##Info (		\
						CATSettingInfo* oInfo)	\
{									\
  HRESULT hres= (GetInfo ( #AttrName, oInfo));				\
  if (SUCCEEDED(hres) &amp;&amp; (oInfo))					\
    {									\
       oInfo-&gt;SetFunc((CATSysSettingCtrlInfoMethod)			\
  		&amp;Brand##FW##Name##SettingCtrl::Get##ParamName##Info,	\
  		       (CATSysSettingCtrlLockingMethod)			\
  		&amp;Brand##FW##Name##SettingCtrl::Set##ParamName##Lock,	\
  			_TheCtrl, #ParamName);				\
    }									\
  return hres;								\
}									\
static char* Brand##FW##Name##ParamName[]={#ParamName,#AttrName		
#else
#define CATSysBeginImplSettingCtrlLocks(Brand,FW,Name,ParamName,AttrName)\
HRESULT Brand##FW##Name##SettingCtrl::Get##ParamName##Info (		\
						CATSettingInfo* oInfo)	\
{									\
  HRESULT hres= (GetInfo ( #AttrName, oInfo));				\
  if (SUCCEEDED(hres) &amp;&amp; (oInfo))					\
    {									\
       oInfo-&gt;SetFunc((CATSysSettingCtrlInfoMethod)			\
  		&amp;Brand##FW##Name##SettingCtrl::Get##ParamName##Info,	\
  		       (CATSysSettingCtrlLockingMethod)			\
  		&amp;Brand##FW##Name##SettingCtrl::Set##ParamName##Lock,	\
  			_TheCtrl, #ParamName);				\
    }									\
  return hres;								\
}									\
static char* Brand##FW##Name##ParamName[]={#ParamName,#AttrName	
#endif


/**
 * Continues the implementation sequence of the methods dealing with the locks of a setting parameter.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: This macro declares that the current controller&#x27;s parameter 
 * is built from at least one other @href CATSysSettingController attribute.
 * This attribute AttrName is semantically bounded with the first one declared
 * as the third argument of the @href CATSysBeginImplSettingCtrlLocks &lt;/p&gt;
 * @param Brand
 *   The brand to which this controller belongs
 * @param FW
 *   The framework in which the controller is implemented
 * @param Name
 *   The name of the controller
 * @param ParamName
 *   The name of the setting parameter used in the method&#x27;s name
 * @param AttrName
 *   The name of one other underlying setting attribute
 */
#define CATSysAddImplSettingCtrlLocks(Brand,FW,Name,ParamName,AttrName)	\
					,#AttrName			\



/**
 * Ends the implementation sequence of the methods dealing with the locks of a setting parameter.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;:This macro ends the macro sequence that have been begun
 * with  @href CATSysBeginImplSettingCtrlLocks .
 * The two following methods are now implemented:
 * &lt;ul&gt;
 *  &lt;li&gt;&lt;tt&gt;HRESULT BrandFWNameSettingCtrl::GetParamNameInfo(CATSettingInfo* oInfo)&lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt;HRESULT BrandFWNameSettingCtrl::SetLockParamName (unsigned char iLock)&lt;/tt&gt;&lt;/li&gt;
 * &lt;/ul&gt;
 * @param Brand
 *   The brand to which this controller belongs
 * @param FW
 *   The framework in which the controller is implemented
 * @param Name
 *   The name of the controller
 * @param ParamName
 *   The name of the setting&#x27;s parameter used in the method&#x27;s name
 */
#define CATSysEndImplSettingCtrlLocks(Brand,FW,Name,ParamName)		\
					,NULL};				\
static CATSysParamMap Brand##FW##Name##ParamName##Map (			\
					&amp;Brand##FW##Name##ParamMap,	\
					Brand##FW##Name##ParamName);	\
HRESULT Brand##FW##Name##SettingCtrl::Set##ParamName##Lock (		\
					unsigned char iLock)		\
{									\
  HRESULT hres = S_OK;							\
  if ( iLock ==FALSE)							\
    {									\
      int i =0;								\
      /* [0] =  #ParamName   */						\
      while (Brand##FW##Name##ParamName[i+1])				\
	{								\
	  hres+=Unlock(Brand##FW##Name##ParamName[i+1]);		\
	  i++;								\
	}								\
    }									\
  else									\
    {									\
      int i =0;								\
      while (Brand##FW##Name##ParamName[i+1])				\
	{								\
	  hres+=Lock( Brand##FW##Name##ParamName[i+1]);			\
	  i++;								\
	}								\
    }									\
 if (hres != S_OK)							\
   return E_FAIL;							\
 else									\
   return hres;								\
}									\

					
/**
 * Implements the methods dealing with the locks of a seting parameter.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: For each parameter exposed by a settings controller 
 * in its interface BrandIFWNameSettingAtt, a method dealing with the lock 
 * and a method retrieving the information concerning the parameter must be 
 * available.
 * This macro will implement the three following methods:
 * &lt;ul&gt;
 *  &lt;li&gt;&lt;tt&gt;HRESULT BrandFWNameSettingCtrl::GetParamNameInfo(CATSettingInfo* oInfo)&lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt;HRESULT BrandFWNameSettingCtrl::SetLockParamName (unsigned char iLock)&lt;/tt&gt;&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;br&gt;This macro must be used if the controller&#x27;s parameter represents only
 * one CATSysSettingController&#x27;s attribute. It is equivalent to the use of the
 * two macro  @href CATSysBeginImplSettingCtrlLocks 
 * and @href CATSysEndImplSettingCtrlLocks in the following sequence :
 * &lt;br&gt;&lt;tt&gt;CATSysBeginImplSettingCtrlLocks(Brand,FW,Name,ParamName,AttrName)&lt;/tt&gt;
 * &lt;br&gt;&lt;tt&gt;CATSysEndImplSettingCtrlLocks(Brand,FW,Name,ParamName)&lt;/tt&gt;
 * @param Brand
 *   The brand to which this controller belongs
 * @param FW
 *   The framework in which the controller is implemented
 * @param Name
 *   The name of the controller
 * @param ParamName
 *   The name of the setting&#x27;s parameter which is used in the method&#x27;s name
  * @param AttrName
 *   The name of the unique underlying setting&#x27;s attribute
 */
#if defined(_LINUX_SOURCE) || defined(_DARWIN_SOURCE) || defined(_IOS_SOURCE)|| defined (_ANDROID_SOURCE)

#define CATSysImplementSettingCtrlLocks(Brand,FW,Name,ParamName,AttrName)  \
static char* Brand##FW##Name##ParamName[]={#ParamName,#AttrName,NULL};  \
static CATSysParamMap Brand##FW##Name##ParamName##Map (			\
					&amp;Brand##FW##Name##ParamMap,	\
					Brand##FW##Name##ParamName);	\
HRESULT Brand##FW##Name##SettingCtrl::Get##ParamName##Info (		\
						CATSettingInfo* oInfo)	\
{									\
  /* If the Controller parameter is made from many attributes   */	\
  /* Only the first one will be used for the GetInfo but all    */	\
  /* will be locked						*/	\
  HRESULT hres =GetInfo ( #AttrName, oInfo);				\
  if (SUCCEEDED(hres) &amp;&amp; (oInfo))					\
    {									\
       oInfo-&gt;SetFunc((CATSysSettingCtrlInfoMethod)			\
  		&amp;Brand##FW##Name##SettingCtrl::Get##ParamName##Info,	\
  		       (CATSysSettingCtrlLockingMethod)			\
  		&amp;Brand##FW##Name##SettingCtrl::Set##ParamName##Lock,	\
  			_TheCtrl, #ParamName);				\
    }									\
  return hres;								\
}									\
									\
HRESULT Brand##FW##Name##SettingCtrl::Set##ParamName##Lock (		\
					unsigned char iLock)		\
{									\
  if ( iLock ==FALSE)							\
    return  Unlock ( #AttrName);					\
  else									\
    return Lock (#AttrName);						\
}									
#else

#define CATSysImplementSettingCtrlLocks(Brand,FW,Name,ParamName,AttrName)  \
static char* Brand##FW##Name##ParamName[]={#ParamName,#AttrName,NULL};  \
static CATSysParamMap Brand##FW##Name##ParamName##Map (			\
					&amp;Brand##FW##Name##ParamMap,	\
					Brand##FW##Name##ParamName);	\
HRESULT Brand##FW##Name##SettingCtrl::Get##ParamName##Info (		\
						CATSettingInfo* oInfo)	\
{									\
  /* If the Controller parameter is made from many attributes   */	\
  /* Only the first one will be used for the GetInfo but all    */	\
  /* will be locked						*/	\
  HRESULT hres =GetInfo ( #AttrName, oInfo);				\
  if (SUCCEEDED(hres) &amp;&amp; (oInfo))					\
    {									\
       oInfo-&gt;SetFunc((CATSysSettingCtrlInfoMethod)			\
  		&amp;Brand##FW##Name##SettingCtrl##::Get##ParamName##Info,	\
  		       (CATSysSettingCtrlLockingMethod)			\
  		&amp;Brand##FW##Name##SettingCtrl##::Set##ParamName##Lock,	\
  			_TheCtrl, #ParamName);				\
    }									\
  return hres;								\
}									\
									\
HRESULT Brand##FW##Name##SettingCtrl::Set##ParamName##Lock (		\
					unsigned char iLock)		\
{									\
  if ( iLock ==FALSE)							\
    return  Unlock ( #AttrName);					\
  else									\
    return Lock (#AttrName);						\
}									
#endif







/**
 * Implements the methods dealing with the locks of a seting parameter in the Automation context.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: For each parameter exposed by a settings controller 
 * in its interface BrandIANameSettingAtt, a method dealing with the lock 
 * and a method retrieving the information concerning the parameter must be 
 * available.
 * This macro will implement the three following methods:
 * &lt;ul&gt;
 *  &lt;li&gt;&lt;tt&gt;HRESULT BrandFWNameAutoSettingCtrl::GetParamNameInfo(CATSettingInfo* oInfo)&lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt;HRESULT BrandFWNameSettingCtrl::SetLockParamName (unsigned char iLock)&lt;/tt&gt;&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;br&gt;This macro must be used if the controller&#x27;s parameter represents only
 * one CATSysSettingController&#x27;s attribute. It is equivalent to the use of the
 * two macros  @href CATSysBeginImplSettingCtrlLocks 
 * and  @href CATSysEndImplSettingCtrlLocks in the following sequence:
 * &lt;br&gt;&lt;tt&gt;CATSysBeginImplSettingCtrlLocks(ClassName,ParamName,AttrName)&lt;/tt&gt;
 * &lt;br&gt;&lt;tt&gt;CATSysEndImplSettingCtrlLocks(ClassName,ParamName)&lt;/tt&gt;
 * @param ClassName
 *   The class name of the object implementing the controller
 * @param ParamName
 *   The name of the setting&#x27;s parameter used in the method&#x27;s name
 */
#define CATSysImplAutoSettingCtrlLocks(Brand,FW,Name,ParamName)		\
CATImplAutoSettingCtrlInfoMethod(Brand,FW,Name,ParamName)		\
									\
HRESULT Brand##FW##Name##AutoSettingCtrl::Set##ParamName##Lock (	\
					CAT_VARIANT_BOOL iLock)		\
{									\
  HRESULT hres = E_FAIL;						\
  Brand##I##FW##Name##SettingAtt *Att=NULL;				\
  hres = QueryInterface ( IID_##Brand##I##FW##Name##SettingAtt,		\
			  (void**)&amp;Att);				\
  hres = Att-&gt;Set##ParamName##Lock (VARBOOL_TO_BOOL(iLock));				\
  Att-&gt;Release();							\
  return hres;								\
}									\






/**
 * Declares the methods dealing with the setting parameter locks.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: For each parameter exposed by a settings controller 
 * in its interface BrandIFWNameSettingAtt a method dealing with the lock 
 * and a method retrieving the information concerning the parameter must be 
 * available. 
 * This macro will declare the three following methods in the class 
 * implementing the two interfaces:
 * &lt;ul&gt;
 *  &lt;li&gt;&lt;tt&gt;HRESULT BrandFWNameSettingCtrl::GetParamNameInfo(CATSettingInfo* oInfo)&lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt;HRESULT BrandFWNameSettingCtrl::SetParamNameLock(unsigned char iLock)&lt;/tt&gt;&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;br&gt;The implementation macros are @href CATSysBeginImplSettingCtrlLocks , 
 * @href CATSysAddImplSettingCtrlLocks and @href CATSysEndImplSettingCtrlLocks 
 * or @href CATSysImplementSettingCtrlLocks
 * @param ClassName
 *   The class name of the objet implementing the controller
 * @param ParamName
 *   The name of the setting&#x27;s parameter used in the method&#x27;s name
 */
#if defined (_LINUX_SOURCE) || defined (_ANDROID_SOURCE)
#define CATSysDeclareSettingCtrlLocks(ParamName)			\
HRESULT Set##ParamName##Lock(unsigned char iLock);			\
HRESULT Get##ParamName##Info(CATSettingInfo* oInfo)			
#else
#define CATSysDeclareSettingCtrlLocks(ParamName)			\
HRESULT Set##ParamName##Lock (unsigned char iLock);			\
HRESULT Get##ParamName##Info(CATSettingInfo* oInfo)			
#endif

/**
 * Declares the methods dealing with the setting parameter locks.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: For each parameter exposed by a settings controller 
 * in its interface BrandIANameSettingAtt a method dealing with the lock 
 * and a method retrieving the information concerning the parameter must be 
 * available. 
 * This macro will declare the three following methods in the class 
 * implementing the two interfaces:
 * &lt;ul&gt;
 *  &lt;li&gt;&lt;tt&gt;HRESULT BrandIANameSettingCtrl::GetParamNameInfo(CATSettingInfo* oInfo)&lt;/tt&gt;&lt;/li&gt;
 *  &lt;li&gt;&lt;tt&gt;HRESULT BrandIANameSettingCtrl::SetParamNameLock(unsigned char iLock)&lt;/tt&gt;&lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;br&gt;The implementation macro is @href CATSysImplAutoSettingCtrlLocks 
 * @param ClassName
 *   The class name of the object implementing the controller
 * @param ParamName
 *   The name of the setting&#x27;s parameter used in the method&#x27;s name
 */
#define CATSysDeclareAutoSettingCtrlLocks(ParamName)			\
HRESULT Set##ParamName##Lock (CAT_VARIANT_BOOL iLock);			\
HRESULT Get##ParamName##Info(CATBSTR &amp; AdminLevel,			\
			     CATBSTR &amp; oLocked,				\
	                     CAT_VARIANT_BOOL &amp;oModified)			\






/**
 * Dispatches an event when a setting single parameter is modified.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: For each parameter exposed by a settings controller 
 * it is possible to dispatch an event when this parameter is modified.
 * This macro can be used in the implementation of the SetParam method if
 * the dispatching of the event @href CATSysSettingController#Param_Updated
 * is needed.
 * @param ParamName
 *   The name of the parameter
 */
#define CATSysSettingCtrlDispatch(ParamName)				\
CATSettingInfo Info;							\
HRESULT hres= Get##ParamName##Info( &amp;Info);				\
CATSysSettingCtrlNotif *Notif = NULL;					\
Notif = new CATSysSettingCtrlNotif(SettingCtrl_Updated(), &amp;Info);	\
GetDefaultCallbackManager(this)-&gt;DispatchCallbacks( Param_Updated(),	\
						    Notif,this)		\





#endif
</div>
    
    <div class="navigation">
        <div><a href="CATSysErrorLog.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATSysErrorLog.h</a></div>
        <div><a href="CATSysParamMap.html">‰∏ã‰∏ÄÈ°µ: CATSysParamMap.h ‚Üí</a></div>
    </div>
</body>
</html>