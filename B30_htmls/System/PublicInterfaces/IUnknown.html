<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System/PublicInterfaces/IUnknown.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>System/PublicInterfaces/IUnknown.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="ITypeLib.html">‚Üê ‰∏ä‰∏ÄÈ°µ: ITypeLib.h</a></div>
        <div><a href="IdlDesc.html">‰∏ã‰∏ÄÈ°µ: IdlDesc.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">#ifndef IUnknown_H
#define IUnknown_H

// COPYRIGHT DASSAULT SYSTEMES  1999

/**
 * @CAA2Level L1
 * @CAA2Usage U5 
 */


#ifndef _WINDOWS_SOURCE

#include &quot;CATSysErrorDef.h&quot;
#include &quot;CATSysDataType.h&quot;

/**
 * Return type for the QueryInterface method, and for most interface methods. 
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: This type allows you to analyze the result of a call for
 * the &lt;tt&gt;QueryInterface&lt;/tt&gt; method and for most interface methods. 

 * &lt;ol&gt;
 * &lt;li&gt;In the case of the &lt;tt&gt;QueryInterface&lt;/tt&gt; method &lt;/li&gt;
 * &lt;br&gt;&lt;br&gt;To test the result, always use the macros @href SUCCEEDED and @href FAILED.
 * &lt;pre&gt;
 *
 *  IMyInterface * pIMyInterface = NULL ;
 *  HRESULT rc = pIMyOtherInterface-&gt;QueryInterface(IID_IMyInterface,(void**) &amp;pIMyInterface);
 * 
 *  //Test with SUCCEEDED macro:
 *  
 *  if ( SUCCEEDED(rc) )
 *  {
 *      // In this case, rc is &lt;b&gt;S_OK&lt;/b&gt;
 *      // pIMyInterface is valid 
 *      ....
 *  }
 *
 *  //Test with FAILED macro
 *
 *  if ( FAILED(rc) )
 *  {
 *      // In this case, rc is &lt;b&gt;E_NOINTERFACE&lt;/b&gt; or &lt;b&gt;E_UNEXPECTED&lt;/b&gt;
 *      // pIMyInterface is not valid 
 *  }
 *
 * &lt;/pre&gt;
 * &lt;li&gt;In the case of an interface method &lt;/li&gt;
 * &lt;br&gt;&lt;br&gt;You can use the  macros @href SUCCEEDED and @href FAILED or test directly
 * the value to have more details. Refer to the method documentation to know about its 
 * possible HRESULT values.
 * &lt;pre&gt;
 *  IMyInterface * pIMyInterface = NULL ;
 *  HRESULT rc = pIMyOtherInterface-&gt;QueryInterface(IID_IMyInterface,(void**) &amp;pIMyInterface);
 *  if ( SUCCEEDED(rc) )
 *  {
 *      // rc = S_OK
 *      rc = pIMyInterface-&gt;Method();
 *      
 *      // Test with SUCCEEDED macro
 *
 *      if ( SUCCEEDED(rc) )
 *      {
 *         // In this case, rc is &lt;b&gt;S_OK&lt;/b&gt; or &lt;b&gt;S_FALSE&lt;/b&gt;   
 *         // You can directly test the rc value  
 *         if ( S_FALSE == rc )
 *         {
 *                ...
 *         }else
 *         {
 *                ....
 *         }
 *      }
 *
 *      // Test with FAILED macro
 *
 *      if ( FAILED(rc) )
 *      {
 *         // In this case, rc is &lt;b&gt;E_xxxxx&lt;/b&gt; 
 *         // You can directly test the rc value, 
 *         if ( E_FAIL == rc )
 *         {
 *               ....
 *         }
 *         ....
 *      }
 *  }
 * &lt;/pre&gt; 
 * &lt;/ol&gt;
 * The possible values are:
 * @param S_OK
 * Method succeeded. In some contexts, it means additionally that the function returns
 * a boolean true.
 * @param S_FALSE
 * Method succeeded. In some contexts, it means additionally that the function returns
 * a boolean false.
 * @param E_FAIL
 * Unspecified failure.
 * @param E_NOINTERFACE
 * Component does not support the requested interface.
 * @param E_UNEXPECTED
 * For an unexpected failure.
 * @param E_NOTIMPL 
 * Method is not implemented.
 * @param E_OUTOFMEMORY
 * Required memory can not be allocated.
 */

/**
 * The structure to accommodate a Globally Unique Identifier.
 */
typedef struct  _GUID
{
   DWORD Data1;
   WORD Data2;
   WORD Data3;
   BYTE Data4[8];
} GUID;
/**
 * Interface Globally Unique Identifier.
 */
typedef GUID IID;
/**
 * Class Globally Unique Identifier.
 */
typedef GUID CLSID;
/**
 * A type for struct to be Microsoft(R) compatible.
 */
#define interface struct
/**
 * Reference to IID.
*/
#define REFIID const IID &amp;
/**
 * Microsoft(R)-specific extension to the compiler. Set to NULL for UNIX.
 */
#define __stdcall


/**
 * GUID of the class IUnknown
 */
extern const IID IID_IUnknown;

/**
 * Base interface for all CAA interfaces.
 * &lt;b&gt;Role&lt;/b&gt;: All CAA interfaces derive from &lt;tt&gt;IUnknown&lt;/tt&gt; which replaces for UNIX the
 * native Microsoft(R) &lt;tt&gt;IUnknown&lt;/tt&gt; interface.
 * This interface supplies the three basic methods @href #QueryInterface, @href #AddRef and
 * @href #Release to be COM (Microsoft(R) Component Object Model) compliant.
 */
interface IUnknown
{
/**
 *
 * Returns a pointer to a given interface.
 * @param iIID
 *   The interface identifier for which a pointer is requested.
 * @param oPPV
 *   The address where the returned pointer to the interface is located.
 * @return
 *   &lt;dl&gt;
 *   &lt;dt&gt;&lt;tt&gt;S_OK&lt;/tt&gt;          &lt;dd&gt;If the query succeeds
 *   &lt;dt&gt;&lt;tt&gt;E_NOINTERFACE&lt;/tt&gt; &lt;dd&gt;If the interface does not exist
 *   &lt;dt&gt;Other                  &lt;dd&gt;If the query fails for any other reason.
 *   &lt;/dl&gt;
 */
   virtual HRESULT __stdcall QueryInterface(const IID &amp;iIID, void **oPPV) = 0;
/**
 * Increments the reference count for the given interface.
 * @return The reference count value.
 * &lt;br&gt;This information is meant to be used for diagnostic/testing purposes only, because, in certain situations, the value may be unstable.
 */
   virtual ULONG __stdcall AddRef() = 0;
/**
 * Decrements the reference count for the given interface.
 * @return The reference count value.
 * &lt;br&gt;This information is meant to be used for diagnostic/testing purposes only, because, in certain situations, the value may be unstable.
 */
   virtual ULONG __stdcall Release() = 0;
};

#else // _WINDOWS_SOURCE

#pragma once

#if defined(_MFC_VER) &amp;&amp; _MFC_VER&gt;=0x0800

#pragma warning(push)
#pragma warning(disable:4530) 
#include &lt;objbase.h&gt;
#pragma warning(pop)

#else

#include &lt;objbase.h&gt;

#endif

#include &quot;CATSysErrorDef.h&quot;
#include &quot;CATSysDataType.h&quot;

#endif // _WINDOWS_SOURCE

#endif // IUnknown_H
</div>
    
    <div class="navigation">
        <div><a href="ITypeLib.html">‚Üê ‰∏ä‰∏ÄÈ°µ: ITypeLib.h</a></div>
        <div><a href="IdlDesc.html">‰∏ã‰∏ÄÈ°µ: IdlDesc.h ‚Üí</a></div>
    </div>
</body>
</html>