<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System/PublicInterfaces/CATICommunicator.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>System/PublicInterfaces/CATICommunicator.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATICommMsg.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATICommMsg.h</a></div>
        <div><a href="CATICommunicatorLoop.html">‰∏ã‰∏ÄÈ°µ: CATICommunicatorLoop.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">#ifndef CATICommunicator_H
#define CATICommunicator_H
#include &quot;CATICommMsg.h&quot;

// COPYRIGHT DASSAULT SYSTEMES 2000

/**
 * @CAA2Level L1
 * @CAA2Usage U3
 */

class CATIMessageReceiver ;

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATSysCommunication IID IID_CATICommunicator;
#else
extern &quot;C&quot; const IID IID_CATICommunicator;
#endif

/**
 * Interface to represent the logical connexion to the backbone bus.
 * &lt;b&gt;Role&lt;/b&gt;: This interface provides all the main services to exchange
 * messages with the  backbone bus:
 * &lt;ul&gt;
 *  &lt;li&gt; Gets a connexion to the bus &lt;/li&gt;
 *  &lt;li&gt; Declares itself on the bus &lt;/li&gt;
 *  &lt;li&gt; Sends a message on the bus &lt;/li&gt;
 *  &lt;li&gt; Receives a message from other applications connected to the bus (via the bus)&lt;/li&gt;
 *  &lt;li&gt; Declares the messages the process may handle &lt;/li&gt;
 *  &lt;li&gt; Associates handlers to these messages &lt;/li&gt;
 *  &lt;li&gt; Removes these handlers  &lt;/li&gt;
 *  &lt;li&gt; Disconnects from the bus &lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;br&gt;
 * &lt;b&gt;Example of code&lt;/b&gt;:
 * &lt;ul&gt;
 * &lt;li&gt; Get a connexion to the backbone bus with the @href CATGetBackboneConnection global method &lt;/li&gt;
 * &lt;li&gt; Declare to be a backbone application with the @href #Declare method&lt;/li&gt;
 * &lt;br&gt;
 * To receive message an application should:
 * &lt;ul&gt;
 * &lt;li&gt; Declare to be interested in receiving messages thanks the 
 *      @href #DeclareEventManaged method &lt;/li&gt;
 * &lt;li&gt; Declare an handler for message class it want to receive thanks 
 *       to the  @href #AssociateHandler &lt;/li&gt; method
 * &lt;/ul&gt;
 * &lt;br&gt;
 * To send message an application should:
 * &lt;ul&gt;
 * &lt;li&gt; used the @href #SendRequest method &lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;li&gt; Disconnect to the backbone bus thanks the @href #Disconnect method &lt;/li&gt;
 * &lt;/ul&gt;
 * &lt;br&gt; 
 *   @see CATIStreamMsg, CATIBBStreamer, CATICommMsg, CATIMessageReceiver, CATBBMessage, CATICommunicatorLoop
 */
class ExportedByCATSysCommunication CATICommunicator : public IUnknown
{
  CATDeclareInterface;
  public:
  

/** 
 * Declares an application as a backbone application.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: This service should be called only once for a given application during
 * a connexion.
 * @param iAppClass
 *   The identificator under which the application is known on 
 *   the backbone bus.
 * @param iAppType
 *   &lt;b&gt;Legal Values&lt;/b&gt;:&lt;tt&gt;CATStandardApp&lt;/tt&gt;
 */
 
  virtual HRESULT Declare( CATApplicationClass iAppClass,
                   CATApplicationType iAppType=CATStandardApp)=0;

/** 
 * Declares a backbone message class the application is interested with to receive.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: Permits an application to declare that it is interested with receiving
 * message of class iMsgClass 
 * @param iMsgClass
 *   iMsgClass is the class name of the message class the application wishes to receive
 */
  virtual HRESULT DeclareEventManaged(CATMessageClass iMsgClass)=0;


/** 
 * Declares an handler for a backbone message class.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: Permits to associate a handler object to any arriving message 
 * of class iMsgClass sent for the iAppClassReceiver application.
 * If a message of class iMsgClass incomes to the application iAppClassReceiver,
 * iReceiver will be called  on the @href CATIMessageReceiver#HandleMessage method 
 * to process the message.
 * &lt;br&gt;
 * @param iAppClassReceiver
 *   The  identificator under which the receiver application is known on 
 *   the backbone bus.
 * @param iMsgClass
 *   The message class of the future incoming messages to which we want to 
 *   associate a handler
 * @param iReceiver
 *   This object will be called in the future when a message of type 
 *   iMsgClass sent to the application iAppClassReceiver will arrive on the receiver application
 *
 */
  virtual HRESULT AssociateHandler(CATApplicationClass iAppClassReceiver,
                           CATMessageClass iMsgClass,
                           CATIMessageReceiver *iReceiver)=0;


/** 
 * Removes a backbone message handler.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: This method permits to remove the handler iReceiver of the message
 * identified by its target application iAppClass and its class iMsgClass.
 * &lt;br&gt; This method cancels  effects of the corresponding @href #AssociateHandler method.
 * &lt;br&gt;
 * @param iAppClass
 *   The identificator under which the application is known on the backbone bus
 * @param iMsgClass
 *   The message class to which iReceiver is associated
 * @param iReceiver
 *   The object which handles the message 
 *
 */

  virtual HRESULT RemoveHandler(CATApplicationClass iAppClass,
                           CATMessageClass iMsgClass,
                           CATIMessageReceiver *iReceiver)=0;


/** 
 * @nodoc
 * Removes a backbone message handler.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: This method permits to remove all the associations
 * created with @href #AssociateHandler and where the handler object is identified
 * by iReceiver.
 * &lt;br&gt;
 * @param iReceiver
 *   The object which handles the message 
 *
 */
  virtual HRESULT RemoveHandler(CATIMessageReceiver *iReceiver)=0;

/** 
 * Emits a backbone message on the backbone bus.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: This method permits to send messages to other backbone 
 * applications via the backbone bus.
 * @param iAppClass
 *   Target application of the message
 * @param iMsg
 *   Backbone message to emit
 *
 */
  virtual HRESULT SendRequest( CATApplicationClass iAppClass,
                       CATICommMsg *iMsg)=0;

/** 
 * Permits to wait for the answer of a synchronous backbone message.
 * 
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: This method permits to wait for the answer of a given  
 *  backbone message.
 * We advise user to avoid as much as possible synchronous messages and the use
 * of GetRequestAnswer.  
 * &lt;br&gt;Using  synchronous messages and waiting to the answers has the following 
 * disadvantages :
 * &lt;br&gt; - costs more resources
 * &lt;br&gt; - may generate interblocking conditions ( two applications waiting for each other)
 * &lt;p&gt;
 * @param iMsg
 *   synchronous backbone request needing a immediate answer
 * @param oAnswer
 *   Answer to the iMsg request 
 *
 */

  virtual HRESULT GetRequestAnswer( CATICommMsg *iMsg, CATICommMsg **oAnswer, int timeout=-1)=0;


/** 
 * Logical disconnection from the backbone bus.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: This method permits the disconnection from the bus. It&#x27;s the end of 
 * the connexion done by the @href CATGetBackboneConnection  global method.
 */
  virtual HRESULT Disconnect()=0;


/** 
 * Gets the last error.
 * &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: This method permits to get the last error.
 * @param oLastError
 * &lt;b&gt;Legal Values&lt;/b&gt;:
 *  &lt;ul&gt;
 *    &lt;li&gt;CATBBErr_PortNotFound  : Unable to contact given port&lt;/li&gt;
 *    &lt;li&gt;CATBBErr_UnableToGetPort  : Unable to declare on given port&lt;/li&gt;
 *    &lt;li&gt;CATBBErr_AnswerPortAcceptFailed  : failed because invalid answer port&lt;/li&gt;
 *    &lt;li&gt;CATBBErr_ErrorWaitingForPort  : error during WaitForPort operation&lt;/li&gt;
 *    &lt;li&gt;CATBBErr_InitSendSocketInvalid  : Try to send a message on a close or invalid socket
 *                                          during the declaration phase,
 *                                          contact to bus probably lost &lt;/li&gt;
 *    &lt;li&gt;CATBBErr_SendSocketInvalid  : Try to send a message on a close or invalid socket,
 *                                      contact to bus probably lost&lt;/li&gt;
 *    &lt;li&gt;CATBBErr_RcvSocketInvalid  : Try to receive a message from a close or invalid socket,
 *                                     contact to bus probably lost&lt;/li&gt;
 *    &lt;li&gt;CATBBErr_MessageClassNotFound  : message class not found&lt;/li&gt;
 *    &lt;li&gt;CATBBErr_DataStreamingFailure  : error during stream operation&lt;/li&gt;
 *    &lt;li&gt;CATBBErr_DataUntreamingFailure  : error during unstream operation&lt;/li&gt;
 *    &lt;li&gt;CATBBErr_MustImplementCATIStreamMsg  : message object doesn&#x27;t implements CATIStreamMsg&lt;/li&gt;
 *    &lt;li&gt;CATBBErr_MustNeedAnAnswer  : message object doesn&#x27;t need answers&lt;/li&gt;
 *    &lt;li&gt;CATBBErr_UnableToInstanciateMsg  : unable to instanciate message object&lt;/li&gt;
 *    &lt;li&gt;CATBBErr_ReentranceConditionFound  : &lt;/li&gt;
 *    &lt;li&gt;CATBBErr_TimeoutOccurred  : &lt;/li&gt;
 *    &lt;li&gt;CATBBErr_TargetApplicationNotPresent  : &lt;/li&gt;
 *  &lt;/ul&gt;
 *   
 */
  virtual HRESULT GetLastErrorId( int *oLastError)=0;

  
};

/**
 * @nodoc
 */
ExportedByCATSysCommunication CATBusDescriptor GetBusDescriptor( const char *iKey=NULL,const char *iHost=NULL);


/**
 * @nodoc
 * Declare the handler class for CATICommunicator :  CATICommunicator_var
 */
CATDeclareHandler (CATICommunicator,CATBaseUnknown);


#include &quot;CATGetBackboneConnection.h&quot;
#endif
</div>
    
    <div class="navigation">
        <div><a href="CATICommMsg.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATICommMsg.h</a></div>
        <div><a href="CATICommunicatorLoop.html">‰∏ã‰∏ÄÈ°µ: CATICommunicatorLoop.h ‚Üí</a></div>
    </div>
</body>
</html>