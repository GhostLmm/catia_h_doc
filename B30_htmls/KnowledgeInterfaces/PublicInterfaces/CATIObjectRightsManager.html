<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KnowledgeInterfaces/PublicInterfaces/CATIObjectRightsManager.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>KnowledgeInterfaces/PublicInterfaces/CATIObjectRightsManager.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATIList.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIList.h</a></div>
        <div><a href="CATIOptConstraint.html">‰∏ã‰∏ÄÈ°µ: CATIOptConstraint.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">#ifndef CATIObjectRightsManager_H
#define CATIObjectRightsManager_H
// COPYRIGHT Dassault Systemes 2003

/** 
 * @CAA2Level L1
 * @CAA2Usage U3
 */

// module declaration
#include &quot;KnowledgeItfCPP.h&quot;

// classes used  
#include &quot;CATListOfCATUnicodeString.h&quot;
#include &quot;CATUnicodeString.h&quot;

// inherited from
#include &quot;CATBaseUnknown.h&quot;

// OLE iid
#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByKnowledgeItfCPP IID IID_CATIObjectRightsManager;
#else
extern &quot;C&quot; const IID IID_CATIObjectRightsManager ;
#endif

/**
* Type defining the rights on a feature.
* @param CATRightTypeNoRight
*	There is no right on the feature
* @param CATRightTypeNoRight
*   The feature can&#x27;t be edited
* @param CATRightTypeBrowse
*	The feature can&#x27;t be browsed
* @param CATRightTypeRun
*	The feature can&#x27;t be run
* @param CATRightKweDelete
*	The feature can&#x27;t be deleted
*/
typedef unsigned long CATKweRight;

//------------------------------------------------------------------

/**   
 * Interface dedicated to feature protection management.
 * &lt;b&gt;Role&lt;/b&gt;: manages informations to protect in edition, browse or execution or deletion a feature.
 *              It has several types of protection :
 *                            Frozen (the protection could never be changed),
 *                            CAA (CAA applicative protection),
 *                            Setting (setting protection),
 *              The protection can also be protected by a key (like a password it needs to change the protection)
 *              The feature can be protected in exectution depending on a license.
 */

class ExportedByKnowledgeItfCPP CATIObjectRightsManager: public CATBaseUnknown
{
  CATDeclareInterface;

#define       CATRightTypeNoRight       (1 &lt;&lt; 0)
#define  	  CATRightTypeEdit          (1 &lt;&lt; 1)
#define  	  CATRightTypeBrowse        (1 &lt;&lt; 2)
#define  	  CATRightTypeRun           (1 &lt;&lt; 3)
#define  	  CATRightKweDelete         (1 &lt;&lt; 4)

  /**
  * Type defining the protection of the rights of a feature.
  * @param NoType
  *		There is no protection
  * @param Frozen
  *		The rights can&#x27;t be changed
  * @param Setting
  *		The rights can be modified through settings
  * @param CAA
  *		The rights can be modified through CAA APIs
  */
  enum CATProtectionType{
	  NoType = 0,
	  Frozen=1,
	  Setting=2,
	  CAA=3
  };
  

  public:

    /**
	* Tests if the object is editable.
	* @param oResult 
	* 0 if the object is not editable, 1 else
	* @param oExplain
	* If oExplain is not NULL when calling method, it contains the reason why the object is not editable.
	* @return
	* E_FAIL if the method fails, S_OK else
	*/
	virtual HRESULT IsEditable(int&amp; oResult, CATUnicodeString *oExplain = NULL) const = 0;
	
	/**
	* Tests if the object is browsable.
	* @param oResult 
	* 0 if the object is not browsable, 1 else
	* @param oExplain
	* If oExplain is not NULL when calling method, it contains the reason why the object is not browsable.
	* @return
	* E_FAIL if the method fails, S_OK else
	*/
	virtual HRESULT IsBrowsable(int&amp; oResult, CATUnicodeString *oExplain = NULL) const = 0;
	
	/**
	* Tests if the object is runnable.
	* @param oResult 
	* 0 if the object is not runnable, 1 else
	* @param oExplain
	* If oExplain is not NULL when calling method, it contains the reason why the object is not runnable.
	* @return
	* E_FAIL if the method fails, S_OK else
	*/
	virtual HRESULT IsRunnable(int&amp; oResult, CATUnicodeString *oExplain = NULL) const = 0;


	/**
	* Set the protection level to the current object.
	* @param iRight 
	* the protection rights are either :
	                         CATRightTypeEdit, CATRightTypeBrowse, CATRightTypeRun or CATRightTypeNoRight 
	*                        or CATRightKweDelete.
	* example : CATRightTypeBrowse | CATRightKweDelete
	* @param iProtectionType 
	* the protection types are either :
	                        NoType, 
	                        Frozen means that the right will never be modified,
	*	                    Setting means that the right come from a setting,
	*						CAA means that the right is defined by a CAA Application.
	* @param iKey 
	*	a key to allow to change the right
	* @return
	* E_FAIL if the method fails, S_OK else
	*/
	virtual HRESULT SetRight(const CATKweRight &amp;iRight, const CATProtectionType &amp;iProtectionType = Frozen, const CATUnicodeString &amp;iKey = &quot;&quot;) = 0;

	/**
	* Get the protection rights of the current object.
	* @param oRight 
	* The protection rights are either: 
	             CATRightTypeNoRight (no right)
				 CATRightTypeEdit (the object is not editable)
				 CATRightTypeBrowse (the object is not browsable)
				 CATRightTypeRun (the object is not runnable)
				 CATRightKweDelete (the object is not deletable)
	* @return
	* E_FAIL if the method fails, S_OK else
	*/
	virtual HRESULT GetRight(CATKweRight &amp;oRight) const = 0;

	/**
	* Get the protection type to the current object.
	* @param oProtectionType 
	* the protection type : NoType,Frozen,Setting or CAA
	* @return
	* E_FAIL if the method fails, S_OK else
	*/
	virtual HRESULT GetProtectionType(CATProtectionType&amp; oProtectionType) const = 0;

	/**
	* Allow the object to be runnable only with the defined list of licenses.
	* @param iListLicense 
	* the list of necessary licenses
	* @return
	* E_FAIL if the method fails, S_OK else
	*/
	virtual HRESULT SetLicense(const CATListOfCATUnicodeString&amp; iListLicense) = 0;

	/**
	* Test if the object is runnable depending on licenses.
	* @param oResult 
	* 0 if the object is not licensed, 1 else. 
	* @return
	* E_FAIL if the method fails, S_OK else
	*/
	virtual HRESULT IsLicensed(int &amp; oResult) const = 0;

  // No constructors or destructors on this pure virtual base class
  // --------------------------------------------------------------
};

//------------------------------------------------------------------
CATDeclareHandler(CATIObjectRightsManager, CATBaseUnknown);

#endif
</div>
    
    <div class="navigation">
        <div><a href="CATIList.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIList.h</a></div>
        <div><a href="CATIOptConstraint.html">‰∏ã‰∏ÄÈ°µ: CATIOptConstraint.h ‚Üí</a></div>
    </div>
</body>
</html>