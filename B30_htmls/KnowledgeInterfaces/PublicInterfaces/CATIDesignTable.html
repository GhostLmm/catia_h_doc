<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KnowledgeInterfaces/PublicInterfaces/CATIDesignTable.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>KnowledgeInterfaces/PublicInterfaces/CATIDesignTable.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATIDelegateInstanciation.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIDelegateInstanciation.h</a></div>
        <div><a href="CATIDynamicAttributes.html">‰∏ã‰∏ÄÈ°µ: CATIDynamicAttributes.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">#ifndef CATIDesignTable_H
#define CATIDesignTable_H

// COPYRIGHT DASSAULT SYSTEMES  1999

/** 
 * @CAA2Level L1
 * @CAA2Usage U3 
 */

#include &quot;KnowledgeItf.h&quot;

#include &quot;CATICkeRelationForwards.h&quot;

#include &quot;CATICkeParm.h&quot;

class CATIParmPublisher_var;

#ifndef LOCAL_DEFINITION_FOR_IID
extern IID ExportedByKnowledgeItf IID_CATIDesignTable;
#else
extern &quot;C&quot; const IID IID_CATIDesignTable;
#endif

/**   
 * Interface dedicated to design table management.
 * &lt;b&gt;Role&lt;/b&gt;: It allows to drive parameters of CATIA Model with values taken from an Excel sheet or from a tabulated text file&lt;br&gt;
 * A design table is a relation, thus it also implements CATICkeRelation.&lt;br&gt;
  * The principle of use of this interface is the foolowing:&lt;br&gt;
 * &lt;ol&gt;
 * Creation of a sheet (&lt;pre&gt;factory-&gt;CreateSheet()&lt;/pre&gt;)
 * Creation of a design table (&lt;pre&gt;factory-&gt;CreateDesignTable()&lt;/pre&gt;)
 * Attachment of the sheet in the design table (&lt;pre&gt;design-&gt;SetSheet(sheet)&lt;/pre&gt;)
 * Creation of associations between columns of the sheet and parameters of the model (&lt;pre&gt;design-&gt;AddAssociation(&quot;column&quot;, parameter)&lt;/pre&gt;)
 * Choice of a row as configuration of the design table (&lt;pre&gt;design-&gt;SetConfigurationRow(n)&lt;/pre&gt;)
 * &lt;/ol&gt;
 *
 * @see CATICkeRelation
*/
class ExportedByKnowledgeItf CATIDesignTable : public CATBaseUnknown
{
	CATDeclareInterface;

public:

    /**
     * Errors produced by Design table.
	 * @param NoError is returned by methods if no error occured.
	 * @param NotAMagnitude is returned by @href #AddAssociation or @href #ManageSheetModifications if given parameter has no magnitude and if the associated column has one in column title.
	 * @param BadCellType is returned by @href #AddAssociation or @href #ManageSheetModifications if the type of one of the cell of the column isn&#x27;t compliant with associated parameter.
	 * @param BadColumnType is returned if the unit extension in column use a unit that doesn&#x27;t exist.
	 * @param BadConfiguration is returned by @href #SetCurrentConfiguration is the given integer in less than 0 and greater than the number of configurations in the sheet.
	 * @param ParseSheetError is returned by @href #ManageSheetModifications when the parse operation of the sheet failed.
	 * @param ParameterAlreadyAssociated is returned by @href #AddAssociation or @href #ManageSheetModifications if the given parameter is already associated.
	 * @param ColumnAlreadyAssociated is returned by @href #AddAssociation or @href #ManageSheetModifications if the given column is already associated.
	 * @param ColumnDoesntExist is returned by @href #AddAssociation or @href #ManageSheetModifications if the given column doesn&#x27;t exist.
	 * @param MiscellaneousError is returned by methods when other errors are encountered.
     */
  	enum DTError 
	{
		NoError,
		ColumnNamesNotUnique,
		BadCellType,
		BadColumnType,
		NotAMagnitude,
		BadConfiguration,
		ParseSheetError,
		ParameterAlreadyAssociated,
		ColumnAlreadyAssociated,
		ColumnDoesntExist,
		MiscellaneousError
	};

	/**
	* Returns the configuration parameter.
	*/
	virtual CATICkeParm_var ConfigurationParameter() = 0;

	/**
	* Modifies the configuration parameter (and by consequence all others) to the value of the row rowNb (rowNb has to be &gt; 1).
	* @return  NoError if the configuration row is valid, otherwise BadConfiguration.
	* @param iRowNb
	* the row choosen as configuration (has to be &gt; 1 and &lt;= to the number of rows in the design table, the column names row excluded)
	*/
	virtual CATIDesignTable::DTError SetCurrentConfiguration(const int iRowNb) = 0;

	/**
	* Returns the configuration row index.
	*/
	virtual int ConfigurationRow() const = 0;

	/**
	* Gets the list of associations between columns of the sheet defining the design table and the parameters driven by those columns. &lt;br&gt;
	* The first string is associated with the first out-parameter, and so on
	* @return the list of associations
	*/
	virtual const CATListOfCATUnicodeString* Associations() const = 0;

	/**
	* Adds an association between the column of name iColumnName and the parameter iParameter.
	* @return CATNoError if the method succeeds. If the method fails, it can return CATColumnAlreadyAssociated if the column is already associated, 
	* CATParameterAlreadyAssociated if the parameter is already associated, CATColumnDoesntExist if the column doesn&#x27;t exist, CATNotAMagnitude if the 
	* parameter isn&#x27;t typed and the column has a unit extension, CATBadCellType if a cell of the sheet doesn&#x27;t fit parameter&#x27;s type and CATBadColumnType 
	* if a cell of the sheet doesn&#x27;t fit parameter&#x27;s type
	* @param iColumnName
	* the name of the column (without the column&#x27;s type if there is one)
	* @param iParameter
	* the parameter to be associated
	*/
	virtual CATIDesignTable::DTError AddAssociation(const CATUnicodeString&amp; iColumnName,
												const CATICkeParm_var &amp;iParameter) = 0;

   /**
	* Removes the association with column iColumnName.
	* @return CATCke::True if the method succeeds, CATCke::False else
	* @param iColumnName
	* The name of the column in the association
	*/
	virtual CATCke::Boolean RemoveAssociation(const CATUnicodeString&amp; iColumnName) = 0;

   /**
	* Returns the associated sheet.
	*/
	virtual const CATICkeSheet_var Sheet() const = 0;

   /**
	* Sets the associated sheet.
	* @param sheet
	* the sheet defining the content of the design table
	*/
	virtual void SetSheet(const CATICkeSheet_var &amp;sheet) = 0;

   /**
	* Returns the list of column names in the sheet.
	*/
	virtual const CATListOfCATUnicodeString* ColumnNames() const = 0;

	/**
	* Gets the index (1-based) of the column associated with the parameter.
	* @return 0 if the column isn&#x27;t associated (or doesn&#x27;t exist)
	* @param iParameter
	* the parameter
	*/
	virtual int ParameterColumn(const CATICkeParm_var &amp;iParameter) = 0;

	/**
	* Gets the parameter associated with the column whose index is columnNb or whose name is iColumnName.
	* @return NULL_var if the column doesn&#x27;t exist or isn&#x27;t associated
	* @param iColumnNb
	* the index of the column. If it is equal to 0, this method uses the second argument
	* @param iColumnName
	* a pointer on the name of the column (can be NULL if columnNb &lt;&gt; 0
	*/
	virtual CATICkeParm_var ColumnParameter(int iColumnNb, CATUnicodeString *iColumnName = NULL ) = 0;
	
	/**
	* Returns a string containing cell string + column unit extension.
	* if the cell string don&#x27;t have an type extension and the column has one
	* @param iRow
	* index of the row of the cell
	* @param iColumn
	* index of the column of the cell
	*/
	virtual CATUnicodeString CellWithColumnType(const int iRow, const int iColumn) const = 0;

	/**
	* Returns a double containing cell value converted in MKS.
	* If cell isn&#x27;t numerical, returns 0
	* @param iRow
	* index of the row of the cell
	* @param iColumn
	* index of the column of the cell
	*/
	virtual double CellAsDouble(const int iRow, const int iColumn) const = 0;

	/**
    * Indicates if the column is numerical or not.&lt;br&gt;
    * @return a boolean saying if the column is numerical or not.
    * (numerical means that all rows except the first one contains numerical
	* values optionnaly with unit extension)
	* @param iColumn
	* the index of the column
	*/
	virtual CATCke::Boolean IsANumericalColumn(const int iColumn) const = 0;

	/**
	* Called when a subscriber receives modification notification.
	* from the sheet imbed in the design table.
	* It parses the new sheet, updates column names, update associations
	* @return CATParseSheetError if the sheet could&#x27;nt be parsed, CATColumnNamesNotUnique if two or more columns have the same name, CATNoError else
	* @param iNnteractively
	* informs if the caller wants messages and questions, or default operations
	*/
	virtual CATIDesignTable::DTError ManageSheetModifications(const CATCke::Boolean iInteractively = 0) = 0;

	/**
	* Looks for the most adapted type for the column.
	* @return StringType if no other type is found.&lt;br&gt;
	* Returns NULL_var if argument column isn&#x27;t good
	* @param iColumn
	* the column whose type is to search
	*/
	virtual CATICkeType_var ColumnSupposedType(const int iColumn) = 0;

	/**
	* Checks that no relations are in conflict with the design table (this mean, no relations valuate the parameters associated to the design table).
	* @return False if the design table has to be not activated
	* @param iWithMessage
	* This boolean says if the method has to send a question about removing association or deactivating conflicting relations to screen, or to take default actions (not to activate the design table)
	*/
	virtual CATCke::Boolean ManageRelationsConflicts(const CATCke::Boolean iWithMessage) = 0;

	/**
	* Adds a new row in the sheet with current values of associated parameters.
	* ##### Since V5R14 ##### 
	* If the file contains at least one empty row between two not empty rows,
	* the behavior of this method is the same for Excel and Text files :
	* =&gt; the new row containing the current parameters values replaces the first
	*    empty row found from the beginning of the file.
	* RQ : before R14, for text files, the new row was appended at the end of the file.
	*      The empty rows were never filed by this way, so that the new row was not
	*      visible in Design Table dialog.
	* ######################
	* @param withUpdate
	* if == 0, don&#x27;t call the sheet update (that reads the file) -&gt; for optimization purpose
	* @return CATCke::True if the method succeeds, CATCke::False else
	*/
	virtual CATCke::Boolean AddRowWithParmValues(const int withUpdate = 1) = 0;

	/**
	* Checks that the design table doesn&#x27;t generate cycles.
	* @return CATCke::True if the activation of the design table doesn&#x27;t generate cycles,
	* CATCke::False else
	* @param iWithMessage
	* Set this parameter to True if you want a message saying there is a cycle
	*/
	virtual CATCke::Boolean ManageCycles(const CATCke::Boolean iWithMessage) const = 0;

	/**
	* Tries to associate automatically parameters and columns of same name.
	* @param iRoot
	* the root from which the naming has to begin
	* @param iFeature
	* if not NULL, the feature where parameters are searched. 
	* @param iParameters
	* if first argument is NULL, use this list of parameters to
	* look for potential associations
	* @return the number of associations created
	*/
	virtual int AutomaticAssociations(const CATIParmPublisher_var &amp;iRoot, const CATIParmPublisher_var &amp;iFeature, const CATLISTV(CATBaseUnknown_var) *iParameters) = 0;

	/**
	* Activates the callback reacting to the source file modification. When this callback is raised.
	* the design table is synchronized. If source data is copied into model, the synchronization
	* is optionnal
	* @param iMode
	* 0 : Message and update if the design table data isn&#x27;t embedded, Question and eventually update
	* if the design table data is embedded&lt;p&gt;
	* 1 : Update
	* 2 : No update
	*/
	virtual void ActivateSheetUpdateMessage(int iMode = 0) = 0;

	/**
	* Deactivates the callback reacting to the source file modification.
	*/
	virtual void DeactivateSheetUpdateMessage() = 0;


	/**
	* Allows to retrieve the configurations that are not valid according to design table filter.
	* &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: returns the list of invalid configurations according to design table filter
	* @param iForceUpdate
	* says if this list has to be updated (if value is not 0) or not. 0 is advised.
	* @return
	* the list of invalid configurations. This list is index 1-based : the first configuration has index 1. 
	*/
	virtual const CATListOfInt * GetInvalidConfigurations(const int iForceUpdate = 0) = 0;

	/**
	* This method allows to retrieve the expression that filters design table configurations.
	* &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: returns the design table configurations filter
	* @return
	* the relation used to filter the available configurations.&lt;br&gt;
	* It is a &quot;check&quot; involving associated parameters. For a given configuration, 
	* if its result is False, the configuration is invalid.
	*/
	virtual CATICkeRelationExp_var GetConfigurationsFilter() = 0;

	/**
	* This method allows to specify the expression that allows to filter design table configurations.
	* This filter has to be a KnowledgeAdvisor check. If check result is False for a given configuration, the configuration is not valid.
	* &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: Allows the caller to set the configurations filter
	* @param
	* the relation that will be used to filter the available configurations.&lt;br&gt;
	* It has to be a &quot;check&quot; involving associated parameters. For a given configuration, 
	* if its result is False, the configuration is invalid.
	*/
	virtual void SetConfigurationsFilter(const CATICkeRelationExp_var &amp;filter) = 0;


	/**
	* This methods checks if the parameter is seen as read only (cell not empty, or containing ranges or default value)
	* for the current configuration.
	*/
	virtual int IsParamReadOnly(const CATICkeParm_var &amp;parm) = 0;

};
CATDeclareHandler(CATIDesignTable,CATBaseUnknown);

#endif
</div>
    
    <div class="navigation">
        <div><a href="CATIDelegateInstanciation.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIDelegateInstanciation.h</a></div>
        <div><a href="CATIDynamicAttributes.html">‰∏ã‰∏ÄÈ°µ: CATIDynamicAttributes.h ‚Üí</a></div>
    </div>
</body>
</html>