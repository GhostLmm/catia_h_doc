<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CATPDMBase/PublicInterfaces/CATPDMInteropServices.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>CATPDMBase/PublicInterfaces/CATPDMInteropServices.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATPDMCSServices.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATPDMCSServices.h</a></div>
        <div><a href="CATPDMPVRServices.html">‰∏ã‰∏ÄÈ°µ: CATPDMPVRServices.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">// COPYRIGHT Dassault Systemes 2005
//===================================================================
//
// CATPDMInteropServices.h
//
//===================================================================
//
// Usage notes:
//   Services use for :
//              -  Save of part in EnoviaV5
//              -  Open a part from EnoviaV5 only with V_ID, or also with V_version .
//              -  Transfer ownership of a part to a given user.
//              -  Promote a part to its final state.
//              -  Save a catalog and associated documents in ENOVIAV5
//              -  Open a catalog from EnoviaV5
//              -  Send to file from vault to file directory
//              -  Get a document with his V_ID and V_Version
//              
//===================================================================
//
//  Feb 2005  Creation: Code generated by NKF
//===================================================================


/**
  * @CAA2Level L1
  * @CAA2Usage U1
  */

#ifndef CATPDMInteropServices_h
#define CATPDMInteropServices_h

#include &quot;CATVariant.h&quot;
#include &quot;CATListOfCATUnicodeString.h&quot;

// BZQ-2006.04.20 - To speed up compilation 
//#include &quot;CATUnicodeString.h&quot;
class CATUnicodeString;

class CATDocument;
class CATIAProduct;

#include &quot;ExportedByCATPDMBaseEnoviaV5CAA.h&quot;


//#include &quot;CATListOfCATIPLMIdentificator.h&quot;
//#include &quot;CATIPLMIdentificator.h&quot;
#include &quot;CATIPDMPersistency.h&quot;
class CATIPLMIdentificator_var;
class CATLISTV(CATIPLMIdentificator_var);
class CATLISTP(CATDocument);

/**
* Saves a part document and its associated reference document in ENOVIA V5 database.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method enables save a part document and its associated reference document
* in the ENOVIA V5 database with document kept in vault.
* &lt;br&gt;
*  The save will map the attribute on the reference. The save transaction is automatically commited 
* if no error occurs. Otherwise a complete rollback is performed.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPDMBaseEnoviaV5CAA&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param ipDocument
*    Document in session 
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: Part document is successfully saved in database&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. Possible reasons of error are: &lt;/li&gt;
*      &lt;ul&gt;
*       &lt;li&gt;Invalid argument&lt;/li&gt; 
*       &lt;li&gt;Input document is not a CATPart&lt;/li&gt;
*       &lt;li&gt;CATPart document is pointing to other document of type CATProduct&lt;/li&gt;
*       &lt;li&gt;Connection to ENOVIA V5 database doesn&#x27;t exist&lt;/li&gt;
*     &lt;/ul&gt;
*  &lt;/ul&gt;
*/ 
ExportedByCATPDMBaseEnoviaV5CAA  HRESULT SavePartAndDocument(CATDocument * ipDocument);

/**
* Loads a part document from ENOVIA V5 database.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method loads a part document and its associated reference 
* CATPart or CATProduct document from the ENOVIA V5 database in the session.
* It performs the attribute mapping on the reference. This method returns a pointer on the document loaded 
* in session and a pointer on the reference of the part aggregated on document.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPDMBaseEnoviaV5CAA&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iV_ID
*    V_ID attribute value of the part master
* @param opPart
*    pointer to the reference of the loaded part
* @param opDocument
*    pointer to the Document loaded in session 
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: Part document and its is associated reference successfully loaded&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. Possible reasons of error are: &lt;/li&gt;
*      &lt;ul&gt;
*       &lt;li&gt;Invalid argument&lt;/li&gt; 
*       &lt;li&gt;No part document found for &lt;tt&gt;iV_ID&lt;/tt&gt; &lt;/li&gt;
*       &lt;li&gt;Document to load is not a CATPart or CATProduct&lt;/li&gt;
*       &lt;li&gt;Connection to ENOVIA V5 database doesn&#x27;t exist&lt;/li&gt;
*     &lt;/ul&gt;
*  &lt;/ul&gt;
*/
ExportedByCATPDMBaseEnoviaV5CAA  HRESULT OpenPartAndDocumentFromV_ID(const CATUnicodeString &amp; iV_ID,
                                                                 CATIAProduct *&amp; opPart, 
                                                                 CATDocument *&amp; opDocument);




/**
* Loads a given version of a part document from ENOVIA V5 database.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method loads a given version of a part document and its associated reference 
* CATPart or CATProduct document from the ENOVIA V5 database in the session.
* It performs the attribute mapping on the reference. This method returns a pointer on the document loaded 
* in session and a pointer on the reference of the part aggregated on document.
*
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPDMBaseEnoviaV5CAA&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iV_ID
*    V_ID attribute value of the document master
* @param iV_version
*    V_version attribute value of the document revision 
* @param opPart
*    pointer to the part reference of the loaded document
* @param opDocument
*    pointer to the Document loaded in session 
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: Document revision and its associated part reference successfully loaded&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. Possible reasons of error are: &lt;/li&gt;
*      &lt;ul&gt;
*       &lt;li&gt;Invalid argument&lt;/li&gt; 
*       &lt;li&gt;No document revision found with iV_ID and iV_version input arguments&lt;/li&gt;
*       &lt;li&gt;Document to load is not a CATPart or CATProduct&lt;/li&gt;
*       &lt;li&gt;Connection to ENOVIA V5 database doesn&#x27;t exist&lt;/li&gt;
*     &lt;/ul&gt;
*  &lt;/ul&gt;
*/
ExportedByCATPDMBaseEnoviaV5CAA  HRESULT OpenPartAndDocumentFrom_V_ID_And_V_version( const CATUnicodeString &amp; iV_ID,
                                                                                     const CATUnicodeString &amp; iV_version,
                                                                                     CATIAProduct *&amp; opPart, 
                                                                                     CATDocument *&amp; opDocument);

/**
* Enable the execution of command on ENOVIA V5 server.
*
*&lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method enables customized code written in CATIA to exercise customized 
* code written in the ENOVIA V5 server.
*&lt;p&gt; 
*&lt;br&gt;Interop infrastructure does the marshalling of input and output arguments between the 2 process.
*&lt;br&gt;Interop does the adequate RPC call in ENOVIA by instanciating the requested late type and
*  calling it on ENOVIUERunInteropServerCode::RunServerCode.
*
*&lt;p&gt;
* @param iCmdName
*&lt;p&gt; 
*  Three pre-defined commands are available:
*  &lt;ul&gt; 
*   &lt;li&gt;&lt;b&gt;&quot;EnovTransferToOwner&quot;&lt;/b&gt;: allows transfer ownership of a part to a given user.
*    &lt;br&gt;
*                The &lt;tt&gt;iInput&lt;/tt&gt; argument must be a CATVariant containing a CATSafeArray with:
*                 &lt;ul&gt;
*                    &lt;li&gt;the part number value of the part.
*                    &lt;li&gt;the value of user that we want to transfer ownership of part.
*                    &lt;li&gt;the value of V_Organisation attribute for the new owner.
*                    &lt;li&gt;the value of V_Role attribute  for the new owner.
*                    &lt;li&gt;the value of V_Project attribute for the new owner.
*                 &lt;/ul&gt;
*                In fact if we change the owner of a given part we need update the role, 
*               the organisation and the project value for the new owner of part.
*   &lt;/li&gt;               
*&lt;p&gt;
*
*   &lt;li&gt;&lt;b&gt;&quot;EnovPromoteToFinalState&quot;&lt;/b&gt;: allows the promote of a given part.
*       &lt;br&gt;The &lt;tt&gt;iInput&lt;/tt&gt; argument must contain the part number of the part to promote to final state.
*           The change will be committed only if the action succeeds.
*   &lt;/li&gt;
*&lt;p&gt;
*   &lt;li&gt;&lt;b&gt;&quot;EnovPartAttribute&quot;&lt;/b&gt;: allows valuate the attributes on a created part.
*       &lt;br&gt;The &lt;tt&gt;iInput&lt;/tt&gt; argument must contain the part number of the part whose attribute must be set by ENOVIA server code.
*       &lt;br&gt;The default implementation does nothing on attribute. this is a sample that explains how to modify 
*             ENOVIA attributes.
*   &lt;/li&gt;
*  &lt;/ul&gt;
*&lt;p&gt;
*    &lt;tt&gt;iCmdName&lt;/tt&gt; is the Late type on server side containing the customized code. 
*   We provide for this above late type one default implementation for the last part version in ENOVIA Server.
*&lt;br&gt;
*    The late type &lt;tt&gt;iCmdName&lt;/tt&gt; should implement the interface &lt;b&gt;ENOVIUERunInteropServerCode&lt;/b&gt;.
*&lt;p&gt;  
*    The customization developer is in charge of writting customized code in ENOVIA LCA, 
*    the code in ENOVIA being developped
*    as a late type implementing the interface ENOVIUERunInteropServerCode.  
*&lt;p&gt;
*    User implementing such commands must avoid use services that set values on the server side.
*    Such services may not be compatible with ENOVIA native process.
*&lt;/p&gt;
*
*  @param iInput
*    Input information for &lt;tt&gt;iCmdName&lt;/tt&gt; command.
*&lt;br&gt;It is marshalled to the server and passed in as input to the customized code on server side.
* 
*  @param oOutput 
*    Information returned by customized code on server side.
*&lt;br&gt;It is marashalled back to CATIA and returned to the caller of this method.
*
* @return 
*   &lt;ul&gt;
*     &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: command successfully executed on server&lt;/li&gt; 
*     &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. Possible reasons of error are: 
*       &lt;ul&gt;
*        &lt;li&gt;Invalid argument&lt;/li&gt; 
*        &lt;li&gt;Connection to ENOVIA V5 database doesn&#x27;t exist&lt;/li&gt;
*       &lt;/ul&gt;
*      &lt;/li&gt;
*  &lt;/ul&gt;
*/

ExportedByCATPDMBaseEnoviaV5CAA  HRESULT RunServerCode(const CATUnicodeString &amp; iCmdName, 
                                                   CATVariant &amp;iInput,
                                                   CATVariant &amp;oOutput);


/**
* Saves a catalog document in ENOVIA V5 database.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method enables save a catalog document 
* in the ENOVIA V5 database with document kept in vault.
* &lt;br&gt;
* The save transaction is automatically commited 
* if no error occurs. Otherwise a complete rollback is performed.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPDMBaseEnoviaV5CAA&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param ipDocument
*    Document in session 
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: catalog document is successfully saved in database&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. Possible reasons of error are: &lt;/li&gt;
*       &lt;ul&gt;
*       &lt;li&gt;Invalid argument&lt;/li&gt; 
*       &lt;li&gt;Input document is not a catalog&lt;/li&gt;
*       &lt;li&gt;catalog document is pointing to other document of type CATProduct&lt;/li&gt;
*       &lt;li&gt;Connection to ENOVIA V5 database doesn&#x27;t exist&lt;/li&gt;
*     &lt;/ul&gt;
*  &lt;/ul&gt;
*/ 

ExportedByCATPDMBaseEnoviaV5CAA HRESULT  SaveCatalogDocument(CATDocument *iDoc);



/** 
* Loads a catalog document from ENOVIA V5 database in session.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method loads a catalog document from the ENOVIA V5 database in the session.
* It performs the attribute mapping on the document. This method returns a pointer on the document loaded 
* in session.
*&lt;p&gt;
*&lt;b&gt;Note&lt;/b&gt;: In case multiple versions of the same V_ID value of catalog exist, 
*   the latest available will be returned. The catalog document will not be opened in the catalog editor or 
*   in the catalog browser.
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPDMBaseEnoviaV5CAA&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iVID
*    V_ID attribute value of the document master
*&lt;p&gt;&lt;b&gt;remark DPD&lt;/b&gt;devrait etre un iV_ID pour etre consistent avec la methode OpenPartAndDocumentFromV_ID
*
* @param oDoc
*    pointer to the document loaded in session 
*&lt;p&gt;&lt;b&gt;remark DPD&lt;/b&gt;devrait etre un opDocument pour etre consistent avec la methode OpenPartAndDocumentFromV_ID
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: catalog document is successfully loaded in session&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. Possible reasons of error are: &lt;/li&gt;
*       &lt;ul&gt;
*       &lt;li&gt;Invalid argument&lt;/li&gt; 
*       &lt;li&gt;No catalog found for &lt;tt&gt;iV_ID&lt;/tt&gt; &lt;/li&gt;
*       &lt;li&gt;Document to load is not a catalog&lt;/li&gt;
*       &lt;li&gt;Connection to ENOVIA V5 database doesn&#x27;t exist&lt;/li&gt;
*     &lt;/ul&gt;
*  &lt;/ul&gt;
*/
ExportedByCATPDMBaseEnoviaV5CAA HRESULT  OpenCatalogDocumentFromV_ID(const CATUnicodeString &amp;iVID, CATDocument *&amp; oDoc);


/**
* Loads a given version of a catalog document from ENOVIA V5 database in session.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method loads a given version of a catalog document from the ENOVIA V5 database in the session.
* It performs the attribute mapping on the document. This method returns a pointer on the document loaded 
* in session.
*
*
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPDMBaseEnoviaV5CAA&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iV_ID
*    V_ID attribute value of the document master
* @param iV_version
*    V_version attribute value of the document version 
* @param opDocument
*    pointer to the Document loaded in session 
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: catalog document is successfully loaded&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. Possible reasons of error are: &lt;/li&gt;
*       &lt;ul&gt;
*       &lt;li&gt;Invalid argument&lt;/li&gt; 
*       &lt;li&gt;No catalog found for &lt;tt&gt;iV_ID&lt;/tt&gt; and &lt;tt&gt;iV_version&lt;/tt&gt; &lt;/li&gt;
*       &lt;li&gt;Document to load is not a catalog&lt;/li&gt;
*       &lt;li&gt;Connection to ENOVIA V5 database doesn&#x27;t exist&lt;/li&gt;
*     &lt;/ul&gt;
*  &lt;/ul&gt;
*/
ExportedByCATPDMBaseEnoviaV5CAA HRESULT  OpenCatalogDocumentFromV_ID_AND_V_version( const CATUnicodeString &amp;iV_ID,
                                                                                    const CATUnicodeString &amp;iV_version,
                                                                                    CATDocument *&amp; opDocument);


/**
* Retrieves the document family for a given document revision from ENOVIA V5 database.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method enables retrieve from the ENOVIA V5 database the  document family of a given document revision.
* This family is described by the list of V_ID and V_Revision attribute values of the set of documents linked with this document.
* 
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPDMBaseEnoviaV5CAA&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iV_ID 
*   V_ID attribute value of the document Master 
* @param iRevision 
*   V_version attribute value document Revision 
*
* @param oListofV_ID 
*   List of V_ID of the set of documents linked with the document
* @param oListofRevisions
*   List of V_Version of the set of documents linked with the document.
*   The size of this list is equal with oListofV_ID size.
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;:execution successfully&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. Possible reasons of error are: &lt;/li&gt;
*       &lt;ul&gt;
*       &lt;li&gt;No document found for &lt;tt&gt;iV_ID&lt;/tt&gt; and &lt;tt&gt;iRevision&lt;/tt&gt; &lt;/li&gt;
*       &lt;li&gt;Connection to ENOVIA V5 database doesn&#x27;t exist&lt;/li&gt;
*     &lt;/ul&gt;
*  &lt;/ul&gt;
*/
ExportedByCATPDMBaseEnoviaV5CAA HRESULT GetDocumentSetFromV_IDAndRevision(const CATUnicodeString &amp; iV_ID,
																		  const CATUnicodeString &amp; iRevision,
																		  CATListOfCATUnicodeString &amp;oListofV_ID,
																		  CATListOfCATUnicodeString &amp;oListofRevisions);

/** 
* Extracts a document from ENOVIA V5 vault with its linked documents to a file directory.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method enables extract a document with its linked documents from ENOVIA V5 vault to a file directory. 
* 
*&lt;p&gt;If needed, your Imakefile.mk should include the module: &lt;b&gt;CATPDMBaseEnoviaV5CAA&lt;/b&gt; &lt;/p&gt;
*&lt;p&gt;
* @param iV_ID 
*   V_ID attribute value of the document Master 
* @param iRevision 
*   V_version attribute value document Revision 
* @param iDirectory_PATH 
*   path of the directory where the documents must be copied.
*
* @return 
*   &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: Documents successfully extracted to directory&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. Possible reasons of error are: &lt;/li&gt;
*       &lt;ul&gt;
*       &lt;li&gt;No document found for &lt;tt&gt;iV_ID&lt;/tt&gt; and &lt;tt&gt;iRevision&lt;/tt&gt; &lt;/li&gt;
*       &lt;li&gt;iDirectory_PATH doen&#x27;t exist&lt;/li&gt;
*       &lt;li&gt;iDirectory_PATH hasn&#x27;t the access write&lt;/li&gt;
*       &lt;li&gt;Unsufficient memory to extract all documents&lt;/li&gt;
*       &lt;li&gt;Connection to ENOVIA V5 database doesn&#x27;t exist&lt;/li&gt;
*     &lt;/ul&gt;
*  &lt;/ul&gt;
*/
ExportedByCATPDMBaseEnoviaV5CAA HRESULT ExtractDocumentSetToFileDirectory(const CATUnicodeString &amp; iV_ID,
																		  const CATUnicodeString &amp; iRevision,
																		  char * iDirectory_PATH);

/** 
* Client side API to enable the extraction of a document whithout any pointed and Force RerouteLinks for pointed
*
* &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: Enable the extraction of a document:
*	From Vault to a file directory.
*	Without any pointed document.
*	Otherwise, pointed links are rerouted from EnoviaLink to File Type Link 
*
*
* @param iListV_ID [in]
*   Name of each ENOVIA Document Master to extract (V_ID attribute value)
* @param iListRevision [in]
*   Name of each ENOVIA Document Revision (V_version attribute value)
* @param iDirectory_PATH [in]
*   the path where documents have to be extracted.
* @param iListFileNameToChange [in]
*   Fill this list if you want to rename document during extraction!
*
* @return
*   &lt;code&gt;S_OK&lt;/code&gt; if everything ran ok, otherwise...
*   &lt;code&gt;E_FAIL&lt;/code&gt; if an unrecoverable error occurs
*   &lt;code&gt;E_INVALIDARG&lt;/code&gt; if an arg does not match e.g:
*		iListV_ID.Size != iListRevision.Size
*		iListFileNameToChange.Size != 0 AND iListFileNameToChange.Size != iListRevision.Size
*		iListFileNameToChange.Size != 0 AND several identical string in iListFileNameToChange
*
*/
ExportedByCATPDMBaseEnoviaV5CAA HRESULT ExtractDocsToFileDirectory(	const CATListOfCATUnicodeString &amp; iListV_ID,
                                                                    const CATListOfCATUnicodeString &amp; iListRevision,
                                                                    char * iDirectory_PATH,
                                                                    CATListOfCATUnicodeString &amp; iListFileNameToChange);


/** 
* Starts the ENOVIA V5 server and connects the user to the ENOVIA V5 database.
*
* &lt;br&gt;&lt;br&gt;&lt;b&gt;Role : &lt;/b&gt;This method enables the connection to the ENOVIA V5 server. 
* It starts the ENOVIA V5 server and connects the user to the ENOVIA V5 database with the given role.
*
* &lt;br&gt;&lt;br&gt;&lt;b&gt;Caution : &lt;/b&gt;Any usage of this method other than in batch process is highly discouraged. 
* Example of prohibited usage is through user-exit or any interactive-based procedure.
* &lt;br&gt;Be aware not to launch simultaneous connections : do not use this method if CATIA is already connected to a running server.&lt;br&gt;&amp;nbsp
*
* @param iUser 
*   name of the user to connect
* @param iPwd 
*   password of the user declared with &lt;tt&gt;iUser&lt;/tt&gt;
* @param iServer 
*   ServerHost name
* &lt;br&gt;For instance  &lt;tt&gt;&quot;intedsy:1579&quot;&lt;/tt&gt;
* @param iRole
*   The selected role to connect the user to the ENOVIA V5 database 
* &lt;br&gt;For instance &lt;tt&gt;&quot;VPMDESIGNER.VPM.DEFAULT&quot;&lt;/tt&gt;
*
* @return 
*  &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK        &lt;/tt&gt; : User successfully connected to the database server.&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL      &lt;/tt&gt; : The connection has failed.&lt;/li&gt;
*   &lt;li&gt;&lt;tt&gt;E_INVALIDARG&lt;/tt&gt; : Parameters iUser, iPwd or iServer are empty.&lt;/li&gt;
*  &lt;/ul&gt;
*
*/
ExportedByCATPDMBaseEnoviaV5CAA HRESULT StartEV5Server(const CATUnicodeString &amp;iUser, 
                                                       const CATUnicodeString &amp;iPwd,
                                                       const CATUnicodeString &amp;iServer,
                                                       const CATUnicodeString &amp;iRole);


/**
* Stops the ENOVIA V5 server to which the client is connected.
*
* &lt;br&gt;&lt;br&gt;&lt;b&gt;Role : &lt;/b&gt;This method enables the disconnection to the ENOVIA V5 server.
* 
* &lt;br&gt;&lt;br&gt;&lt;b&gt;Caution : &lt;/b&gt;Any usage of this method other than in batch process is highly discouraged. 
* Example of prohibited usage is through user-exit or any interactive-based procedure.&lt;br&gt;&amp;nbsp
*
* @return
*  &lt;ul&gt;
*   &lt;li&gt;&lt;tt&gt;S_OK  &lt;/tt&gt; : Disconnection was performed sucessfully&lt;/li&gt; 
*   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt; : The disconnection has failed. Possible reasons are : 
*    &lt;ul&gt;
*     &lt;li&gt;Unable to catch the PDM Doc Environment&lt;/li&gt;
*     &lt;li&gt;No current connection to a running server&lt;/li&gt;
*     &lt;li&gt;Unknown&lt;/li&gt;
*    &lt;/ul&gt;
*   &lt;/li&gt;
*  &lt;/ul&gt;
*/
ExportedByCATPDMBaseEnoviaV5CAA HRESULT DisconnectEV5Server();

/** 
* Function which allows to clone a workpackage giving its unique identifier
*
* &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: Create a new workpackage by cloning all elements from the original structure
* These elemnest include Document Reviions and their associated Part Versiosns as well
*&lt;p&gt;
* @param iWPId
*    (input) The name (V_ID) of the root document to be cloned
* @param iWPVersion
*    (input) The vertsion number (V_version) of the root document
*
* @param oListOldObjIds 
*    (output) The names of the objects which have been actually cloned from the Workpackage.
*     &lt;br&gt;These objects may be either Part Versions or Document Revisions
* @param oListOldObjVersions
*    (output) The version numbers of the objects which have been actually cloned from the Workpackage
*    (including Part Versions and Document Revisions)
* @param oListOldObjTypes
*    (output) The types of the objects which have been actually cloned from the Workpackage
*    If the object is a PartVersion, type is Reference, if object is a document, type is the extension, 
*    CATPart, CATProduct, etc
*
* @param oListNewObjIds 
*    (output) The names (V_IDs) of the new objects whiuch have been created from the originals
*    (including Part Versions and Document Revisions)
* @param oListNewObjVersions
*    (output) The version numbers (V_versions) of the objects which have been created from the originals 
*    (including Part Versions and Document Revisions)
* @param oListOldObjTypes
*    (output) The types of the objects which have been created from the originals
*    If the object is a PartVersion, type is Reference, if object is a document, type is the extension, 
*    CATPart, CATProduct, etc
*
* @return 
*   &lt;ul&gt;
*     &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: Function executed successfully&lt;/li&gt; 
*     &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: Function has failed. Possible errors may be: 
*       &lt;ul&gt;
*        &lt;li&gt;Connection to ENOVIA V5 Server was not established&lt;/li&gt;
*        &lt;li&gt;Service not supported on the current Server&lt;/li&gt;
*        &lt;li&gt;No WP found with the input id and version &lt;/li&gt;
*        &lt;li&gt;Some P&amp;O privelege are missing for the current user 
*        &lt;li&gt;Abnormal error&lt;/li&gt;
*       &lt;/ul&gt;
*      &lt;/li&gt;
*  &lt;/ul&gt;
*/
/* @nodoc
*/
ExportedByCATPDMBaseEnoviaV5CAA HRESULT E2ESendTo(const CATUnicodeString&amp; iWPId, 
                         const CATUnicodeString&amp; iWPVersion,
                         CATLISTV(CATUnicodeString)&amp; oListOldObjIds,
                         CATLISTV(CATUnicodeString)&amp; oListOldObjVersions,
                         CATLISTV(CATUnicodeString)&amp; oListOldObjTypes,
                         CATLISTV(CATUnicodeString)&amp; oListNewObjIds,
                         CATLISTV(CATUnicodeString)&amp; oListNewObjVersions);


/**
* Interface to set the persistency mode for a product to be saved in ENOVIA V5 and its children.
*
* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;Enable to set the persistency mode for a product and optionally its children before to Save them in ENOVIA V5.
* &lt;br&gt;
*
* @param ipDoc
*    (input) The CATIA document to set its persistency mode.
*
* @param iSaveMode
*    (input) The persistency mode for the document to be saved. Possible values are: 
*    &lt;ul&gt;
*      &lt;li&gt;&lt;tt&gt;PermanentBlackBox&lt;/tt&gt;: Product, Part or any other applicative document will be streamed in the Vault.&lt;/li&gt;
*      &lt;li&gt;&lt;tt&gt;VolatileExposed&lt;/tt&gt;: Product document will be saved and exposed in ENOVIA V5 VPM.&lt;/li&gt;
*      &lt;li&gt;Values NotDefined and PermanentExposed are not accepted.&lt;/li&gt;
*    &lt;/ul&gt;
*
* @param iPropagate
*    (input) Boolean flag to enable the persistency mode propagation on children documents. Possible values are:
*    &lt;ul&gt;
*      &lt;li&gt;&lt;tt&gt;TRUE&lt;/tt&gt;: Propagation enable.&lt;/li&gt;
*      &lt;li&gt;&lt;tt&gt;FALSE&lt;/tt&gt;: Propagation unable.&lt;/li&gt;
*    &lt;/ul&gt;
*
* @return 
*    &lt;ul&gt;
*      &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: Persistency mode successfully set on document and successfully propagated on children.&lt;/li&gt;
*      &lt;li&gt;&lt;tt&gt;S_FALSE&lt;/tt&gt;: VolatileExposed mode successfully set on document, but the children propagation has only been partially executed.&lt;/li&gt;
*      &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: Persistency Mode or persistency children propagation has failed. Possible errors may be: 
*       &lt;ul&gt;
*        &lt;li&gt;The connection with the ENOVIA V5 Server isn&#x27;t established.&lt;/li&gt;
*        &lt;li&gt;The Document to be set is already persisted in ENOVIA V5.&lt;/li&gt;
*        &lt;li&gt;The VolatileExposed mode isnt supported on standalone CATProduct&lt;/li&gt;
*        &lt;li&gt;The PermanentBlackBox mode can&#x27;t be set on Document, because the VolatileExposed mode is set on one of its children.&lt;/li&gt;
*        &lt;li&gt;The VolatileExposed mode can&#x27;t be set on Document, because the PermanentBlackBox mode is set on one of its parents.&lt;/li&gt;
*        &lt;li&gt;The VolatileExposed mode propagation can&#x27;t be done, because a child of the document is already persisted as a PermanentBlackBox in EV5.&lt;/li&gt;
*        &lt;li&gt;The PermanentBlackBox mode propagation can&#x27;t be done, because a child of the document is already persisted as VolatileExposed in EV5.&lt;/li&gt;
*        &lt;li&gt;An abnormal error happened while setting or propagting the VaultMode.&lt;/li&gt;
*       &lt;/ul&gt;
*      &lt;/li&gt;
*      &lt;li&gt;&lt;tt&gt;E_INVALIDARG&lt;/tt&gt;: One or several arguments contain an improper value. Possible errors may be:
*       &lt;ul&gt;
*        &lt;li&gt;The [ipDoc] parameter is NULL or is not a CATDocument.&lt;/li&gt;
*        &lt;li&gt;The [iSaveMode] parameter value is different from &quot;PermanentBlackBox&quot; and &quot;VolatileExposed&quot;&lt;/li&gt;
*        &lt;li&gt;The [iSaveMode] parameter value is &quot;VolatileExposed&quot; whereas the [ipDoc] parameter isn&#x27;t a &quot;CATProduct&quot; typed document.&lt;/li&gt;
*       &lt;/ul&gt;
*      &lt;/li&gt;
*    &lt;/ul&gt;
*/
ExportedByCATPDMBaseEnoviaV5CAA HRESULT SetEV5PersistencyMode(CATDocument *ipDoc,
                                                              const CATIPDMPersistency::VaultMode&amp; iSaveMode, 
                                                              const CATBoolean&amp; iPropagate = FALSE);


/** 
* Interface to load in CATIA the product structure elements giving their uuids specified through a list of CATIPLMIdentificator
*
* &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: Load in CATIA (but does not open in editor) a list of product structure elements extracted from the ENOVIA database.
* Supported types are: PRC, Item-Instance, Part-Version, Document-Revision. Supported files which may be attached to DR, are CATPart, CATProduct, CATDrawing, CATAnalysis, CATMaterial, cgr, catalog and V4 model.
*&lt;p&gt;
* @param iListOfObjUuids
*    (input) The list of object identifiers to be loaded in CATIA
* @param oListOfDocs
*    (output) The list of documents loaded in CATIA session
* @return 
*   &lt;ul&gt;
*     &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: All the ENOVIA V5 entities have been successfully loaded.&lt;/li&gt; 
*     &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: Function has failed. At least one EV5 entity has not been loaded. Possible errors may be: 
*       &lt;ul&gt;
*        &lt;li&gt;Connection to EV5 server was not established,&lt;/li&gt;
*        &lt;li&gt;At least one ENOVIA V5 entity owns an unsupported type&lt;/li&gt;
*        &lt;li&gt;A service is not supported on the current Server,&lt;/li&gt;
*        &lt;li&gt;Some P&amp;O priveleges are missing for the current user,&lt;/li&gt;
*        &lt;li&gt;An abnormal error has been encountered.&lt;/li&gt;
*       &lt;/ul&gt;
*     &lt;/li&gt;
*     &lt;li&gt;&lt;tt&gt;E_INVALIDARG&lt;/tt&gt;: The input parameter [iListOfObjUuids] is empty.&lt;/li&gt;
*   &lt;/ul&gt;
*/
ExportedByCATPDMBaseEnoviaV5CAA HRESULT LoadFromPDM(CATLISTV(CATIPLMIdentificator_var)&amp; iListOfObjUuids,
                                                    CATLISTP(CATDocument)*&amp; opListOfDocs);


//ZPL addition to automate the EV5 Save process for Highlight &quot;SaveInEnovia&quot;
/**
* Interface to start EV5 Save process from CATIA based on a root starter doc loaded in CATIA Session
*
* &lt;br&gt;&lt;b&gt;Role&lt;/b&gt;: Starts EV5 save process from a root doc available in CATIA session and Saves all related Docs to ENOVIA database.
*&lt;p&gt;
* @param ipRootDoc
*    (input) The CATIA root document to be saved in Enovia database
* @param oMessageReport 
*    (output) The message report returned as an XML stream 
* @param iSaveMode 
*    (input) The Save Mode
*     Possible values : 0= Full Save mode (Default mode)
*                     : 1= Partial Save mode (Applicable to batch mode only).
*     Rules: Input parameter will be used in Batch mode only. 
*            Interactively CATSetting will be taken into consideration.
*
* @return
*    &lt;ul&gt;
*      &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: EV5 Save process has been succeded, Commit done for Root doc and all.related docs available in session&lt;/li&gt;
*      &lt;li&gt;&lt;tt&gt;S_FALSE&lt;/tt&gt;: EV5 save process failed for some objects (In case of Partial save commit not done for some docs).&lt;/li&gt;
*      &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: EV5 save process failed. Commit not done and Rollback has been performed. Possible errors may be:
*       &lt;ul&gt;
*        &lt;li&gt;The connection with the ENOVIA V5 Server isn&#x27;t established.&lt;/li&gt;
*        &lt;li&gt;A service is not supported on the current Server,&lt;/li&gt;
*        &lt;li&gt;Some P&amp;O priveleges are missing for the current user,&lt;/li&gt;
*        &lt;li&gt;An abnormal error occured during Save process.&lt;/li&gt;
*       &lt;/ul&gt;
*      &lt;/li&gt;
*      &lt;li&gt;&lt;tt&gt;E_INVALIDARG&lt;/tt&gt;: One or several arguments contain an improper value. Possible errors may be:
*       &lt;ul&gt;
*        &lt;li&gt;The [ipRootDoc] parameter is NULL or is not a CATDocument.&lt;/li&gt;
*       &lt;/ul&gt;
*      &lt;/li&gt;
*    &lt;/ul&gt;
*/
ExportedByCATPDMBaseEnoviaV5CAA HRESULT SaveToPDM(CATDocument * ipRootDoc, CATUnicodeString&amp; oMessageReport, int iSaveMode = 0);


#endif
</div>
    
    <div class="navigation">
        <div><a href="CATPDMCSServices.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATPDMCSServices.h</a></div>
        <div><a href="CATPDMPVRServices.html">‰∏ã‰∏ÄÈ°µ: CATPDMPVRServices.h ‚Üí</a></div>
    </div>
</body>
</html>