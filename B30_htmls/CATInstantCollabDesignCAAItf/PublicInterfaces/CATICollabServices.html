<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CATInstantCollabDesignCAAItf/PublicInterfaces/CATICollabServices.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>CATInstantCollabDesignCAAItf/PublicInterfaces/CATICollabServices.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATIColSharable.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIColSharable.h</a></div>
        <div><a href="CATInstantCollabDesignItf.html">‰∏ã‰∏ÄÈ°µ: CATInstantCollabDesignItf.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">// COPYRIGHT Dassault Systemes 2004
//===================================================================
//
// CATICollabServices.h
// Define the CATICollabServices interface
//
//===================================================================
//
// Usage notes:
//   New interface: describe its use here
//
//===================================================================
//
//  Jun 2004  Creation: Code generated by the CAA wizard  ank
//===================================================================
#ifndef CATICollabServices_H
#define CATICollabServices_H
/**
* @CAA2Level L1
* @CAA2Usage U3
*/
#include &quot;CATBaseUnknown.h&quot;
#include &quot;CATInstantCollabDesignItf.h&quot;
#include &quot;sequence_CATBaseUnknown_ptr.h&quot;
#include &quot;CATListOfCATUnicodeString.h&quot;
#include &quot;CATUnicodeString.h&quot;
#include &quot;CATIColId.h&quot;
#include &quot;CATLISTP_Declare.h&quot;
#include &quot;CATISpecObject.h&quot;
#include &quot;CATTypUtilit.h&quot;

class CATISpecObject;
class CATDocument;
class CATIColIdManager;

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATInstantCollabDesignItf IID IID_CATICollabServices;
#else
extern &quot;C&quot; const IID IID_CATICollabServices ;
#endif


//------------------------------------------------------------------

/**
* This class provides some services to 
* &lt;li&gt;Help people filling the context tables : get fathers, get linked relations...&lt;/li&gt;
* &lt;li&gt;Access the id manager&lt;/li&gt;
* &lt;li&gt;Manage errors returned by the collaboration engine&lt;/li&gt;
* A pointer to the services instance can be retrieved thanks to the CATCreateCATICollabServicesM method
*/

//-- Usefull Macros
#define CATLISTP_APPLY_RELEASE( PLP ) \
	if ( PLP ) \
{ CATLISTP_FORWARD_LOOP( *PLP, itr ) \
    if ( (*PLP)[itr] )  (*PLP)[itr]-&gt;Release(); \
    CATLISTP_END_LOOP \
    delete PLP; \
PLP = NULL; }


//-- Flags used by applications for code versionning

/* COLLAB_CAA enable the new CXR16*/
#undef COLLAB_CAA
#define COLLAB_CAA

/* COLLAB_NEW_FLAG enable the new share access inside CATIColSharable */
#undef COLLAB_NEW_FLAG
#define COLLAB_NEW_FLAG


class ExportedByCATInstantCollabDesignItf CATICollabServices: public CATBaseUnknown
{
	CATDeclareInterface;
	
public:

	/**
	*	Get all the father chain of iObject and fill the oList list  
	*	@param iObject
	*		Object to process
	*	@param oList
	*		OUT : list containing the fathers
	*/
	virtual HRESULT GetSharableFathers(CATBaseUnknown *&amp; iObject, 
									   CATLISTP(CATBaseUnknown) *&amp; oList) = 0;
	
	/**
	*	Return the first sharable iObject&#x27;s father with PUBLIC_SHARE access
	*/
	virtual CATBaseUnknown * GetPublicSharableFather(CATISpecObject_var &amp; iObject) = 0;

	
	/**
	*	Get all the children of iObject inside the list oList
	*	@param iObject
	*		Object to process
	*	@param oList
	*		OUT : list containing the children
	*/
	virtual HRESULT GetSharableChildren(CATBaseUnknown *&amp; iObject, 
										CATLISTP(CATBaseUnknown) *&amp; oList) = 0;
	
	/**
	*	Get all the dependencies (tk_specobject links) of iObject inside the list oList
	*	@param iObject
	*		Object to process
	*	@param oList
	*		OUT : list containing the tk_specobject dependencies
	*/
	virtual HRESULT GetSharableInternalDependencies(CATBaseUnknown *&amp; iObject,
												    CATLISTP(CATBaseUnknown) *&amp; oList) = 0;
	
	/**
	*	Get all the relations valuating the params of iObject inside the list oList.&lt;br&gt;
	*	@param iObject
	*		Object to process
	*	@param oList
	*		OUT : list containing the knowledge relations
	*/
	virtual HRESULT ListKnowlegdeRelations(CATISpecObject * iObject, 
								   CATListPtrCATBaseUnknown &amp; oList,
								   CATListPtrCATBaseUnknown * oParamList=NULL) = 0;
	
	/**
	*	Compare two collaborative features with a unique sorting key&lt;br&gt;
	*	This service is usefull in a multiple concurrent design environement to guarantee that &lt;br&gt;
	*	the features will be positionned in the same order in any document.
	*	@param oRes 
	*		oRes= -1 if pObj1 must be before pObj2
	*		oRes = 0 if pObj1 and pOb2 have the same id
	*		oRes = 1 if pObj1 must be after pObj2
	*/
	virtual HRESULT CompareCollaborativeFeatures(const CATBaseUnknown * pObj1,const CATBaseUnknown * pObj2,int &amp; oRes) = 0;

	/**
	*	Get a pointer to the current document
	*	@param oDocument
	*		the current document. No addRef is done !!!
	*	@param iReferenceObject
	*		if not null, the document returned thanks to CATILinkableObject interface is returned.
	*		if null, the FrmEditor is used
	*/
	virtual HRESULT GetCurrentDocumentPtr(CATDocument *&amp; oDocument,const CATBaseUnknown * iReferenceObject = NULL) = 0;
	
	
	/**
	@nodoc
	*/
	virtual HRESULT GetCollabIdManager(CATIColIdManager ** oManager,const CATBaseUnknown * iReferenceObject = NULL) = 0;

	/**
	*	Retreive the Collaboration Id opCollId of a given feature iObject
	*	@param iObject
	*		object for wich Id is requested
	*	@param opCollId [out, CATBaseUnknown#Release]
	*/
	virtual HRESULT GetCollabUUID(const CATBaseUnknown * iObject, CATIColId** opCollId,int iCreateIfNeeded=0) = 0;

	/**
	*	Create a new CATIColId for iObject
	*/
	virtual HRESULT AssignCollabId(const CATBaseUnknown * iObject) = 0;

	/**
	*	Associate iObject with a collaboration Id built from iUUIDBuffer
	*	@param iObject
	*		Object to identify
	*	@param iUUIDBuffer
	*		Buffer used to create the CATIColId which will indetify the input object&lt;br&gt;
	*		The buffer MUST contain 16 bytes
	*/	
	virtual HRESULT AssociateCollabId(const CATBaseUnknown * iObject,void * iUUIDBuffer) = 0;

};

//------------------------------------------------------------------

#endif
</div>
    
    <div class="navigation">
        <div><a href="CATIColSharable.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIColSharable.h</a></div>
        <div><a href="CATInstantCollabDesignItf.html">‰∏ã‰∏ÄÈ°µ: CATInstantCollabDesignItf.h ‚Üí</a></div>
    </div>
</body>
</html>