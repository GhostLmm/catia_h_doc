<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ObjectModelerBase/PublicInterfaces/CATOmbWarmStartServices.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ObjectModelerBase/PublicInterfaces/CATOmbWarmStartServices.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATOmbWarmStart.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATOmbWarmStart.h</a></div>
        <div><a href="CATReporterError.html">‰∏ã‰∏ÄÈ°µ: CATReporterError.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">#ifndef CATOmbWarmStartServices_H
#define CATOmbWarmStartServices_H
/* -*-c++-*- */
// COPYRIGHT DASSAULT SYSTEMES 2003

/**
  * @CAA2Level L1
  * @CAA2Usage U1
  */

#include &quot;CATOmbWarmStart.h&quot;
#include &quot;IUnknown.h&quot;
#include &quot;CATBoolean.h&quot;
class CATUnicodeString;

/**
* UI warning mode for Incremental backup activity reporting:
* NoActivWIBWarn : No warning displayed when incremental backup deactivated
* EasyActivWIBWarn : Fugitive warning displayed when incremental backup deactivated
* ModalActivWIBWarn : Modal warning panel, waiting for user confirmation, displayed when incremental backup is deactivated
*/
enum CATActivWIBWarnMode
{
  NoActivWIBWarn,
  EasyActivWIBWarn,
  ModalActivWIBWarn
};

/**
* Services to control the warmstart incremental backup.
* &lt;b&gt;Role:&lt;/b&gt; The following static methods are meant to be used by CAA applications which
* want to benefit from the warmstart system. They will provide basic services to test 
* the status of the warmstart and interact with it (activate, deactivate, commit 
* modifications...).  
*/

class ExportedByCATOmbWarmStart CATOmbWarmStartServices
{
 public:

  /**
  * @deprecated V5R18 
  * &lt;br&gt;&lt;b&gt; use HRESULT Deactivate(CATBoolean iDeleteLog, CATUnicodeString&amp; oWarningMessageToDisplay)&lt;/b&gt;
  * &lt;br&gt;Deactivates the warmstart incremental backup.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt; This method should be called in the @href #CATCommand Activate method of 
  * a command when it is known that the command is incompatible with incremental backup.
  * &lt;br&gt;It will stop the warmstart logging and delete all previous logged data.
  * &lt;br&gt;If successful, the caller should display the returned message warning 
  * the user to save his data.
  * Use the following code to call this service and display the user message:
  * &lt;pre&gt;
  *   CATUnicodeString WarningMessage;
  *   HRESULT hr = CATOmbWarmStartServices::&lt;b&gt;Deactivate&lt;/b&gt;(WarningMessage);
  *   if( SUCCEEDED(hr) &amp;&amp; (0 !=warningMessage.GetLengthInChar()) )
  *   {	
  *      CATApplicationFrame * pFrame = &lt;b&gt;CATApplicationFrame::GetFrame&lt;/b&gt;();
  *      if( (NULL!=pFrame) &amp;&amp; (NULL!=pFrame-&gt;GetMainWindow()) )
  *      {
  *         CATDlgNotify *pNfy = new &lt;b&gt;CATDlgNotify&lt;/b&gt;(pFrame-&gt;GetMainWindow(), 
  *                                  &quot;AutoSave&quot;, 
  *                                  CATDlgNfyInformation|CATDlgNfyOK|CATDlgWndModal);
  *
  *          CATUnicodeString WindowTitle=&quot;..&quot;;
  *          pNfy-&gt;&lt;b&gt;DisplayBlocked&lt;/b&gt;(WarningMessage ,WindowTitle);
  *          pNfy-&gt;RequestDelayedDestruction();
  *      }
  *   }
  * &lt;/pre&gt;
  *
  * @param oWarningMessageToDisplay
  *     The warning message to be displayed to the user if successful (S_OK returned).
  *
  * @return
  *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
  *   &lt;dl&gt;
  *     &lt;dt&gt;S_OK&lt;/dt&gt;
  *     &lt;dd&gt;The warmstart was successfully deactivated.&lt;/dd&gt;
  *     &lt;dt&gt;E_FAIL&lt;/dt&gt;
  *     &lt;dd&gt;The deactivation failed, either because warmstart is not available, or it was 
  *          already deactivated.&lt;/dd&gt;
  *   &lt;/dl&gt;
  */
  static HRESULT Deactivate(CATUnicodeString&amp; oWarningMessageToDisplay);

  /**
  * Deactivates the warmstart incremental backup.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt; This method should be called in the @href #CATCommand Activate method of 
  * a command when it is known that the command is incompatible with incremental backup.
  * &lt;br&gt;It will stop the warmstart logging and also, when requested, delete all previous logged data.
  * &lt;br&gt;If successful, the caller should display the returned message warning the user to save his data.
  * &lt;br&gt;Use the following code to call this service and display the user message:
  * &lt;pre&gt;
  *   CATUnicodeString WarningMessage;
  *   int iDeleteLog = 0; // depending user wants to delete or not previously logged data
  *   HRESULT hr = CATOmbWarmStartServices::&lt;b&gt;Deactivate&lt;/b&gt;(iDeleteLog, WarningMessage);
  *   if( SUCCEEDED(hr) &amp;&amp; (0 !=warningMessage.GetLengthInChar()) )
  *   {	
  *      CATApplicationFrame * pFrame = &lt;b&gt;CATApplicationFrame::GetFrame&lt;/b&gt;();
  *      if( (NULL!=pFrame) &amp;&amp; (NULL!=pFrame-&gt;GetMainWindow()) )
  *      {
  *         CATDlgNotify *pNfy = new &lt;b&gt;CATDlgNotify&lt;/b&gt;(pFrame-&gt;GetMainWindow(), 
  *                                  &quot;AutoSave&quot;, 
  *                                  CATDlgNfyInformation|CATDlgNfyOK|CATDlgWndModal);
  *
  *          CATUnicodeString WindowTitle=&quot;..&quot;;
  *          pNfy-&gt;&lt;b&gt;DisplayBlocked&lt;/b&gt;(WarningMessage ,WindowTitle);
  *          pNfy-&gt;RequestDelayedDestruction();
  *      }
  *   }
  * &lt;/pre&gt;
  *
  * @param iDeleteLog
  *     Delete when requested the previously logged data at deactivation time.
  * &lt;ul&gt;
  *     &lt;li&gt;FALSE: Logged data remain until next incremental backup activation.
  *     &lt;br&gt;If a crash occurs after deactivation, all commands preceeding deactivated one will be restored.&lt;/li&gt;
  *     &lt;li&gt;TRUE: Logged data are deleted at deactivation time.
  *     &lt;br&gt;If a crash occurs after deactivation, none of the commands preceeding deactivated one will be restored.
  *     &lt;br&gt;User should save all data before processing deactivated command.&lt;/li&gt;
  * &lt;/ul&gt;
  *
  * @param oWarningMessageToDisplay
  *     The warning message to be displayed to the user if successful (S_OK returned).
  *
  * @return
  *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
  *   &lt;dl&gt;
  *     &lt;dt&gt;S_OK&lt;/dt&gt;
  *     &lt;dd&gt;The warmstart was successfully deactivated.&lt;/dd&gt;
  *     &lt;dt&gt;E_FAIL&lt;/dt&gt;
  *     &lt;dd&gt;The deactivation failed, either because warmstart is not available, or it was 
  *          already deactivated.&lt;/dd&gt;
  *   &lt;/dl&gt;
  */
  static HRESULT Deactivate(CATBoolean iDeleteLog, CATUnicodeString&amp; oWarningMessageToDisplay);

  /**
  * Activates or re-initialises the warmstart incremental backup.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt; This method should be called in commands saving or closing documents.
  * It will succeed only if none of the open documents is dirty (aka modified and not saved).
  * If the warmstart was previously:
  * &lt;ul&gt;
  *  &lt;li&gt;deactivated, it will be reactivated: a copy of each loaded V5 documents 
  *    will be done, and log files will be created.&lt;/li&gt;
  *  &lt;li&gt;Already activated, it will be re-initialized. A copy of each loaded V5 documents 
  *    is done, and the backup data files are emptied.&lt;/li&gt;
  * &lt;/ul&gt;
  * &lt;br&gt;If successful, the caller should display the returned warning message. Use the following 
  * code to call this service and display the user message:
  * &lt;pre&gt;
  *   CATUnicodeString WarningMessage;
  *   HRESULT hr = CATOmbWarmStartServices::Activate(WarningMessage);
  *   if( SUCCEEDED(hr) &amp;&amp; (0!=WarningMessage.GetLengthInChar()) )
  *   {	
  *      CATApplicationFrame *pFrame = CATApplicationFrame::GetFrame();
  *      if( (NULL!=pFrame) &amp;&amp; (NULL!=pFrame-&gt;GetMainWindow()) )
  *      {
  *         CATDlgNotify *pNfy = new CATDlgNotify(pFrame-&gt;GetMainWindow(), 
  *                                &quot;AutoSave&quot;, 
  *                                CATDlgNfyInformation|CATDlgNfyOK|CATDlgWndModal);
  *
  *         CATUnicodeString WindowTitle = &quot;...&quot; ;
  *         pNfy-&gt;DisplayBlocked(WarningMessage , WindowTitle);
  *         pNfy-&gt;RequestDelayedDestruction();
  *      }
  *   }
  * &lt;/pre&gt;
  *
  * @param oWarningMessageToDisplay
  *     The warning message to be displayed to the user if successful (S_OK returned).
  *
  * @return
  *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
  *   &lt;dl&gt;
  *     &lt;dt&gt;S_OK&lt;/dt&gt;
  *     &lt;dd&gt;The warmstart was successfully activated or re-initialized.&lt;/dd&gt;
  *     &lt;dt&gt;E_FAIL&lt;/dt&gt;
  *     &lt;dd&gt;The activation failed, either because warmstart is not available, or 
  *         some documents were dirty.&lt;/dd&gt;
  *   &lt;/dl&gt;
  */
  static HRESULT Activate(CATUnicodeString&amp; oWarningMessageToDisplay);

  /**
  * Commits the transaction into the warmstart backup data.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt; Normally the operations inside a command are validated at the end of 
  * the command for a state command, or at the activation of the next for the others. 
  *  That wants to say that as long as the validation is not made, if the V5 session is broken, 
  *  the last operations will be not restored at the backup. However, you can force this 
  *  validation during a command if it is necessary. 
  *  &lt;br&gt;This method should be called to force the 
  *  latest modifications on the model to be commited into the backup data. This means that 
  * those modifications will be replayed if a warmstart is needed. 
  * The method should be called only when the 
  * modifications to commit make a coherent transaction up, so that if they are replayed, 
  * the model won&#x27;t be left in a instable state.
  * @return
  *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
  *   &lt;dl&gt;
  *     &lt;dt&gt;S_OK&lt;/dt&gt;
  *     &lt;dd&gt;The transaction has been successfully committed.&lt;/dd&gt;
  *     &lt;dt&gt;E_FAIL&lt;/dt&gt;
  *     &lt;dd&gt;An internal error prevented the transaction from being committed.&lt;/dd&gt;
  *   &lt;/dl&gt;
  */
  static HRESULT CommitTransaction();

  /**
  * Tests if the warmstart is active.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt; This method should be called to test if the warmstart is 
  *  currently saving backup data.
  *
  * @param oActive
  *     When successful (S_OK returned) : TRUE if the warmstart is active, FALSE otherwise.
  *
  * @return
  *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
  *   &lt;dl&gt;
  *     &lt;dt&gt;S_OK&lt;/dt&gt;
  *     &lt;dd&gt;The returned status is meaningful.&lt;/dd&gt;
  *     &lt;dt&gt;E_FAIL&lt;/dt&gt;
  *     &lt;dd&gt;The warmstart is not available, or an internal error prevents 
  *        the status from being retrieved.&lt;/dd&gt;
  *   &lt;/dl&gt;
  */
  static HRESULT IsActive(CATBoolean &amp;oActive);

  /**
  * Tests if the warmstart is available.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt; This method should be called to test if the warmstart can be activated,
  * depending on environment variables and user settings.
  *
  * @param oAvailable
  *     When successful (S_OK returned) : TRUE if the warmstart is available, FALSE otherwise.
  *
  * @return
  *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
  *   &lt;dl&gt;
  *     &lt;dt&gt;S_OK&lt;/dt&gt;
  *     &lt;dd&gt;The returned status is meaningful.&lt;/dd&gt;
  *     &lt;dt&gt;E_FAIL&lt;/dt&gt;
  *     &lt;dd&gt;An internal error prevents the status from being retrieved.&lt;/dd&gt;
  *   &lt;/dl&gt;
  */
  static HRESULT IsAvailable(CATBoolean &amp;oAvailable);


};
#endif
</div>
    
    <div class="navigation">
        <div><a href="CATOmbWarmStart.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATOmbWarmStart.h</a></div>
        <div><a href="CATReporterError.html">‰∏ã‰∏ÄÈ°µ: CATReporterError.h ‚Üí</a></div>
    </div>
</body>
</html>