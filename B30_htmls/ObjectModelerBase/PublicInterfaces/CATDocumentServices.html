<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ObjectModelerBase/PublicInterfaces/CATDocumentServices.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ObjectModelerBase/PublicInterfaces/CATDocumentServices.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATDocumentIntegrityServices.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATDocumentIntegrityServices.h</a></div>
        <div><a href="CATDocumentsInSession.html">‰∏ã‰∏ÄÈ°µ: CATDocumentsInSession.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">#ifndef CATDocumentServices_H
#define CATDocumentServices_H
/* -*-c++-*- */
// COPYRIGHT DASSAULT SYSTEMES 1999

/**
  * @CAA2Level L1
  * @CAA2Usage U1
  */



#include &quot;AC0XXLNK.h&quot;
#include &quot;CATBaseUnknown.h&quot;
#include &quot;booleanDef.h&quot;
#include &quot;CATUnicodeString.h&quot;
#include &quot;CATDocumentsInSession.h&quot;
#include &quot;CATListOfCATUnicodeString.h&quot;
class CATDocument;
class CATUuid;
class CATIDocId;

/**
* Services to create, open and close documents.
* &lt;b&gt;Role:&lt;/b&gt;All methods of this class must be used to create, open or close a document when &lt;b&gt;no
* visualization is necessary&lt;/b&gt;. This is always the case in batch mode, but it is also possible 
* in interactive mode. 
* &lt;br&gt;If you want to visualize the document, use the &lt;i&gt;CATIIniInteractiveSession&lt;/i&gt;
* interface. This last interface is defined in the InteractiveInterfaces Framework.
* &lt;br&gt;Please notice that Open, Save and SaveAs methods perform the same action on model data using either CATDocumentServices or CATIIniInteractiveSession.
* &lt;br&gt;&lt;br&gt;There are three methods for creating a (or several) new document(s) in the current session:
* &lt;ul&gt;
* &lt;li&gt;@href #New &lt;/li&gt;
* &lt;li&gt;@href #OpenDocument &lt;/li&gt;
* &lt;li&gt;@href #NewFrom &lt;/li&gt;
* &lt;/ul&gt;
* There are three methods for saving a document:
* &lt;ul&gt;
* &lt;li&gt;@href #Save (to use only in interactive mode)&lt;/li&gt;
* &lt;li&gt;@href #SaveAs &lt;/li&gt;
* &lt;li&gt;@href #SaveAsNew &lt;/li&gt;
* &lt;/ul&gt;
*  There is one method for closing a document:
* &lt;ul&gt;
* &lt;li&gt;@href #Remove &lt;/li&gt;
* &lt;/ul&gt;
* There is one method for retrieving a document by its filename:
* &lt;ul&gt;
* &lt;li&gt;@href #GetDocumentInSession
* &lt;/ul&gt;
* &lt;b&gt;Life cycle of the document:&lt;/b&gt;
* &lt;br&gt;
* &lt;br&gt;&lt;i&gt;The AddRef/Release mechanism is not used:&lt;/i&gt;
* &lt;br&gt;All methods which return a CATDocument pointer have not performed an Addref on the pointer. So
* there is no need to release it. 
* &lt;br&gt; A CATDocument object created by &lt;tt&gt;New&lt;/tt&gt;, &lt;tt&gt;Open&lt;/tt&gt;(*), or &lt;tt&gt;NewFrom&lt;/tt&gt; must 
* be removed from the session by the &lt;tt&gt;Remove&lt;/tt&gt; method. 
* &lt;br&gt;(*)Note that if the &quot;open&quot; is actually a &quot;reopen&quot;, only one call to &lt;tt&gt;Remove&lt;/tt&gt; must be done.
* &lt;br&gt;
* &lt;br&gt;&lt;i&gt;The Lock/Unlock mechanism is used&lt;/i&gt;
* &lt;br&gt;Look at this example:
* &lt;br&gt;1)Open a CATProduct which contains a CATPart
* &lt;br&gt;2)Open independently the same CATPart too 
* &lt;br&gt;You should &lt;tt&gt;Remove&lt;/tt&gt; the 2 documents, but when the CATProduct document will be closed, 
* the CATPart will be also. So a specific call to &lt;tt&gt;Remove&lt;/tt&gt; for the independent CATPart 
* will end in an error. 
* &lt;br&gt;So a multi-reference mechanism is necessary: @href CATLockDocument and
* @href CATUnLockDocument. 
* &lt;br&gt;&lt;br&gt;&lt;i&gt;When do you lock a document ?&lt;/i&gt;
* &lt;br&gt; In batch mode, if you are not sure of the relation between each model opened, 
* lock the model after each open, and unlock it to remove it. 
* &lt;br&gt; In interactive mode, if your class keeps a pointer on a document, lock it and 
* unlock it when the pointer is no longer needed. 
* @see CATDocument 
*/

class ExportedByAC0XXLNK CATDocumentServices
{
 public:

  /**
  * Test if a given document type is meant to be CATIA loadable.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt; Provide support to know if a given document type can be or not 
  * loaded in session memory as a CATDocument 
  * &lt;br&gt;Being a loadable document requires CATIPersistent implementation on the given type
  * @param iType
  *     The string to define the kind of document to test. 
  *     it returns S_OK otherwise E_FAIL
  */
  static HRESULT IsKnownAsAPersistentType(const CATUnicodeString&amp; iType);

  /**
  * Test if a given document alias is meant to be CATIA creatable.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt; Provide support to know if a given document alias can be or not 
  * provided to be created in session memory as a CATDocument (See New) 
  * &lt;br&gt;Being a creatable document requires CATIDocAlias or CATIPersistent implementation on the given alias
  * @param iAliasType
  *     The string to define the kind of document to test. 
  *     it returns S_OK, this can be used as a creation alias
  *     it returns E_FAIL, this is not.
  */
  static HRESULT IsKnownAsAnAliasType(const CATUnicodeString&amp; iAliasType);

  /**
  * Creates a document of a given type.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt; Creates and initializes data of a document of the given type. The
  * initialization is done thanks to the @href CATInit#init method.
  * &lt;br&gt;The document must be removed from the session before exiting or when it is
  * no longer needed. See explanations, at the top of this page, about the life 
  * cycle of the document.
  * &lt;br&gt;The name of the document is &lt;tt&gt;iType + Number + suffix&lt;/tt&gt;. The suffix 
  * is dedicated to iType such as &lt;tt&gt;.CATPart&lt;/tt&gt; for the type &lt;tt&gt;Part&lt;/tt&gt;.  
  * &lt;br&gt;As long as the document is not saved, the storage name ( @href CATDocument#StorageName ),
  * is equal to the name. 
  * @param iType
  *     The string to define the kind of document to create. 
  *     &lt;br&gt; The string is the one which appears in the panel File/New.
  * @param oNewDoc 
  *     The document created.
  */
  static HRESULT New (const CATUnicodeString&amp; iType, CATDocument*&amp; oNewDoc);
  
  /**
  * @nodoc
  *
  * Opens a given document.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt; If the file already exists in the session, it will not be re-loaded.
  * &lt;br&gt;The document must be removed from the session before exiting or when it is no 
  * longer needed. See explanations at the top of this page about the life 
  * cycle of the document.
  * @param iStorageName
  *      The complete access name of the file to open (path + name of the file ). 
  *      &lt;br&gt;See @href CATDocument#StorageName for more information about the storage name.
  * @param oOpenedDoc 
  *      The opened document.
  *      &lt;br&gt;If the &quot;open&quot; is a &quot;re-open&quot;, the pointer is not a new pointer. Do not remove 
  *      the pointer twice.
  * @param iReadOnly
  *      FALSE: Default value, the document will be in read/write mode.
  *  &lt;br&gt; TRUE: The document is in read only mode.
  *  &lt;br&gt;In case of a re-opening, the mode of the document is defined by the first open.
  * @return
  *		 S_OK : The document was opened sucessfully.
  *	&lt;br&gt; S_FALSE : The document has already been loaded. The returned oOpenedDoc pointer 
  * points to this document.
  *	&lt;br&gt; E_FAIL : The open operation failed.
  */
  static HRESULT Open ( const CATUnicodeString&amp; iStorageName, CATDocument*&amp; oOpenedDoc, CATBoolean iReadOnly=FALSE);

  /** @nodoc */
  static HRESULT Open ( const CATUnicodeString&amp; storageName, CATDocument*&amp; oOpenedDoc, const CATUnicodeString&amp; type, CATBoolean ReadOnly=FALSE);

  /** @nodoc */
  static HRESULT Open ( CATIDocId* iDocId, CATDocument*&amp; oOpenedDoc, CATBoolean ReadOnly=FALSE);

  
  /**
  * Opens a given document.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt; If the file already exists in the session, it will not be re-loaded.
  * &lt;br&gt;The document must be removed from the session before exiting or when it is no 
  * longer needed. See explanations at the top of this page about the life 
  * cycle of the document.
  * &lt;br&gt;&lt;b&gt;Note:&lt;/b&gt; This method does not allow opening .feat or .CATfct catalogs. It is not possible to access .feat
  * catalogs because they contain Dassault Systemes private data. To open a .CATfct catalog, see &lt;i&gt;CATCatalogFactoryServices&lt;/i&gt;
  * (ObjectSpecsModeler framework). 
  * @param iStorageName
  *      The complete access name of the file to open ( path + name of the file ). 
  *      &lt;br&gt;See @href CATDocument#StorageName for more information about the storage name.
  * @param oOpenedDoc 
  *      The opened document.
  *      &lt;br&gt;If the &quot;open&quot; is a &quot;re-open&quot;, the pointer is not a new pointer. Do not remove 
  *      the pointer twice.
  * @param iReadOnly
  *      FALSE: Default value, the document will be in read/write mode.
  *  &lt;br&gt; TRUE: The document is in read only mode.
  *  &lt;br&gt;In case of a re-opening, the mode of the document is defined by the first open.
  * @return
  *		 S_OK : The document was opened sucessfully.
  *	&lt;br&gt; S_FALSE : The document has already been loaded. The returned oOpenedDoc pointer 
  * points to this document.
  *	&lt;br&gt; E_FAIL : The open operation failed.
  */
  static HRESULT OpenDocument ( const CATUnicodeString&amp; iStorageName, CATDocument*&amp; oOpenedDoc, CATBoolean iReadOnly=FALSE);

  /**
  * Retrieves a document in session by its complete access name.
  * @param iStorageName
  *      The complete access name to the searched file (path + name of the file ).
  *      &lt;br&gt;See @href CATDocument#StorageName for more information about the storage name.
  * @param oOpenedDoc
  *      The found document.
  */
  static HRESULT GetDocumentInSession ( const CATUnicodeString&amp; iStorageName, CATDocument*&amp; oOpenedDoc);

  /** @nodoc */
  static HRESULT GetDocumentInSession ( const CATUnicodeString&amp; fileName, const CATUuid&amp; fileUuid, CATDocument*&amp; oOpenedDoc);
	
  /** @nodoc */
  static HRESULT GetDocumentInSession ( CATIDocId* iDocId, CATDocument*&amp; oOpenedDoc);

  /**
  * Saves a given document in interactive mode.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;To save a document two cases:
  * &lt;ul&gt;
  * &lt;li&gt;In interactive mode, use this method or the method  
  * &lt;i&gt;CATIIniInteractiveSession::Save&lt;/i&gt; twice are equal&lt;/li&gt;
  * &lt;li&gt;In batch mode, use @href #SaveAs in using the current storage name of your document @href CATDocument#StorageName&lt;/li&gt;
  * &lt;pre&gt;
  *     CATUnicodeString StorageNameDocument ;
  *     StorageNameDocument = pDocument-&gt;StorageName();
  *     ::SaveAs(pDocument,StorageNameDocument);
  * &lt;/pre&gt;
  * &lt;/ul&gt;
  * @param iDocument
  *       The document to save.
  * @param iSavePointedIfNecessary
  *       TRUE : default value, to save all documents referred to by iDocument if they have 
  *              been modified during the session.
  *       &lt;br&gt; FALSE: only iDocument will be saved.
  * @return
  *		 S_OK : The document was saved successfully.
  *	&lt;br&gt; S_FALSE : The document does not need to be saved.
  *	&lt;br&gt; E_FAIL : The document save operation failed.
  */
  static HRESULT  Save ( CATDocument&amp; iDocument, CATBoolean iSavePointedIfNecessary = TRUE);
  
  /**
  * Saves a document with a different name.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;Save the document in the file specified by iStorageName. 
  * &lt;br&gt; Please note that no thumbnail for the document is generated or updated in batch mode. 
  * @param iDocument
  *       The document to save.
  * @param iStorageName
  *       The complete access name of the file.
  *       &lt;br&gt;The format of this argument is: path + name of the file.
  *       &lt;br&gt;It is the new storage name of the document. 
  *       &lt;br&gt;See @href CATDocument#StorageName to have more information about the storage name.
  * @param iFormat
  *       To save the document with a specific format. (recognized by iDocument).
  *     &lt;br&gt; The string is the one which appears in the &quot;Format&quot; combo of the panel
  *        File/Save or File/SaveAs.
  * @param SavePointedIfNecessary
  *      TRUE : default value, to save all documents referred by iDocument if they 
  *             have been modified during the session.
  *       &lt;br&gt; FALSE: only iDocument will be saved.
  */
  static HRESULT  SaveAs ( CATDocument&amp; iDocument,const CATUnicodeString&amp; iStorageName,const CATUnicodeString&amp; iFormat=&quot;&quot;, CATBoolean iSavePointedIfNecessary = TRUE);

  /** @nodoc */
  static HRESULT  SaveAs ( CATDocument&amp; iDocument, CATIDocId *iDocId );

  /**
  * Removes a document.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method closes the document in the session.  
  * &lt;br&gt;&lt;b&gt;Caution&lt;/b&gt;This method is without effect if the document has been previously
  * locked. If you have locked your document, a call to this method is not necessary, the last
  * unlock closes it. 
  * &lt;br&gt;Read information at the top of the page about the life cycle of the document.  
  * @param iDoc
  *       The document to remove.
  * @param iEmptyClipbordIfNecessary
  *       TRUE : will remove all the links from clipboard to iDoc.
  */
  static HRESULT  Remove ( CATDocument&amp; iDoc, short iEmptyClipbordIfNecessary=TRUE);

  /**
  * Creates documents from an existing file.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method allows you to create, in the current session, a new document 
  * from an existing one. But if the original document is already opened in session, no new 
  * document is generated.
  * &lt;br&gt;The method processes separately each document. But if an error occurs during the process of
  * one document the method is stopped and returns the error code about the last processing. So the 
  * output list of new document can be shorter than the input list of storage name. 
  * @param iListOfStorageName
  *        The list of complete access file names.
  * @param oListOfDocuments
  *        The list of new documents.
  *        &lt;br&gt;The length of this output list is equal to correct processed document. 
  * @param iIndividualNewFrom
  *        Useless
  * @return 
  *     The result of the last processed storage name:
  *     &lt;ul&gt;
  *     &lt;li&gt;S_OK: All documents are created. The lenght of iListOfStorageName is equal to
  *                   oListOfDocument &lt;/li&gt;
  *	&lt;li&gt;S_FALSE : The last processed document was already loaded. The lenght of oListOfDocument
  *                    is equal to correct document previously processed.&lt;/li&gt;
  *	&lt;li&gt;E_FAIL :  An error is occured during the last document processed. The lenght of 
  *                  oListOfDocument is equal to correct document previously processed.&lt;/li&gt;
  *     &lt;/ul&gt;
  */
  static HRESULT  NewFrom ( CATLISTV(CATUnicodeString)* iListOfStorageName, CATLISTP(CATDocument)* oListOfDocuments, short iIndividualNewFrom=TRUE);


  /**
  * Creates documents from existing files.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method allows you to create, in the current session, new documents 
  * from existing ones. The links between the original documents are reported accordingly
  * between the new documents. 
  * &lt;br&gt;If an error occurs during the process of one document or if one the original documents 
  * is already opened in session, a NULL pointer is put in oListOfDocuments and the method 
  * continues and returns the corresponding error code. So the output list of new documents has 
  * the same length as the input list of storage names. 
  * @param oListOfDocuments
  *        The list of new documents.
  *        &lt;br&gt;The length of this output list is equal to the length of the input list but it can contain
  * NULL pointers if the method has failed for one of the input paths.
  * @param iListOfPaths
  *        The list of complete access file names.
  * @param iListOfNewFileNames
  *        The list of the new file names (optional).
  *		   &lt;br&gt;NULL : default value, new names will be computed automatically for the new documents.
  * @return 
  *     &lt;li&gt;S_OK: All documents are created. 
  *	&lt;li&gt;S_FALSE : One of the processed document was already loaded.&lt;/li&gt;
  *	&lt;li&gt;E_FAIL :  An error has occurred during for at least one of the documents.&lt;/li&gt;
  *     &lt;/ul&gt;
  */
  static HRESULT  NewFrom ( CATLISTP(CATDocument)* oListOfDocuments, const CATLISTV(CATUnicodeString)*&amp; iListOfPaths, const CATLISTV(CATUnicodeString)* iListOfNewFileNames=NULL);

  /**
  * Creates a new document from an existing one and saves it.
  * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;The new document is identical to the original except for its UUIDs. 
  * The original document, iDocument, remains unchanged.  
  * &lt;br&gt;The new document does not exist in the session,it is just created in a file. 
  * @param iDocument
  *        The original document from which the new document will be generated and saved 
  *        with different UUIDs.
  * @param iStorageName
  *        The name under which the new document will be saved.
  * @param iSaveRecursively 
  *        Not used.  FALSE by default.
  */
  static HRESULT  SaveAsNew ( CATDocument&amp; iDocument, const CATUnicodeString&amp; iStorageName, CATBoolean iSaveRecursively=FALSE);

  /**
  * Retrieves the last save version of a document by its identifier.
  * @param iDocId
  *        The identifier of the document.
  * @param oVersion
  *        The last save version of the document (this information is only accessible for documents created from V5R10 and after. 
  *        &lt;br&gt;(for example : &amp;lt Version &amp;gt 5/ &amp;lt Version &amp;gt &amp;lt Release &amp;gt 10/ &amp;lt Release&amp;gt &amp;lt ServicePack&amp;gt 1/&amp;lt ServicePack &amp;gt &amp;lt BuildDate &amp;gt mm-dd-yyyy.hh.mm/ &amp;lt BuildDate &amp;gt).
  * @return 
  *     &lt;li&gt;S_OK: The version has been correctly retrieved, 
  *	    &lt;li&gt;E_FAIL : The version could not be retrieved. &lt;/li&gt;
  *     &lt;/ul&gt;
  */
  static HRESULT GetDocumentLastSaveVersion ( CATIDocId* iDocId, CATUnicodeString&amp; oVersion);


/**
 * Retrieves the minimal version to open a document by its identifier.
 * @param iDocId
 *        The identifier of the document.
 * @param oVersion
 *        The minimal version needed to open the document (this information is only accessible for documents created from V5R8 and after). 
 *        &lt;br&gt;(for example : &amp;lt Version &amp;gt 5/ &amp;lt Version &amp;gt &amp;lt Release &amp;gt 10/ &amp;lt Release&amp;gt).
 * &lt;br&gt;Due to service pack compatibility, no service pack number is specified. 
 * &lt;br&gt;Document can be opened on any service pack of the oVersion version.
 * @return 
 *     &lt;li&gt;S_OK: The version has been correctly retrieved, 
 *     &lt;li&gt;E_FAIL : The version could not be retrieved. &lt;/li&gt;
 *     &lt;/ul&gt;
 */
 static HRESULT GetMinimalVersionToOpenDocument ( CATIDocId* iDocId, CATUnicodeString&amp; oVersion);


  /**
  * Check if a document has been saved with an educational licence.
  * @param iDocId
  *        The identifier of the document.
  * @param iEducational
  *     &lt;li&gt;0: This is a standard document. &lt;/li&gt;
  *	    &lt;li&gt;Otherwise : This document has been saved with an educational license. &lt;/li&gt;
  * @return 
  *     &lt;li&gt;S_OK: The check has been successfully done. 
  *	&lt;li&gt;E_INVALIDARG: Null input iDocId. &lt;/li&gt;
  *	&lt;li&gt;E_FAIL: Impossible to perform this check. &lt;/li&gt;
  *     &lt;/ul&gt;
  */
  static HRESULT HasDocumentEducationalFlag ( CATIDocId* iDocId, int&amp; iEducational);

};
#endif
</div>
    
    <div class="navigation">
        <div><a href="CATDocumentIntegrityServices.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATDocumentIntegrityServices.h</a></div>
        <div><a href="CATDocumentsInSession.html">‰∏ã‰∏ÄÈ°µ: CATDocumentsInSession.h ‚Üí</a></div>
    </div>
</body>
</html>