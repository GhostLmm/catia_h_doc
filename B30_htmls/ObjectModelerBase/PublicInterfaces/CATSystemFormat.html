<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ObjectModelerBase/PublicInterfaces/CATSystemFormat.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ObjectModelerBase/PublicInterfaces/CATSystemFormat.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATStreamArea.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATStreamArea.h</a></div>
        <div><a href="CP0CLIP.html">‰∏ã‰∏ÄÈ°µ: CP0CLIP.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">// COPYRIGHT DASSAULT SYSTEMES 2000
/** @CAA2Required */
//**********************************************************************
//* DON T DIRECTLY INCLUDE THIS HEADER IN YOUR APPLICATION CODE. IT IS *
//* REQUIRED TO BUILD CAA APPLICATIONS BUT IT MAY DISAPEAR AT ANY TIME *
//**********************************************************************

#ifndef CATSystemFormat_H
#define CATSystemFormat_H
////////////////////////////////////////////////////////////////////////////////////////
// Didier LARUEL
// 23/02/97
//
// Purpose: CATSystemFormat
//                             A System Format May provide system dependant means
//                             to encode or decode data for exchange beetween to process
//
//                             By default no communication is enabled
//
// Remark, Data Transfert are assynchronous, and may concern such data
// as Text, RTF, METAFILEPIC, GEOMETRICAL, ...,
// those data can either be provided by CATIA to CATIA, either
// comes from other application or goes to other application
// (e.g. Text, ...). Then the tranfer protocol used by the system
// should be stricly respected
//
// Remark to implementers:
// ======================
// Subject to change, because the implementation is system dependant
// the implementation of system format can be the same for a range of
// format, depending only the interfaces used onto the object.
//
// For derivation:
// if defining the format, it will be considered an ad hoc system format
// then the way the data are exchanged should be derivated. The file
// method has only to return 0 (not supported).
//
// Otherwise it will be allocated by the system as an application
// proprietary format, and the basic exchange is supposed to be a file
// one. It could be enhanced in the future to suppose a IStream Ole compatible one
// but this was not possible at the time the interface was defined...
//
////////////////////////////////////////////////////////////////////////////////////////

//forward to avoid compilation errors
//include a virer,
//des que les ressources necessaire seront definies par un include systeme ad hoc
#ifdef _WINDOWS_SOURCE
# include&lt;ole2.h&gt;
#else
struct FORMATETC;
typedef FORMATETC* LPFORMATETC;
struct STGMEDIUM;
typedef STGMEDIUM* LPSTGMEDIUM;
#endif

#include&lt;CATFormat.h&gt;
#include&lt;CP0CLIP.h&gt;

class ExportedByCP0CLIP CATSystemFormat
{
 public:
  //if needed,
  //used for inter-process communication
  //System dependant part, to reimplement either on windows or unix
  CATSystemFormat(CATFormat* for_fmt=NULL );
  virtual ~CATSystemFormat();

  virtual int ProvideTempoData(CATBaseUnknown_ptr, LPFORMATETC&amp; system_format, LPSTGMEDIUM&amp; system_medium);
  virtual int ReleaseTempoData(LPSTGMEDIUM provided_system_medium);
  virtual int ProvideTempoObject(LPFORMATETC system_format, LPSTGMEDIUM system_medium, CATBaseUnknown_ptr&amp; tempo_object);
  virtual int ReleaseTempoObject(CATBaseUnknown_ptr&amp; tempo_object);

  virtual LPFORMATETC  SystemFormat() const;

  void SetFormat(CATFormat* fmt);
  CATFormat* Format() const;

  //Default implementation allocate a new application system format
  void SetSystemFormat(LPFORMATETC system_format);

 protected:
  LPFORMATETC _system_format; // deleted at end

 private:
  CATFormat*  _fmt; // only a reference

};

#endif
</div>
    
    <div class="navigation">
        <div><a href="CATStreamArea.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATStreamArea.h</a></div>
        <div><a href="CP0CLIP.html">‰∏ã‰∏ÄÈ°µ: CP0CLIP.h ‚Üí</a></div>
    </div>
</body>
</html>