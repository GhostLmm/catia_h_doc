<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CATxPDMInterfaces/PublicInterfaces/CATxPDMFileServices.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>CATxPDMInterfaces/PublicInterfaces/CATxPDMFileServices.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATxPDMCompareServices.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATxPDMCompareServices.h</a></div>
        <div><a href="CATxPDMIdentificationServices.html">‰∏ã‰∏ÄÈ°µ: CATxPDMIdentificationServices.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">#ifndef CATxPDMFileServices_H
#define CATxPDMFileServices_H
//COPYRIGHT DASSAULT SYSTEMES 2003

/**
 * @CAA2Level L1
 * @CAA2Usage U1
 */

#include &quot;CATBaseUnknown.h&quot; 
#include &quot;CATListOfCATUnicodeString.h&quot; 
#include &quot;CATUnicodeString.h&quot; 
#include &quot;CATListOfCATIxPDMItem.h&quot; 
#include &quot;ExportedByCATxPDMInterfaces.h&quot;

class CATIxPDMItem_var;
class CATIxPDMSendToService_var;

/**
  * Class for PDM services working directly on files not necessary loaded in session.
  * &lt;b&gt;Role:&lt;/b&gt; Except the @href #CheckItemCompatibility method, all the methods of the class retrieve or create items. All the 
  *  methods do not load in session the files associated with the returned items. 
  * &lt;p&gt;Before using these methods in a batch, a @href CATSession must be created even no documents will be loaded. &lt;/p&gt;
  * &lt;p&gt;All the static methods of the class pre-requisites the PX1 license. &lt;/p&gt;
  * @see CATIxPDMItem
  */
class ExportedByCATxPDMInterfaces CATxPDMFileServices
{
 public:
    /**
    * Retrieves an item from a file path.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method creates,or retrieves in session, an item 
    * from a file path. This method does not load the file in session.
    * 
    * @param iInputFilePath
    *   The path of the input file 
    * @param oPDMItem
    *   The returned item. 
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: method successful, &lt;tt&gt;oPDMItem&lt;/tt&gt; is correctly returned. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1113:&lt;/tt&gt;&lt;/li&gt;
    *       &lt;tt&gt;iInputFilePath &lt;/tt&gt; not found on disk.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    *
    */
    static HRESULT GetItemFromFile(const CATUnicodeString&amp; iInputFilePath,CATIxPDMItem_var &amp; oPDMItem);

    /**
    * Compatibility status between two items.
    * @param FullCompatible
    *        The two items are fully compatible.
    * @param CompatibleExeptFileName
    *        The two items are compatible except file name. Rename one file on your disk to be &lt;tt&gt;FullCompatible&lt;/tt&gt;
    * @param NotCompatible
    *        The two items are not compatible.
    * @see CATxPDMFileServices#CheckItemCompatibility
    */
   enum ItemCompatibility {FullCompatible, CompatibleExeptFileName, NotCompatible};

    /**
    * Checks that two items are compatible.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method checks that two items are compatible.
    * This check is the mandatory condition to replace the first item by the second one.
    * &lt;p&gt;Notice that this test is not enough to insure that links put on first item will
    * solve on second item, but this is the minimum condition (it does not insure that pointed
    * geometry is available in document for example). &lt;/p&gt;
    * &lt;p&gt;This method does not require that the two files associated with the items are loaded in session. &lt;/p&gt;
    * @param iFirstItem
    *   The first item to compare.
    * @param iSecondItem
    *   The second item to compare.
    * @param oCompatibility
    *   The result of comparison.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The comparison is successfully done &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1002:&lt;/tt&gt;&lt;/li&gt;
    *       One input item is invalid.    
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT CheckItemCompatibility(CATIxPDMItem_var &amp; iFirstItem,CATIxPDMItem_var &amp; iSecondItem,ItemCompatibility&amp; oCompatibility);


    /**
    * Searches root items in a list of directories.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method scans all files in the input directories to find which one
    * are root files. Root file means not pointed by another file contained into a directory of the input list.
    * &lt;p&gt;For example, a file A1 in directory A is pointed by another file B1 in directory B. If you call
    * this method with directory A and B, only B1 will be returned as root. &lt;/p&gt;
    *  &lt;p&gt;The item associated with a root file is
    * either created or retrieved in session, and added in the output list. &lt;/p&gt;
    * @param iListOfDirectory
    *   The list of directories to scan. Each element of the list must be the absolute path of a directory. 
    *   Like C:\tmp\MyDir(Windows) or
    *   /home/temp/MyDir (Unix).
    * @param iScanRecursively
    *   If &lt;tt&gt;TRUE&lt;/tt&gt;, sub-directoryies will be scanned also.
    * @param oListOfRootItem
    *   The list of root items.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The root list is successfully computed. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1008:&lt;/tt&gt;&lt;/li&gt;
    *       The input directory list is empty.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1112:&lt;/tt&gt;&lt;/li&gt;
    *       Impossible to open a directory. The directory path name available in error message.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1113:&lt;/tt&gt;&lt;/li&gt;
    *       A file could not be read ( no read access right for example ). The file name available in error message. 
    *      &lt;li&gt;&lt;tt&gt;InputERR_1122:&lt;/tt&gt;&lt;/li&gt;
    *       Some files are involved in a cycle, no roots can be found for those files. In this case, this method return
    *       E_FAIL with list of file involved in cycle in error message but other roots are (without cycle) are computed
    *       and returned normally in oListOfRootItem.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT SearchRootItems(const CATListOfCATUnicodeString&amp; iListOfDirectory,const CATBoolean iScanRecursively,
         CATListValCATIxPDMItem_var&amp; oListOfRootItem);

    /**
    * Searches list of pointed items.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method allows identify  recursively all pointed items
    * by a given root item. The result is divided into two lists:
    *  &lt;ul&gt;
    *    &lt;li&gt;The &lt;b&gt;existing&lt;/b&gt; pointed items&lt;/li&gt;
    *    &lt;p&gt;It is the list of items whose the associated file exists on the disk. 
    *        The root item itself is included into this list.&lt;/p&gt;
    *    &lt;li&gt;The &lt;b&gt;missing&lt;/b&gt; pointed items&lt;/li&gt;
    *    &lt;p&gt;It is the list of items whose the associated file does not exist on the disk. 
    *   &lt;/ul&gt;
    * &lt;p&gt;The concatenation of these two lists is the same list as those computed by the Send To services. In other words it 
    *  is the &lt;b&gt;consistent set of files&lt;/b&gt; for a file. This is
    * the mandatory files list to insure that all links will be resolved.  &lt;/p&gt;
    * &lt;p&gt;Links between items are resolved with current activated locators. It means that result of
    * this method will be greatly impacted by your current locator settings (See Tools/Options/General, Documents Tab). &lt;/p&gt;
    * 
    * @param iRootItem
    *   The root item to compute the consistent set of files from.
    * @param oListOfExistingPointedItem
    *   The list of existing  pointed items.
    *   An existing item has a file found on disk
    *   using current locators (Relative Folder, Other Folders...).
    *   There is no garanty on this list order, it could be change at any time.
    *   &lt;tt&gt;iRootItem&lt;/tt&gt; is always in this list.
    * @param oListOfMissingPointedItem
    *   The list of missing pointed items. A missing item has a file not found on disk
    *   using current locators (Relative Folder, Other Folders...).
    *   There is no garanty on this list order, it could be change at any time.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The consistent set of items is successfully computed. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1006:&lt;/tt&gt;&lt;/li&gt;
    *       Error during the process.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1119:&lt;/tt&gt;&lt;/li&gt;
    *       An item is loaded and modified in session, it should be saved before. Item name (the 
    *       @href CATIxPDMItem#GetDocFileName string ) is available in message. 
    *              
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT GetConsistentSetOfItems(const CATIxPDMItem_var &amp; iRootItem, 
                                           CATListValCATIxPDMItem_var&amp; oListOfExistingPointedItem,
                                           CATListValCATIxPDMItem_var&amp; oListOfMissingPointedItem);

    /**
    * Searches list of pointed items in a specific list of directories.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method allows identify  recursively all pointed items
    * by a given root item. The result is divided into two lists:
    *  &lt;ul&gt;
    *    &lt;li&gt;The &lt;b&gt;existing&lt;/b&gt; pointed items&lt;/li&gt;
    *    &lt;p&gt;It is the list of items whose the associated file exists on the disk. 
    *        The root item itself is included into this list.&lt;/p&gt;
    *    &lt;li&gt;The &lt;b&gt;missing&lt;/b&gt; pointed items&lt;/li&gt;
    *    &lt;p&gt;It is the list of items whose the associated file does not exist on the disk. 
    *   &lt;/ul&gt;
    * &lt;p&gt;The concatenation of these two lists is the same list as those computed by the Send To services. In other words it 
    *  is the &lt;b&gt;consistent set of files&lt;/b&gt; for a file. This is
    * the mandatory files list to insure that all links will be resolved.  &lt;/p&gt;
    * &lt;p&gt;Links between items are resolved inside list of directories provided as input. &lt;/p&gt;
    * 
    * @param iRootItem
    *   The root item to compute the consistent set of files from.
    * @param iListOfDirectory
    *   The list of directories to scan. Each element of the list must be the absolute path of a directory. 
    *   Like C:\tmp\MyDir(Windows) or /home/temp/MyDir (Unix).
    * @param iScanRecursively
    *   If &lt;tt&gt;TRUE&lt;/tt&gt;, sub-directoryies will be scanned also.
    * @param oListOfExistingPointedItem
    *   The list of existing  pointed items.
    *   An existing item has a file found on disk
    *   using current locators (Relative Folder, Other Folders...).
    *   There is no garanty on this list order, it could be change at any time.
    *   &lt;tt&gt;iRootItem&lt;/tt&gt; is always in this list.
    * @param oListOfMissingPointedItem
    *   The list of missing pointed items. A missing item has a file not found on disk
    *   using current locators (Relative Folder, Other Folders...).
    *   There is no garanty on this list order, it could be change at any time.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The consistent set of items is successfully computed. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1006:&lt;/tt&gt;&lt;/li&gt;
    *       Error during the process.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1112:&lt;/tt&gt;&lt;/li&gt;
    *       Impossible to open a directory. The directory path name available in error message.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1119:&lt;/tt&gt;&lt;/li&gt;
    *       An item is loaded and modified in session, it should be saved before. Item name (the 
    *       @href CATIxPDMItem#GetDocFileName string ) is available in message. 
    *              
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT GetConsistentSetOfItemsFromDirectory(const CATIxPDMItem_var &amp; iRootItem, 
       const CATListOfCATUnicodeString iListOfDirectory,
       const CATBoolean iScanRecursively,
       CATListValCATIxPDMItem_var&amp; oListOfExistingPointedItem,
       CATListValCATIxPDMItem_var&amp; oListOfMissingPointedItem);

    /**
    * Searches list of impacted Drawings.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method retrieves CATDrawings impacted by one item.
    * &lt;p&gt;Drawings are searched inside list of directories provided as input. &lt;/p&gt;
    * &lt;p&gt;If some CATDrawing are still loaded and modified in session, API will fail because it will not be able
    *    to check its links correctly. &lt;/p&gt;
    * 
    * @param iRootItem
    *   The root item to compute the consistent set of files from. This item should be a CATPart or a CATProduct.
    * @param iListOfDirectory
    *   The list of directories to scan. Each element of the list must be the absolute path of a directory. 
    *   Like C:\tmp\MyDir(Windows) or /home/temp/MyDir (Unix).
    * @param iScanRecursively
    *   If &lt;tt&gt;TRUE&lt;/tt&gt;, sub-directoryies will be scanned also.
    * @param oListOfImpactedDrawingsItem
    *   The list of impacted CATDrawing by iRootItem.
    *   There is no garanty on this list order, it could be change at any time.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The list has been successfully computed (it could be empty). &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1006:&lt;/tt&gt;&lt;/li&gt;
    *       Error during the process.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1112:&lt;/tt&gt;&lt;/li&gt;
    *       Impossible to open a directory. The directory path name available in error message.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1132:&lt;/tt&gt;&lt;/li&gt;
    *       A CATDrawing is still opened and modified in session, CATDrawing name available in error message.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT GetImpactedDrawingsFromDirectory(const CATIxPDMItem_var &amp; iRootItem, 
       const CATListOfCATUnicodeString&amp; iListOfDirectory,
       const CATBoolean iScanRecursively,
       CATListValCATIxPDMItem_var&amp; oListOfImpactedDrawingsItem);

    /**
    * Creates a Send To service pointer.
    * @param iTargetDirectory
    *   The destination directory where the sent files will be copied.
    *   The target directory must already exist on disk.
    * @param iKeepDirectory
    *   The option to control the tree structure creation in the target directory. 
    *   &lt;ul&gt;&lt;li&gt;&lt;tt&gt;iKeepDirectory=1:&lt;/tt&gt; to preserve the relative tree structure of the files.
    *       This option will be effective only if there is a common root directory for all files.&lt;/li&gt;
    *       &lt;li&gt;&lt;tt&gt;iKeepDirectory=0:&lt;/tt&gt; this is the default value. The files are directly copied in the destination directory. 
    *   &lt;/ul&gt;
    * @param iReportFile
    *   Localization of the report file. If the null string value (&quot;&quot;) is used, no report is done. Null string is the default value.
    * @param oSendToServices
    *   The pointer to a new instance of Send To service.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: if Send To service is successfully created. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_2000:&lt;/tt&gt;&lt;/li&gt;
    *       Invalid Input.
   *       &lt;li&gt;&lt;tt&gt;InputERR_2001:&lt;/tt&gt;&lt;/li&gt;
    *       The target directory doesn&#x27;t exist.
    *      &lt;li&gt;&lt;tt&gt;InputERR_2003:&lt;/tt&gt;&lt;/li&gt;
    *       The report file path does not exist.
    *   &lt;/ul&gt;
    */

    static HRESULT CreateSendToService(CATIxPDMSendToService_var &amp;oSendToServices,
                                       const CATUnicodeString &amp;iTargetDirectory, 
                                       const CATBoolean iKeepDirectory = CATFalse, 
                                       const CATUnicodeString &amp;iReportFile = CATUnicodeString(&quot;&quot;));
};
#endif

</div>
    
    <div class="navigation">
        <div><a href="CATxPDMCompareServices.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATxPDMCompareServices.h</a></div>
        <div><a href="CATxPDMIdentificationServices.html">‰∏ã‰∏ÄÈ°µ: CATxPDMIdentificationServices.h ‚Üí</a></div>
    </div>
</body>
</html>