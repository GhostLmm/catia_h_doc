<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CATxPDMInterfaces/PublicInterfaces/CATIxPDMSendToService.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>CATxPDMInterfaces/PublicInterfaces/CATIxPDMSendToService.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATIxPDMProductItem.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIxPDMProductItem.h</a></div>
        <div><a href="CATIxPDMSession.html">‰∏ã‰∏ÄÈ°µ: CATIxPDMSession.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">// COPYRIGHT Dassault Systemes 2005
//===================================================================
//
// CATIxPDMSendToService.h
// Define the CATIxPDMSendToService interface
//
//===================================================================
//
// Usage notes:
//   The usage of this interface requires the installation of CATIA - PPR xPDM Gateway 1 Product (PX1)
//   or the installation of the CATIA-SmarTeam plugin.
//   In case one of these products is not granted any method of the interface should fail.
//   This interface can be accessed using the @href #CATxPDMFileServices#CreateSendToService .
//
//===================================================================
//  Apr 2005  Creation: Code generated by the CAA wizard  FAR
//===================================================================
#ifndef CATIxPDMSendToService_H
#define CATIxPDMSendToService_H

/**
 * @CAA2Level L1
 * @CAA2Usage U3
 */

#include &quot;CATBaseUnknown.h&quot;
#include &quot;CATIxPDMItem.h&quot;
#include &quot;CATListOfCATIxPDMItem.h&quot; 
#include &quot;ExportedByCATxPDMInterfaces.h&quot;
#include &quot;CATUnicodeString.h&quot;
#include &quot;CATListOfInt.h&quot;

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATxPDMInterfaces IID IID_CATIxPDMSendToService;
#else
extern &quot;C&quot; const IID IID_CATIxPDMSendToService ;
#endif

//------------------------------------------------------------------

/**
 * Interface to manage the Send To functionality.
 * &lt;b&gt;Role&lt;/b&gt;:
 * This interface must be used to copy any CATIA V5 file document to a directory as soon as the document is linked to others.
 * The Send to functionality automatically reroutes the internal link in order to get in the target directory
 * a consistency set of linked documents. The target directory is those given as argument of the 
 * @href CATxPDMFileServices#CreateSendToService method.
 * 
 * &lt;p&gt;Functionalities are offered to rename, add or remove files to be send to a target directory.
 * Using the @href #Simulate method, you can predict the result of the @href #Run method which executes the resulting Send to operation.&lt;/p&gt;
 * &lt;p&gt;The usage of this interface requires the installation of CATIA - PPR xPDM Gateway 1 Product (PX1)
 * or the installation of the CATIA-SmarTeam plugin.
 * In case one of these products is not granted any method of the interface fails.&lt;/p&gt;
 * It is required to not modify and save the documents in session between 2 consecutive calls to the @href #Add method and the
 * @href #Simulate or @href CATIxPDMSendToService#Run methods. This could leads to inconsitent result because of links modifications.
 * &lt;p&gt;An interface pointer is accessible using the @href CATxPDMFileServices#CreateSendToService method.
 * &lt;/p&gt;
 * @see CATIxPDMItem
*/
class ExportedByCATxPDMInterfaces CATIxPDMSendToService: public CATBaseUnknown
{
  CATDeclareInterface;

  public:

    /**
     * Adds a file to the list of the files to be copied. 
     * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;&lt;/br&gt; Verifies that the given input file is valid (exists on disk and is not a directory),
     * and recursively adds the pointed documents of the added file.   
     *   @param iInputItem
     *     The item to add. It can be retrieved from @href CATxPDMFileServices#GetItemFromFile service.
     *   @return
     *  &lt;ul&gt;
     *  &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt; : item is well added to the list of to be copied files. &lt;/li&gt;
     *  &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
     *  &lt;ul&gt;
     *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
     *       The PX1 license is not available.
     *      &lt;li&gt;&lt;tt&gt;InputERR_2004:&lt;/tt&gt;&lt;/li&gt;
     *       Item already in List.
     *      &lt;li&gt;&lt;tt&gt;InputERR_2005:&lt;/tt&gt;&lt;/li&gt;
     *       Invalid input item.
     *      &lt;li&gt;&lt;tt&gt;InputERR_2006:&lt;/tt&gt;&lt;/li&gt;
     *       The input item has no read permission.
     *  &lt;/ul&gt;
     *  &lt;/ul&gt;
     */
  virtual HRESULT Add(CATIxPDMItem_var &amp; iInputItem) = 0;
 
   /**
    *nodoc
    */
  virtual HRESULT AddFromDirectory(CATIxPDMItem_var &amp; iInputItem,const CATListOfCATUnicodeString iListOfDirectory,const CATBoolean iScanRecursively) = 0;
  
  /**
     * Removes a file from the list of files to be copied.   
     *   @param iInputItem
     *     The item to remove from the list of file to be copied.
     *     It can be retrieved from @href CATxPDMFileServices#GetItemFromFile service.
     *   @return
     *  &lt;ul&gt;
     *  &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt; : if item is well removed from the list of to be copied files. &lt;/li&gt;
     *  &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
     *  &lt;ul&gt;
     *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
     *       The PX1 license is not available.
     *      &lt;li&gt;&lt;tt&gt;InputERR_2005:&lt;/tt&gt;&lt;/li&gt;
     *       Invalid input item.
     *      &lt;li&gt;&lt;tt&gt;InputERR_2007:&lt;/tt&gt;&lt;/li&gt;
     *       Item not in the list. 
     *      &lt;li&gt;&lt;tt&gt;InputERR_2014:&lt;/tt&gt;&lt;/li&gt;
     *       Item already removed.
     *  &lt;/ul&gt;
     *  &lt;/ul&gt;
     */
  virtual HRESULT Remove(CATIxPDMItem_var &amp; iInputItem) = 0;
 
    /**
     * Renames one file to be copied. The new name may not have invalid characters.   
     *   @param iInputItem
     *     The item to rename.
     *   @param iNewName
     *     New file identifier of the item (file name without extension).
     *   @return
     *  &lt;ul&gt;
     *  &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt; : item is well renamed. &lt;/li&gt;
     *  &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
     *  &lt;ul&gt;
     *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
     *       The PX1 license is not available.
     *      &lt;li&gt;&lt;tt&gt;InputERR_2005:&lt;/tt&gt;&lt;/li&gt;
     *       The Invalid input item.
     *      &lt;li&gt;&lt;tt&gt;InputERR_2007:&lt;/tt&gt;&lt;/li&gt;
     *       Item not in the list. 
     *      &lt;li&gt;&lt;tt&gt;InputERR_2008:&lt;/tt&gt;&lt;/li&gt;
     *       Invalid file identifier.  
     *      &lt;li&gt;&lt;tt&gt;InputERR_2011:&lt;/tt&gt;&lt;/li&gt;
     *       Input new name /P1 already used in the list.
     *      &lt;li&gt;&lt;tt&gt;InputERR_2013:&lt;/tt&gt;&lt;/li&gt;
     *       Item to rename has been removed from list.
     *  &lt;/ul&gt;
     *  &lt;/ul&gt;
     */
  virtual HRESULT Rename(CATIxPDMItem_var &amp; iInputItem,CATUnicodeString&amp; iNewName) = 0;
 
    /**
     * Executes the Send To action.   
     *   @param oListOutputItems
     *     List of all the final items in the targetted directory.
     *     The targetted directory is the iTargetDirectory input parameter of the @href CATxPDMFileServices#CreateSendToService service.
     *   @return
     *  &lt;ul&gt;
     *  &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt; : Send to successfully done. &lt;/li&gt;
     *  &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
     *  &lt;ul&gt;
     *      &lt;li&gt;&lt;tt&gt;InputERR_1119:&lt;/tt&gt;&lt;/li&gt;
     *       An item is loaded and modified in session, it should be saved before. (The NLS message includes the name of this wrong document).
     *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
     *       The PX1 license is not available.
     *      &lt;li&gt;&lt;tt&gt;InputERR_2009:&lt;/tt&gt;&lt;/li&gt;
     *       No data to Send To. At least 1 item has to be added.
     *      &lt;li&gt;&lt;tt&gt;InputERR_2010:&lt;/tt&gt;&lt;/li&gt;
     *       Internal error.
     *      &lt;li&gt;&lt;tt&gt;InputERR_2012:&lt;/tt&gt;&lt;/li&gt;
     *       2 different documents to copy have the same final identification. 
     *       (The NLS message includes the name of this wrong document)
     *      &lt;li&gt;&lt;tt&gt;InputERR_2015:&lt;/tt&gt;&lt;/li&gt;
     *       No data to Send To. All items have been removed.
	 *      &lt;li&gt;&lt;tt&gt;InputERR_2017:&lt;/tt&gt;&lt;/li&gt;
     *       Some of the items being Send To, pointing to PDM document. SendTo cannot be performed.
     *  &lt;/ul&gt;
     *  &lt;/ul&gt;
     */
  virtual HRESULT Run(CATListValCATIxPDMItem_var  &amp;oListOutputItems) = 0;
 
    /**
     * Simulates the Send To operation.
     * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;&lt;/br&gt; gives for each item included in the initial set of
     * documents its status and its final localization. 
     * In case of a not null status, the corresponding output Items are set to NULL_var.
     * 
     *   @param oStatusListOK
     *     For each item to be copied, targeted status.
     *     The status can be:
     *     &lt;ul&gt;
     *      &lt;li&gt;&lt;tt&gt; 0&lt;/tt&gt;: The Item will be theorically successfully sent to. &lt;/li&gt;
     *      &lt;li&gt;&lt;tt&gt;-1&lt;/tt&gt;: The Item will not be copied because it has been removed from the list of files to Send To.&lt;/li&gt;
     *      &lt;li&gt;&lt;tt&gt; 1&lt;/tt&gt;: The Item will not be copied because the item is missing. This is a pointed document not retrieved on disk.&lt;/li&gt;
     *      &lt;li&gt;&lt;tt&gt; 2&lt;/tt&gt;: The Item will not be copied because the final item name is already used.&lt;/li&gt;
     *      &lt;li&gt;&lt;tt&gt; 3&lt;/tt&gt;: The Item will not be copied because it is modified in session.&lt;/li&gt;
     *     &lt;/ul&gt;  
     *   @param oListInputItems
     *     List of all the input items
     *   @param oListOutputItems
     *     List of all the final items. 
     *     Note that because this is only a simulation, the real final files are not generated. Dummy objects are computed.
     *     They implement only the @href CATIxPDMItem#GetDocFileName method of the @href CATIxPDMItem interface.
     *   @return
     *  &lt;ul&gt;
     *  &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt; : Send To simulation successfully done. &lt;/li&gt;
     *  &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
     *  &lt;ul&gt;
     *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
     *       The PX1 license is not available.
     *      &lt;li&gt;&lt;tt&gt;InputERR_1119:&lt;/tt&gt;&lt;/li&gt;
     *       An item is loaded and modified in session, it should be saved before. (The NLS message includes the name of this wrong document).
     *      &lt;li&gt;&lt;tt&gt;InputERR_2009:&lt;/tt&gt;&lt;/li&gt;
     *       No data to Send To. At least 1 item has to be added.
     *      &lt;li&gt;&lt;tt&gt;InputERR_2010:&lt;/tt&gt;&lt;/li&gt;
     *       Internal error.
     *      &lt;li&gt;&lt;tt&gt;InputERR_2012:&lt;/tt&gt;&lt;/li&gt;
     *       2 different documents to copy have the same final identification. 
     *       (The NLS message includes the name of this wrong document)
     *      &lt;li&gt;&lt;tt&gt;InputERR_2015:&lt;/tt&gt;&lt;/li&gt;
     *       No data to Send To. All items have been removed.
	 *      &lt;li&gt;&lt;tt&gt;InputERR_2017:&lt;/tt&gt;&lt;/li&gt;
     *       Some of the items being Send To, pointing to PDM document. SendTo cannot be performed.
     *  &lt;/ul&gt;
     *  &lt;/ul&gt;  
     */
  virtual HRESULT Simulate(CATListOfInt &amp;oStatusListOK, 
                           CATListValCATIxPDMItem_var  &amp;oListInputItems, 
                           CATListValCATIxPDMItem_var  &amp;oListOutputItems) = 0;
 

  // No constructors or destructors on this pure virtual base class
  // --------------------------------------------------------------
};

CATDeclareHandler(CATIxPDMSendToService, CATBaseUnknown);


//------------------------------------------------------------------

#endif
</div>
    
    <div class="navigation">
        <div><a href="CATIxPDMProductItem.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIxPDMProductItem.h</a></div>
        <div><a href="CATIxPDMSession.html">‰∏ã‰∏ÄÈ°µ: CATIxPDMSession.h ‚Üí</a></div>
    </div>
</body>
</html>