<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CATxPDMInterfaces/PublicInterfaces/CATxPDMSessionServices.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>CATxPDMInterfaces/PublicInterfaces/CATxPDMSessionServices.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATxPDMProductServices.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATxPDMProductServices.h</a></div>
        <div><a href="CATxPDMSessionUIServices.html">‰∏ã‰∏ÄÈ°µ: CATxPDMSessionUIServices.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">#ifndef CATxPDMSessionServices_H
#define CATxPDMSessionServices_H
//COPYRIGHT DASSAULT SYSTEMES 2004

/**
 * @CAA2Level L1
 * @CAA2Usage U1
 */

#include &quot;CATBaseUnknown.h&quot; 
#include &quot;ExportedByCATxPDMInterfaces.h&quot;
#include &quot;CATListOfCATUnicodeString.h&quot; 
#include &quot;CATListOfCATString.h&quot; 
#include &quot;CATListOfCATIxPDMItem.h&quot; 

class CATIxPDMItem_var;
class CATDocument;
class CATIReporter;

/**
* Class for PDM services working on items loaded in session. 
* &lt;b&gt;Role&lt;/b&gt;: This class is used for external File PDM system integration.
* &lt;p&gt;All the methods pre-requisites the PX1 license &lt;/p&gt;
* @see CATIxPDMItem , CATIxPDMSession
*/
class ExportedByCATxPDMInterfaces CATxPDMSessionServices
{
 public:
    /**
    * Retrieves an item from a document loaded in session.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method retrieves a handler to a @href CATIxPDMItem interface
    * from a @href CATDocument.
    * 
    * @param iInputDocument
    *   The document loaded in session
    * @param oPDMItem
    *   The returned item
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The item is successfully returned. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1002:&lt;/tt&gt;&lt;/li&gt;
    *       The input document is NULL.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT GetItemFromDocument(const CATDocument* iInputDocument,CATIxPDMItem_var &amp; oPDMItem);

    /**
    * Retrieves an item from a feature loaded in session.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method retrieves a handler to a @href CATIxPDMItem interface
    * from a feature (&#x27;CATISpecObject&#x27;).
    * 
    * @param iInputFeature
    *   The feature loaded in session
    * @param oPDMItem
    *   The returned item
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The item is successfully returned. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1002:&lt;/tt&gt;&lt;/li&gt;
    *       The input feature is NULL.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT GetItemFromFeature(const CATBaseUnknown_var&amp; iInputFeature,CATIxPDMItem_var &amp; oPDMItem);

    /**
    * Loads an item in session.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method loads an item is session.
    * If item is already loaded in session, this method just returns a handler on already loaded item.
    * 
    * @param iItemToLoad
    *   The item to load.
    * @param oLoadedItem
    *   The loaded item. It can be same as &lt;tt&gt;iItemToLoad&lt;/tt&gt; if item was already loaded.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The item is successfully loaded. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;S_FALSE&lt;/tt&gt;: The item is already loaded. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *      The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1004:&lt;/tt&gt;&lt;/li&gt;
    *       Internal error.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1121:&lt;/tt&gt;&lt;/li&gt;
    *       The file associated with the item is not on the disk.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1123:&lt;/tt&gt;&lt;/li&gt;
    *      This non CATIA document can never be loaded&lt;/li&gt;
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT LoadItemInSession(const CATIxPDMItem_var&amp; iItemToLoad, CATIxPDMItem_var&amp; oLoadedItem);

    /**
    * Retrieves all items loaded in session.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method retrieves all items loaded in session.
    * This list is especially useful to rename items by the @href #SaveSessionToDirectory method.
    * 
    * @param oListOfLoadedItem
    *   The list of loaded items in session. This list will be NULL if no item is loaded in session.
    *   The caller has to delete the list.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The list is successfully returned. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT GetxPDMItemsInSession(CATListValCATIxPDMItem_var* &amp;oListOfLoadedItem);

    /**
    * Check rules necessary for PDM before Save.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method checks a customized list of rules necessary for PDM before Save.
    * The list to choose depends of what is allowed in targeted PDM. These rules work also on items  
	* coming from ENOVIA V5 (with the exception of rule READONLY_CONSISTENCY, which is specific to file items).
    * 
    * @param iListOfRulesToCheck
    *   List of string describing rules to check on all items in session.
    *   Authorized values are:
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;&quot;RESOLVED_IMPORT&quot;&lt;/tt&gt;: Check that all imports (geometry and parameters) are resolved.
    *     If you activate this check, this method will load pointed items to check the link. So number
    *     of items loaded in session could increase after this call.&lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;&quot;SYNCHRONIZED_IMPORT&quot;&lt;/tt&gt;: Check that all imports (geometry and parameters) are synchronized.
    *     If you activate this check, this method will load pointed items to check the link. So number
    *     of items loaded in session could increase after this call.&lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;&quot;NESTED_LEVEL=x&quot;&lt;/tt&gt;: Check number of levels of links. x is the maximum authorized value.
    *     If PartA imports geometry from PartB and PartB import parameter from PartC, there is 3 levels of links.
    *     If DrawingA has a link to ProductB and ProductB contains PartD, there is 3 levels of links.
    *     If you activate this check, this method will load pointed items to check the link. So number
    *     of items loaded in session could increase after this call.&lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;&quot;NESTED_IMPORT=x&quot;&lt;/tt&gt;: Check number of levels of import. x is the maximum authorized value.
    *     If PartA imports geometry from PartB and PartB import parameter from PartC, there is 3 levels of imports.
    *     This check is a restriction of NESTED_LEVEL to geometrical and knowledge links between CATPart and CATShape.
    *     If you activate this check, this method will load pointed items to check the link. So number
    *     of items loaded in session could increase after this call.&lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;&quot;CYCLES&quot;&lt;/tt&gt;: Check that there is no cycle between items. All kind of links are checked.
    *     Notice that &#x27;Context&#x27; link from CATPart to CATProduct is not considered as a cycle.
    *     If you activate this check, this method will load pointed items to check the link. So number
    *     of items loaded in session could increase after this call.&lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;&quot;ONLY_PUBLICATIONS&quot;&lt;/tt&gt;: Check that all imports are using publications.
    *     This check perform verification without loading pointed data.&lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;&quot;READONLY_CONSISTENCY&quot;&lt;/tt&gt;: Check that all Read Only and Read Write status of item loaded
    *     is consistent. Inconsistent status could lead to Product Structure desynchronization in case of Save
    *     (SYN_1 and SYN_2 errors in CATDUA).&lt;/li&gt; 
    *   &lt;/ul&gt;
    * @param oItemsWithError
    *   List of items with associated errors. Items can be duplicated in this list if there is several errors on one item.
    * @param oReporter
    *   List of errors. Use CATIReporter#GetListReporterInfo to retrieve all errors.
    *   Authorized values are:
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1301:&lt;/tt&gt;&lt;/li&gt;
    *       An import is not synchronized.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1302:&lt;/tt&gt;&lt;/li&gt;
    *       Impossible to find pointed object by an import.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1303:&lt;/tt&gt;&lt;/li&gt;
    *       Too many level of imports.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1304:&lt;/tt&gt;&lt;/li&gt;
    *       Too many level of links.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1305:&lt;/tt&gt;&lt;/li&gt;
    *       There is a cycle between items.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1306:&lt;/tt&gt;&lt;/li&gt;
    *       There is a import without publication.
    *  &lt;/ul&gt;
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The check runs successfully whithout any error. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;S_FALSE&lt;/tt&gt;: The check runs successfully and detects some errors, use oReporter to retrieve them. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The check fails with an internal error. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1004:&lt;/tt&gt;&lt;/li&gt;
    *       Internal error.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1251:&lt;/tt&gt;&lt;/li&gt;
    *       Requested rule is unknown.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1252:&lt;/tt&gt;&lt;/li&gt;
    *       No item loaded in session.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT CheckDesignRules(const CATListOfCATString&amp; iListOfRulesToCheck,
            CATListValCATIxPDMItem_var* &amp; oItemsWithError,
            CATIReporter* &amp; oReporter);

   /**
    * Saves a session to a specific directory.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method allows you save a session to a specific directory 
    * (in interactive or batch) while keeping links consistency between all documents if some are renamed. 
    *
    * &lt;p&gt;As soon as you work on several documents, you have to use this method instead of the
    *  &lt;tt&gt;SaveAs&lt;/tt&gt; method of the &lt;tt&gt;CATDocumentServices&lt;/tt&gt; class to keep link consistency
    *  especially when renaming documents.&lt;/p&gt;
    *
    * &lt;p&gt;Item is saved in the targeted directory only if:
    * &lt;ul&gt;
    *    &lt;li&gt;Item is loaded in session (see @href #GetxPDMItemsInSession )&lt;/li&gt;
    *    &lt;li&gt;Item has status New or Modified (see @href CATIxPDMItem#NeedToBeSaved )&lt;/li&gt;  
    *    &lt;li&gt;Item has been loaded from another location than the targeted directory &lt;/li&gt;
    *    &lt;li&gt;Item being renamed or impacted by a rename (renaming Item with the same name is not supported) &lt;/li&gt;
    * &lt;/ul&gt;
    *
    * &lt;p&gt;This method allows also to export data coming from ENOVIA V5 or ENOVIA VPM V4 to a File directory.
	*
	* &lt;p&gt;Item not processed by this method:
    * &lt;ul&gt;
    *    &lt;li&gt;cgr loaded in Session&lt;/li&gt;
    * &lt;/ul&gt;
    *
    * &lt;p&gt;This method performs a complete export if the targeted directory doesn&#x27;t contain any of 
    * documents in session. This means that all items will be saved in the targeted
    * directory even if they are not modified in session. 
    * &lt;p&gt;
    * &lt;b&gt;Notes&lt;/b&gt; 
    * &lt;ul&gt;
    *    &lt;li&gt;This method does not consider pointing/pointed documents that are not loaded in session. &lt;/li&gt;
    *    &lt;li&gt;if a Part is in Visualization mode in an assembly, it means that it is not loaded in session. 
    *        So Part will not be saved in the targeted directory.&lt;/li&gt;
    * &lt;/ul&gt;  
    * &lt;/p&gt;
    * 
    * @param iDirectoryPath
    *   The path where all session items will be saved.
    *   This path could be a directory path or a DLName.
    *   It must be accessible with write access.
    * @param oErrorMessage
    *   The detailled error message filled if result is &lt;tt&gt;E_FAIL&lt;/tt&gt; with the error &lt;tt&gt;InputERR_1108&lt;/tt&gt;.
    *   &lt;p&gt;For other errors, same content as message associaded to returned error.&lt;/p&gt;
    * @param iListItemToRename
    *   The list of items to rename. The list of new names is the &lt;tt&gt;iListOfNewNames&lt;/tt&gt;. The two lists must
    *   have the same size. 
    *   &lt;p&gt; If an item of the directory is not added in this list, the used default name will be the CATIA display name.&lt;/p&gt;
    *   &lt;p&gt;If items are not file based, but VPM or ENOVIA items, you must fill up &lt;tt&gt;iListItemToRename&lt;/tt&gt; and
    *     &lt;tt&gt;iListOfNewNames&lt;/tt&gt;. &lt;/p&gt;
    *&lt;/p&gt;
    * @param iListOfNewNames
    *   The list of new name for documents of &lt;tt&gt;iListItemToRename&lt;/tt&gt;. Name should be file name (no DBCS) with correct extension
    *   and without any path. For example &#x27;Part1.CATPart&#x27; or &#x27;Part1&#x27;. &#x27;C:\Part1.CATPart&#x27;, &#x27;Part\1&#x27; or &#x27;Part*.Part&#x27; are not supported.
    *   If there is no extension, it is automatically added.
    *   &lt;p&gt;The size of &lt;tt&gt;iListDocToRename&lt;/tt&gt; and &lt;tt&gt;iListOfNewNames&lt;/tt&gt; must be exactly the same.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: All items are successfully saved. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;S_FALSE&lt;/tt&gt;: Some items have not been saved (item modified by synchro and read only),
    *                         warning message available in oErrorMessage parameter. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1009:&lt;/tt&gt;&lt;/li&gt;
    *       List of documents to rename and list of new names must have the same size.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1106:&lt;/tt&gt;&lt;/li&gt;
    *       Invalid input directory.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1107:&lt;/tt&gt;&lt;/li&gt;
    *       Some documents cannot been saved, impossible to process.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1108:&lt;/tt&gt;&lt;/li&gt;
    *       Internal error, see oErrorMessage for more details.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1110:&lt;/tt&gt;&lt;/li&gt;
    *       Two documents with same display name exist in session. Duplicated name is available in error message.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1111:&lt;/tt&gt;&lt;/li&gt;
    *       Invalid file name, check that name does not contain specific characters and that extension is correct.
    *       Invalid name and item are available in error message.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1118:&lt;/tt&gt;&lt;/li&gt;
    *       One item of &lt;tt&gt;iListItemToRename&lt;/tt&gt; is not loaded. Item name is available in error message.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1201:&lt;/tt&gt;&lt;/li&gt;
    *		   File already exist, overwriten with different file is not allowed.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    *
    */
    static HRESULT SaveSessionToDirectory(const char* iDirectoryPath, CATUnicodeString&amp; oErrorMessage,
         CATListValCATIxPDMItem_var* iListItemToRename=NULL,CATListOfCATUnicodeString* iListOfNewNames=NULL);

    /**
    * Item information to refresh in session.
    * @param All
    *        All attributes will be refreshed, see next values for details.
    * @param ReadWrite
    *        Read/Write or Read/Only status will be recomputed from file information.
    *        ReadOnly status is read at item opening and kept during the session, a ReadOnly item cannot be saved
    *        so this information should be refreshed in session before saving if you modify file right access.
    * @param UnresolvedLinks
    *        To optimize performances, V5 try to resolved a link only once. So if pointed item is not found, link
    *        will keep broken status during all the session. If you add the necessary file on disk during session,
    *        refreshing this information will allow to solve link.
    *        &lt;br&gt; This method is equivalent to &#x27;Refresh&#x27; button in Edit/Links.
    *        &lt;br&gt; Notice that this call doesn&#x27;t refresh all applicative information so display status could still be
    *        wrong in some cases.
    * @see CATxPDMSessionServices#RefreshItemInformation
    */
   enum ItemRefresh {All, ReadWrite, UnresolvedLinks};

    /**
    * Refreshes some session information on a loaded item.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method refreshes session information like Read/Write status or Unresolved link status.
    * This method should be called when some information changes on file system to update V5 session.
    * &lt;br&gt;Notice that only a very limited set of modification directly on file are supported when
    * item is loaded in V5 session.
    * V5 is not a database and does not support concurrent engineering in a File Base environment.
    * 
    * @param iPDMItem
    *   The item to refresh from file system.
    * @param iToRefresh
    *   The kind of information to refresh.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The information is successfully refreshed. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1005:&lt;/tt&gt;&lt;/li&gt;
    *       The item is not loaded.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    *
    */
    static HRESULT RefreshItemInformation(CATIxPDMItem_var &amp; iPDMItem,ItemRefresh&amp; iToRefresh);

    /**
    * Sets an initial file name on an item.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method valuate the initial item name.
    * This method is available on item with &quot;New&quot; status, other items could be renamed only through CATxPDMSessionServices::SaveSessionToDirectory
    * 
    * @param iPDMItem
    *   The item to set .
    * @param iInitialFileName
    *   The initial file name to set on item.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The information is successfully refreshed. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1005:&lt;/tt&gt;&lt;/li&gt;
    *       The item is not loaded.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1013:&lt;/tt&gt;&lt;/li&gt;
    *       The item has already been saved.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    *
    */
    static HRESULT SetInitialDocFileName(CATIxPDMItem_var &amp; iPDMItem,const CATUnicodeString&amp; iInitialFileName);

    /**
    * Synchronizes external links of an item.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method retrieves all the external links of the
    * given document, and synchronizes them if they are loaded in session.
    * &lt;br&gt;Only activated links are synchronized.
    * &lt;p&gt;Notice that this API is equivalent to Synchronize button in Edit/Links panel.&lt;/p&gt; 
    * &lt;p&gt;Save is necessary after a synchronization.&lt;/p&gt; 
    * 
    * @param iPDMItem
    *   The item to synchonize its external links.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: All external links of the given item are successfully synchronized. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1002:&lt;/tt&gt;&lt;/li&gt;
    *       The input item pointer is NULL.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1003:&lt;/tt&gt;&lt;/li&gt;
    *       Error during the synchronisation of one specific link.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1004:&lt;/tt&gt;&lt;/li&gt;
    *       Internal error during the synchronisation process.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1005:&lt;/tt&gt;&lt;/li&gt;
    *       The pointed item is not loaded.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    *
    */
    static HRESULT SynchronizeAllExternalLinks(CATIxPDMItem_var &amp; iPDMItem);

    /**
    * Breaks external links of an item.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method retrieves all the external links of the
    * given document, and breaks them.
    * &lt;br&gt;Only few links can be broken (like geometrical or parameter imports).
    * &lt;p&gt;Notice that this API is equivalent to Isolate button in Edit/Links panel.&lt;/p&gt; 
    * &lt;p&gt;Save is necessary after a break.&lt;/p&gt; 
    * 
    * @param iPDMItem
    *   The item to break its external links.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: All external links of the given item are successfully broken. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;S_FALSE&lt;/tt&gt;: There is no more external links to break. &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1002:&lt;/tt&gt;&lt;/li&gt;
    *       The input item pointer is NULL.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1012:&lt;/tt&gt;&lt;/li&gt;
    *       Error during the break of one specific link.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1004:&lt;/tt&gt;&lt;/li&gt;
    *       Internal error during the break process.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    *
    */
    static HRESULT BreakAllExternalLinks(CATIxPDMItem_var &amp; iPDMItem);

    /**
    * Manages links activity of an item.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method retrieves all the external links of the
    * given document, and activates (or deactivates) them.
    * &lt;p&gt;Notice that only geometrical links support this activation notion. A deactivated link
    * means that geometrical modifications are no more propagated through this link. The link still exists
    *  and is still taken into account in SendTo, @href CATxPDMFileServices#GetConsistentSet or @href CATxPDMFileServices#SearchRootItems .&lt;/p&gt; 
    * &lt;p&gt;Notice that this API is equivalent to Activate/Deactivate buttons in Edit/Links panel.&lt;/p&gt; 
    * &lt;p&gt;Save is necessary after a link status modification.&lt;/p&gt; 
    * 
    * @param iPDMItem
    *   The item to activate/deactivate its external links.
    * @param iActivated
    *   The activation/deactivation status to set on links.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: All external links of the given item are successfully activated/deactivated. &lt;/li&gt;
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1002:&lt;/tt&gt;&lt;/li&gt;
    *       The input item pointer is NULL.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1004:&lt;/tt&gt;&lt;/li&gt;
    *       Internal error during the activation process.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1007:&lt;/tt&gt;&lt;/li&gt;
    *       Error during the activation process of one specific link.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    *
    */
    static HRESULT SetExternalLinksStatus(CATIxPDMItem_var &amp; iPDMItem,const CATBoolean iActivated);

    /**
    * Checks that two features are compatible.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method checks that two features are compatible.
    * If two features are compatible, a link put on the first feature will be able to 
    * solve on second feature if you replace first document by second one.
    *
    * @param iFirstFeature
    *   The first feature to compare.
    * @param iSecondFeature
    *   The second feature to compare.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: Features are compatible &lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: There are two raisons: &lt;/li&gt;
    *     &lt;ul&gt; 
    *       &lt;li&gt;The features are not compatible: no @href CATError class instance is generated. The static @href CATError#CATGetLastError 
    *       method returns &lt;tt&gt;NULL&lt;/tt&gt;&lt;/li&gt;
    *      &lt;li&gt;The method has failed. A @href CATError class instance is generated. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1002:&lt;/tt&gt;&lt;/li&gt;
    *       At least one input pointer is NULL.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT CheckFeatureCompatibility(CATBaseUnknown *iFirstFeature ,CATBaseUnknown *iSecondFeature ) ;
    
    /**
    * Retrieves publications from an instance not imported in a specific item.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method verifies that all objects published by an instance are 
    * imported in a specific item.
    * 
    * @param iItemWithImportedPublications
    *   Item where we check that all objects published by 
    *  &lt;tt&gt;iDocumentInstanceWithPublications&lt;/tt&gt; are imported.
    *   This item has always a CATPart type.
    * @param iDocumentInstanceWithPublications
    *    This is an instance of a Part in a Product (implementing CATIProduct interface).
    * @param oNonImportedPublications
    *    List of publications existing in &lt;tt&gt;iDocumentInstanceWithPublications&lt;/tt&gt; 
    *    and not imported in iDocumentToCheck. If all publications are imported, this list
    *    is empty and return is &lt;tt&gt;S_OK&lt;/tt&gt;.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: The list is successfully computed.&lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1002:&lt;/tt&gt;&lt;/li&gt;
    *       At least one input parameter is invalid.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT FindNonImportedPublications(const CATIxPDMItem_var &amp; iItemWithImportedPublications,
       CATBaseUnknown   *iDocumentInstanceWithPublications,
       CATListOfCATUnicodeString** oNonImportedPublications) ;

    /**
    * Retrieves if an object from an instance is imported in a specific item.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method verifies that an object in an instance context is 
    * imported in a specific item.The object can be a geometry, parameter or a publication.
    * 
    * @param iItemWithImport
    *   Item where we check that &lt;tt&gt;ipRefObject&lt;/tt&gt; in context of Product
    *  &lt;tt&gt;iDocumentInstance&lt;/tt&gt; is imported.
    *   This item has always a CATPart type.
    * @param ipRefObject
    *    Search object (geometry, parameter, publication).
    *    Use result of &lt;tt&gt;CATIPrdObjectPublisher::GetFinalObject&lt;/tt&gt; as imput for publications.
    * @param iDocumentInstance
    *    This is an instance of a Part in a Product (implementing CATIProduct interface).
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: Object is imported.&lt;/li&gt; 
    *   &lt;li&gt;&lt;tt&gt;S_FALSE&lt;/tt&gt;: Object is not imported.&lt;/li&gt; 
    *   &lt;li&gt;Search failed: &lt;b&gt;Returned errors &lt;/b&gt; (listed by their identifier) &lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1002:&lt;/tt&gt;&lt;/li&gt;
    *       One input pointer is NULL.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT IsImported (const CATIxPDMItem_var &amp; iItemWithImport,
       CATBaseUnknown* ipRefObject,
       CATBaseUnknown* iDocumentInstance) ;

   /**
    * Unloads an item from session.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method unloads an item from session.
    * &lt;p&gt;This unload method can be used only is specific cases
    *   &lt;ul&gt;
    *      &lt;li&gt;If you are in batch mode, only root items can be unloaded. It means that you can&#x27;t unload
    *      an item in a Product Structure, only root can be unloaded, Unloading root will automatically
    *      unload all pointed items.&lt;/li&gt;
    *      &lt;li&gt;In interactive mode, same rules apply. There is one specific rule: an item associated
    *      to an editor cannot be unloaded, you have to close the interactive editor to unload it.&lt;/li&gt;
    *  &lt;/ul&gt;
    * &lt;/p&gt;
    * &lt;p&gt;In short, this method can be used only to clean a session, not for selective unloading in a Product Structure.&lt;/p&gt;
    * @param iItemToUnLoad
    *   The item to unload from session.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: Item successfully unloaded. &lt;/li&gt; 
   *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1002:&lt;/tt&gt;&lt;/li&gt;
    *       Not available on non loaded item.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1004:&lt;/tt&gt;&lt;/li&gt;
    *       Internal error.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT UnLoadItemFromSession(const CATIxPDMItem_var&amp; iItemToUnLoad);

   /**
    * Check contents of item to verify if CATDUA will improve link status.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method verifies if some CATDUA rules about links (a sub-set of CATDUA rules) are detected
    * in the selected item. Only check is performed, no correction, no modification, this is the CATDUA jobs.
    * &lt;p&gt;If some rules are detected, it means that after CATDUA links status will be different. Some links will
    * potentially disappears and ConsistentSet could be very different.&lt;/p&gt;
    * @param iItemToCheck
    *   The item to check.
    * @param iNeedToLaunchCATDUA
    *   TRUE if CATDUA can be launch to improve links status, FALSE otherwise.
    * @return
    *   &lt;ul&gt;
    *   &lt;li&gt;&lt;tt&gt;S_OK&lt;/tt&gt;: Check successfully performed. &lt;/li&gt; 
   *   &lt;li&gt;&lt;tt&gt;E_FAIL&lt;/tt&gt;: The method has failed. The possible &lt;b&gt;returned errors &lt;/b&gt; (listed by their identifier) are:&lt;/li&gt;
    *   &lt;ul&gt;
    *      &lt;li&gt;&lt;tt&gt;InputERR_1001:&lt;/tt&gt;&lt;/li&gt;
    *       The PX1 licence is not available.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1002:&lt;/tt&gt;&lt;/li&gt;
    *       Not available on non loaded item.
    *      &lt;li&gt;&lt;tt&gt;InputERR_1004:&lt;/tt&gt;&lt;/li&gt;
    *       Internal error.
    *  &lt;/ul&gt;
    *  &lt;/ul&gt;
    */
    static HRESULT NeedToLaunchCATDUAForLinksAnalysis(const CATIxPDMItem_var&amp; iItemToCheck,CATBoolean&amp; oNeedToLaunchCATDUA);
};
#endif

</div>
    
    <div class="navigation">
        <div><a href="CATxPDMProductServices.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATxPDMProductServices.h</a></div>
        <div><a href="CATxPDMSessionUIServices.html">‰∏ã‰∏ÄÈ°µ: CATxPDMSessionUIServices.h ‚Üí</a></div>
    </div>
</body>
</html>