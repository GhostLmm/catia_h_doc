<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDMRuntime/PublicInterfaces/SdaiEntBodyMacro.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>SDMRuntime/PublicInterfaces/SdaiEntBodyMacro.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="SdaiEntAggr.html">‚Üê ‰∏ä‰∏ÄÈ°µ: SdaiEntAggr.h</a></div>
        <div><a href="SdaiEntHeaderMacro.html">‰∏ã‰∏ÄÈ°µ: SdaiEntHeaderMacro.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">/** @CAA2Required */
/*---------------------------------------------------------------------*/
/* DON&#x27;T DIRECTLY INCLUDE THIS HEADER IN YOUR APPLICATION CODE. IT IS  */
/* REQUIRED TO BUILD CAA APPLICATIONS BUT IT MAY DISAPPEAR AT ANY TIME */
/*---------------------------------------------------------------------*/

// ------------------------------------------------------------------------------------------------
// COPYRIGHT DASSAULT SYSTEMES  2001
// ------------------------------------------------------------------------------------------------
// SDAI -- C++ Language Binding -- SdaiEntBodyMacro -- Header
// macros for body of instance classes
// ------------------------------------------------------------------------------------------------

#ifndef SDAI_ENT_BODY_MACRO_H
#define SDAI_ENT_BODY_MACRO_H

#include &lt;SdaiEntHeaderMacro.h&gt;

// #define	CNEXT_CAT_CALLABLE
#include &lt;SdaiBinary.h&gt; // for schemas with a binary attribute

// ====================================================================
// =================&lt;&lt; MACROS  DEFINING METHODS &gt;&gt;=====================
// ====================================================================



// ------------------------------------------------------------------------------------------------
// Macro  defining method GET on attribute of SDAI entity
// ------------------------------------------------------------------------------------------------

#define SDAI_GET_ATTR(Schema, Entity, AttrName, AttrType)	\
	AttrType Sdai##Schema##Entity::AttrName()	const {		\
		return SdaiAppInstance::GetAttr(_att##AttrName);						\
	}									\

// ------------------------------------------------------------------------------------------------
// Macro  defining method TEST on attribute of SDAI entity
// ------------------------------------------------------------------------------------------------

#define SDAI_TEST_ATTR(Schema, Entity, AttrName, AttrType)	\
	const SdaiBoolean&amp; Sdai##Schema##Entity::Test##AttrName() const {	\
		return SdaiAppInstance::TestAttr(_att##AttrName);					\
	}


// ------------------------------------------------------------------------------------------------
// MMacro  defining method PUT on attribute of SDAI entity
// ------------------------------------------------------------------------------------------------

#define SDAI_PUT_ATTR(Schema, Entity, AttrName, AttrType)	\
	void Sdai##Schema##Entity::AttrName(AttrType val) {				\
		SdaiAppInstance::PutAttr(_att##AttrName, (SdaiPrimitiveH) val);  \
	}
	

// ------------------------------------------------------------------------------------------------
// Macro  defining method UNSET on attribute of SDAI entity
// ------------------------------------------------------------------------------------------------

#define SDAI_UNSET_ATTR(Schema, Entity, AttrName, AttrType)	\
	void Sdai##Schema##Entity::Unset##AttrName() {				\
		SdaiAppInstance::UnsetAttr(_att##AttrName); \
	}

// ------------------------------------------------------------------------------------------------
// Macro  defining method GET on aggregate attribute of SDAI entity
// ------------------------------------------------------------------------------------------------

#define SDAI_GET_ATTR_AGGR(Schema, Entity, AttrName, AttrType)	\
	AttrType Sdai##Schema##Entity::AttrName()	const {		\
		return (AttrType) (SdaiAggrInstanceH) SdaiAppInstance::GetAttr(_att##AttrName);						\
	}									\

// ------------------------------------------------------------------------------------------------
// Macro  defining method PUT on aggregate attribute of SDAI entity
// ------------------------------------------------------------------------------------------------
#define SDAI_PUT_ATTR_AGGR(Schema, Entity, AttrName, AttrType)	\
	SDAI_PUT_ATTR (Schema,Entity, AttrName, AttrType)  \
//	void	Sdai##Schema##Entity##::##AttrName(SdaiAggrInstanceH val) {	\
//		AttrName((AttrType) val);  \
//	}



// ------------------------------------------------------------------------------------------------
// Macro  defining method CREATEAGGR on aggregate attribute of SDAI entity
// ------------------------------------------------------------------------------------------------
#define SDAI_CREATE_AGGR_ATTR(Schema, Entity, AttrName, AttrType)	\
	AttrType Sdai##Schema##Entity::CreateAggr##AttrName() {	\
		return (AttrType) SdaiAppInstance::CreateAggrInstance(*(SdaiExplicitAttrH*)(&amp;_att##AttrName)) ; \
	}

// ------------------------------------------------------------------------------------------------
// Macro  defining method GET on aggregate attribute of SDAI entity
// ------------------------------------------------------------------------------------------------
#ifdef _WINDOWS_SOURCE
#define SDAI_GET_ATTR_INST(Schema, Entity, AttrName, AttrType)	\
	AttrType##H Sdai##Schema##Entity::AttrName()	const {		\
		SdaiEntityInstanceH _CATSdaival = SdaiAppInstance::GetAttr(_att##AttrName);	  \
		return (AttrType##H)(_CATSdaival); \
									      }
#else
#define SDAI_GET_ATTR_INST(Schema, Entity, AttrName, AttrType)	\
	AttrType##H Sdai##Schema##Entity::AttrName()	const {		\
		SdaiEntityInstanceH _CATSdaival = SdaiAppInstance::GetAttr(_att##AttrName);	  \
		return AttrType::Castdown(_CATSdaival); \
									      }
#endif


// ------------------------------------------------------------------------------------------------
// Macro  defining method GET on select attribute of SDAI entity
// ------------------------------------------------------------------------------------------------

#define SDAI_GET_ATTR_SEL(Schema, Entity, AttrName, AttrType)	\
	const AttrType&amp; Sdai##Schema##Entity::AttrName()	const {		\
		SdaiSelectH _CATSdaisel = SdaiAppInstance::GetAttr(_att##AttrName);	  \
		static AttrType _CATSdaival;		\
		_CATSdaival = _CATSdaisel;		\
		return  _CATSdaival; \
	}	\

// ------------------------------------------------------------------------------------------------
// Macro  defining method GET on enum attribute of SDAI entity
// ------------------------------------------------------------------------------------------------
#ifdef _WINDOWS_SOURCE
#define SDAI_GET_ATTR_ENUM(Schema, Entity, AttrName, AttrType)	\
	const AttrType&amp; Sdai##Schema##Entity::AttrName()	const {		\
		SdaiEnum _CATSdaitheEnum = SdaiAppInstance::GetAttr(_att##AttrName);	  \
		static AttrType _CATSdaival  ;	\
		_CATSdaival =  (AttrType)(_CATSdaitheEnum); 	\
		return _CATSdaival; \
	}
#else
#define SDAI_GET_ATTR_ENUM(Schema, Entity, AttrName, AttrType)	\
	const AttrType&amp; Sdai##Schema##Entity::AttrName()	const {		\
		SdaiEnum _CATSdaitheEnum = SdaiAppInstance::GetAttr(_att##AttrName);	  \
		static AttrType _CATSdaival  ;	\
		_CATSdaival =  AttrType::Castdown(_CATSdaitheEnum); 	\
		return _CATSdaival; \
	}

#endif


// ================================================================================================
//               all general methods
// ================================================================================================

#define SDAI_ENTITY_BODY_START(Schema,Entity, FatherType)               		   \
 const SdaiString&amp; Sdai##Schema##Entity::LeType()			        		   \
   {                          										   \
   static const SdaiString theType = #Entity;                    					   \
   return theType;                       								   \
   }                          										   \
 /* virtual */   const SdaiBoolean&amp; Sdai##Schema##Entity::IsKindOf( const SdaiString&amp; typeName )  const \
   {            											   \
   static const SdaiString &amp;  letype = Sdai##Schema##Entity::LeType();           			   \
   if (&amp;typeName == &amp;letype) return sdaiTRUE ;      							   \
   if(FatherType::IsKindOf(typeName)) return sdaiTRUE;       						   \
   if (typeName == letype) return sdaiTRUE ;      							   \
   return sdaiFALSE ;				      							   \
   }                                                                    \
/* Constructor and Destructor : */ \
	 Sdai##Schema##Entity::Sdai##Schema##Entity ()			\
	: FatherType() { }  \
	SdaiAppInstanceH Sdai##Schema##Entity::Factory() {\
	return new Sdai##Schema##Entity;    \
	}   \
	int Sdai##Schema##Entity::InitDico() {\
		/* if (_schema == NULL) */     \
		{		\
			_schema = SdaiDictionaryRepo::TheOne()-&gt;GetSchemaDefinition(SdaiString(#Schema)); \
			if (_schema == NULL) return 0;			\
			_entity = _schema-&gt;EntityDefinition(SdaiString(#Entity));  \
			if (_entity == NULL) return 0; 

#define SDAI_STATIC_AFFECT_ATTR(Schema, Entity, AttrName) \
			_att##AttrName = _entity-&gt;AttrDefinition(SdaiString(#AttrName));
			
#define SDAI_AGGR_FACTORY(Schema, Entity, AttrName, AggrName) \
			_att##AttrName-&gt;InitAggrFactory(AggrName::CreateAggrOf);

#define SDAI_ENTITY_BODY_END(Schema, Entity, FatherType) \
		  }	 \
		   _entity-&gt;InitFactory(Sdai##Schema##Entity::Factory);  \
		   return 1; \
	}    \
	Sdai##Schema##Entity##H Sdai##Schema##Entity::CreateInstance(SdaiModelH model)  \
	{  \
		  SdaiAppInstanceH app = _entity-&gt;CreateEntityInstance(model);\
		  return (Sdai##Schema##Entity##H) app;   \
	} \
	 Sdai##Schema##Entity::~Sdai##Schema##Entity ()			\
	{ /* empty */ }									\
															 \
	/* Castdown   */   \
	 Sdai##Schema##Entity##H Sdai##Schema##Entity::Castdown(SdaiEntityInstanceH&amp; ent) {		\
		if (ent-&gt;IsKindOf(LeType()) != sdaiTRUE) {				\
			char buffer[256] ;						\
			(void)sprintf(buffer,						\
			      &quot;Impossible Castdown of a %s entity into a %s entity&quot;,	\
			      (const char *)(ent-&gt;GetInstanceTypeName()),		\
			      (const char *)LeType()) ;					\
			SDAI_RAISE_ERROR(sdaiEVALTYPER, buffer);			\
			return (( Sdai##Schema##Entity##H)NULL);			\
		}									\
		return (( Sdai##Schema##Entity##H)ent);				\
	}										\
	const  Sdai##Schema##Entity##H						\
	 Sdai##Schema##Entity::Castdown(const SdaiEntityInstanceH&amp; ent) {	\
		if (ent-&gt;IsKindOf(LeType()) != sdaiTRUE) {				\
			char buffer[256] ;						\
			(void)sprintf(buffer,						\
			      &quot;Impossible Castdown of a %s const entity &quot;		\
			      &quot;into a %s const entity&quot;,					\
			      (const char *)(ent-&gt;GetInstanceTypeName()),		\
			      (const char *)LeType()) ;					\
			SDAI_RAISE_ERROR(sdaiEVALTYPER, buffer);			\
			return ((const  Sdai##Schema##Entity##H)NULL);		\
		}									\
		return ((const  Sdai##Schema##Entity##H)ent);			\
	} \
/* Static initialization */ \
/* --------------------- */ \
SdaiSchemaH Sdai##Schema##Entity::_schema = NULL; \
SdaiEntityH Sdai##Schema##Entity::_entity = NULL;

#define SDAI_STATIC_INIT_ATTR(Schema, Entity,AttrName) \
SdaiAttrH Sdai##Schema##Entity::_att##AttrName = NULL;


// ------------------------------------------------------------------------------------------------
// Macro defining methods associated with simple attribute in SDAI entity
// ------------------------------------------------------------------------------------------------

#define SDAI_ATTR_BODY_SIMPLE(Schema, Entity , AttrName, AttrType)	\
SDAI_GET_ATTR(Schema, Entity, AttrName, AttrType)		\
SDAI_TEST_ATTR(Schema, Entity, AttrName, AttrType)		\
SDAI_PUT_ATTR(Schema, Entity, AttrName, AttrType )	\
SDAI_UNSET_ATTR(Schema, Entity, AttrName, AttrType )

// ------------------------------------------------------------------------------------------------
// Macro defining methods associated with enum attribute in SDAI entity
// ------------------------------------------------------------------------------------------------

#define SDAI_ATTR_BODY_ENUM(Schema, Entity , AttrName, AttrType)	\
SDAI_GET_ATTR_ENUM(Schema, Entity, AttrName, AttrType)		\
SDAI_TEST_ATTR(Schema, Entity, AttrName, const AttrType &amp;)		\
SDAI_PUT_ATTR(Schema, Entity, AttrName, const AttrType &amp; )	\
SDAI_UNSET_ATTR(Schema, Entity, AttrName, const AttrType &amp; )
// ------------------------------------------------------------------------------------------------
// Macro defining methods associated with select attribute in SDAI entity
// ------------------------------------------------------------------------------------------------

#define SDAI_ATTR_BODY_SEL(Schema, Entity , AttrName, AttrType)	\
SDAI_GET_ATTR_SEL(Schema, Entity, AttrName, AttrType)		\
SDAI_TEST_ATTR(Schema, Entity, AttrName, const AttrType &amp;)		\
SDAI_PUT_ATTR(Schema, Entity, AttrName, const AttrType &amp; )	\
SDAI_UNSET_ATTR(Schema, Entity, AttrName, const AttrType &amp; )

// ------------------------------------------------------------------------------------------------
// Macro defining methods associated with reference attribute in SDAI entity
// ------------------------------------------------------------------------------------------------

#define	SDAI_ATTR_BODY_INST(Schema, Entity , AttrName, AttrType)	\
SDAI_GET_ATTR_INST(Schema, Entity, AttrName, AttrType)		\
SDAI_TEST_ATTR(Schema, Entity, AttrName, AttrType##H)		\
SDAI_PUT_ATTR(Schema, Entity, AttrName, AttrType##H )	\
SDAI_UNSET_ATTR(Schema, Entity, AttrName, AttrType##H ) \
	void Sdai##Schema##Entity::AttrName(SdaiEntityInstanceH ent) {		\
		AttrType##H val = (AttrType##H) (ent) ;		\
		if (val != (AttrType##H)0)	AttrName(val) ;				\
	}


// ------------------------------------------------------------------------------------------------
// Macro defining methods associated with aggr. attribute in SDAI entity
// ------------------------------------------------------------------------------------------------

#define	SDAI_ATTR_BODY_AGGR(Schema, Entity , AttrName, AttrType)	\
SDAI_GET_ATTR_AGGR(Schema, Entity, AttrName, AttrType)		\
SDAI_TEST_ATTR(Schema, Entity, AttrName, AttrType)		\
SDAI_PUT_ATTR_AGGR(Schema, Entity, AttrName, AttrType )	\
SDAI_UNSET_ATTR(Schema, Entity, AttrName, AttrType ) \
SDAI_CREATE_AGGR_ATTR(Schema, Entity, AttrName, AttrType)


// ------------------------------------------------------------------------------------------------
// Macro defining methods associated with inverse simple attribute in SDAI entity
// ------------------------------------------------------------------------------------------------

#define	SDAI_ATTR_BODY_INV(Schema, Entity , AttrName, AttrType)	\
SDAI_GET_ATTR_INST(Schema, Entity, AttrName, AttrType)		\
SDAI_TEST_ATTR(Schema, Entity, AttrName, AttrType)

// ------------------------------------------------------------------------------------------------
// Macro defining methods associated with inverse aggr. attribute in SDAI entity
// ------------------------------------------------------------------------------------------------

#define	SDAI_ATTR_BODY_INVAGGR(Schema, Entity , AttrName, AttrType)	\
SDAI_GET_ATTR_AGGR(Schema, Entity, AttrName, AttrType)		\
SDAI_TEST_ATTR(Schema, Entity, AttrName, AttrType)

#endif	/* SDAI_ENT_BODY_MACRO_H*/

</div>
    
    <div class="navigation">
        <div><a href="SdaiEntAggr.html">‚Üê ‰∏ä‰∏ÄÈ°µ: SdaiEntAggr.h</a></div>
        <div><a href="SdaiEntHeaderMacro.html">‰∏ã‰∏ÄÈ°µ: SdaiEntHeaderMacro.h ‚Üí</a></div>
    </div>
</body>
</html>