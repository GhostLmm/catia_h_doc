<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GMModelInterfaces/PublicInterfaces/CATCGMPickOperator.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>GMModelInterfaces/PublicInterfaces/CATCGMPickOperator.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATCGMMathNurbsDimension.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATCGMMathNurbsDimension.h</a></div>
        <div><a href="CATCGMPickOperatorPickedObject.html">‰∏ã‰∏ÄÈ°µ: CATCGMPickOperatorPickedObject.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">#ifndef CATCGMPickOperator_h_
#define CATCGMPickOperator_h_

// COPYRIGHT DASSAULT SYSTEMES 2010

/**
 * @CAA2Level L1
 * @CAA2Usage U3
*/

#include &quot;CATGMModelInterfaces.h&quot;
#include &quot;CATCGMVirtual.h&quot;
#include &quot;CATBoolean.h&quot;
#include &quot;CATMathLimits.h&quot;
#include &quot;CATMathDef.h&quot;
#include &quot;CATErrorDef.h&quot;  // HRESULT

class CATBody;
class CATCGMPickOperatorResultIterator;
class CATGeoFactory;
class CATGeometry;
class CATMathDirection;
class CATMathPlane;
class CATMathPoint;
class CATMathTransformation;
class CATPickOperatorCallback;
class CATPickOperatorRecorder;
class CATTessSettings;
class CATSoftwareConfiguration;

/**
* Picking operator.  
* Given one or more &lt;code&gt;CATBody&lt;/code&gt;s and a ray defined by a view point and a direction, the picking
* operator finds the CATBody and the geometry (&lt;code&gt;CATGeometry&lt;/code&gt;) intersected by the ray.
*/
class ExportedByCATGMModelInterfaces CATCGMPickOperator: /* public CATICGMVirtual */ public CATCGMVirtual
{

public:

  /**
   * Constructor.
   */
  CATCGMPickOperator();

  /**
   * Destructor.
   */
  virtual ~CATCGMPickOperator();

public:

  /**
   * Adds a body to the picking operator.
   * The last three parameters are the tessellation settings that are used should the operator
   * need to tessellate partly or fully the body for picking.
   * This function can be called multiple times for different bodies.
   * In order that an end user does not see any discrepancy during picking, the client may use the same
   * tessellation settings as it has used for visualization.
   * But note that, tighter the tessellation settings, higher will be the computation cost of the 
   * pick operator.
   * @param iPartBody
   *   The body from the part that is added to the operator.
   * @param iTransform
   *   The transformation matrix corresponding to the positioning 
   *   of this body in global coordinates.
   * @param iPartId
   *   Void pointer that the caller can use to identify the given
   *   body with a part for its own reference. Multiple iPartId&#x27;s can be 
   *   associated with the same body (e.g. when there are multiple instances 
   *   of the same part in an assembly). This PartId is returned back in the
   *   results, so that the caller can identify which instance of the body
   *   got picked.
   * @param iSag
   *   Tessellation parameter: Sag.
   * @param iStep
   *   Tessellation parameter: An optional step size parameter not to be exceeded.  
   * @param iMaxAngle
   *   Tessellation parameter: An optional angle parameter not to be exceeded.
   * @return
   *   &lt;code&gt;S_OK&lt;/code&gt; if the &lt;code&gt;CATBody&lt;/code&gt; is added successfully.
   *   &lt;code&gt;E_FAIL&lt;/code&gt; otherwise.
   */
  virtual HRESULT AddBody(
    CATBody &amp;iPartBody,
    const CATMathTransformation &amp;iTransform,
    const void *iPartId,
    double iSag,
    double iStep = CATMathInfinite,
    double iMaxAngle = 0.25* CATPI) = 0;

  /**
   * This method can be called any number of times, after any/every call to AddBody().
   * It adds another instance of the previous added body.
   * @param iTransform
   *   Transformation matrix corresponding to the positioning in global coordinates
   *   of this instance of the previously added body.
   * @param iPartId
   *   Void pointer that the caller can use to identify another instance 
   *   of the previously added body, for its own reference. Multiple iPartId&#x27;s can be 
   *   associated with the same body (e.g. when there are multiple instances 
   *   of the same part in an assembly. This PartId is returned back in the
   *   results, so that the caller can identify which instance of the body
   *   got picked.
   * @return
   *   &lt;code&gt;S_OK&lt;/code&gt; if the instance is added successfully.
   *   &lt;code&gt;E_FAIL&lt;/code&gt; otherwise.
   */
  virtual HRESULT AddAnotherInstanceOfPreviousBody(
    const CATMathTransformation &amp;iTransform,
    const void *iPartId) = 0;

  /**
   * Runs the picking operator.
   * @param iViewPoint
   *   The start of the picking ray.
   * @param iViewDirection
   *   The direction of the picking ray.
   * @return 
   *   0 if the picking operator runs successfully and 1 otherwise.
   */
  virtual int Run(
    const CATMathPoint &amp;iViewPoint,
    const CATMathDirection &amp;iViewDirection) = 0;

  /**
   * Returns the results of picking. 
   * @param oResultIterator
   *   Iterator that can be used to iterate through picked objects.
   *   This returned iterator is owned by caller, i.e. the caller will need to delete it after use.
   *   It can be deleted using regular C++ delete.
   *   Note that the returned iterator is invalid after the next &quot;Run&quot; or if the operator is deleted.
   *   The returned iterator should be deleted before the next Run or before the operator is deleted, whichever is earlier
   * @return
   *   &lt;code&gt;S_OK&lt;/code&gt; if an iterator is successfully returned.
   *   &lt;code&gt;S_FALSE&lt;/code&gt; if no iterator is returned (no picked object.) ?
   *   &lt;code&gt;E_FAIL&lt;/code&gt; otherwise.
   */
  virtual HRESULT GetResult(
    CATCGMPickOperatorResultIterator *&amp;oResultIterator) const = 0;

  //////////////
  // Methods for modifying options
  //////////////

  /**
   * Sets the aperture radius of picking.
   * @param iApertureRadius
   *   Aperture radius to be used for picking of vertices and edges.
   *   If this is too low, then picking of vertices and edges may become problematic.
   *   By default, this value is 0.0, but it is recommended not to use this default value,
   *   It is recommended that aperture radius be larger than tessellation sag.
   * @return
   *   &lt;code&gt;S_OK&lt;/code&gt; on success.
   *   &lt;code&gt;E_FAIL&lt;/code&gt; if iApertureRadius is less than 0.
   */
  virtual HRESULT SetApertureRadius(double iApertureRadius) = 0;

  /**
   * Enables or disables the pick operator to pick only the first hit object(s).
   * @param iOnlyFirstHit
   *   If this is TRUE, then the pick operator will pick only the first hit object(s).
   *      Note that there could be multiple objects picked in the first hit, if the ray 
   *      simultaneously hits multiple objects (within aperture radius).
   *   If this is FALSE, then the operator will pick all hit objects.
   *
   *   By default value of this option is TRUE.
   *   Setting this to TRUE would give better performance than FALSE.
   * @return
   *   &lt;code&gt;S_OK&lt;/code&gt; on success.
   *   &lt;code&gt;E_FAIL&lt;/code&gt; otherwise.
   */
  virtual HRESULT SetOnlyFirstHit(CATBoolean iOnlyFirstHit) = 0;

  //////////////
  // Methods for querying current value of options
  //////////////

  /**
   * Gets the currently set aperture radius of picking.
   * Refer &quot;SetApertureRadius&quot; for more details on aperture radius
   * @param oApertureRadius
   *   Currently set aperture radius of picking
   * @return
   *   &lt;code&gt;S_OK&lt;/code&gt; on success.
   *   &lt;code&gt;E_FAIL&lt;/code&gt; otherwise.
   */
  virtual HRESULT GetApertureRadius(double &amp;oApertureRadius) const = 0;

  /**
   * Gets the current state of the &quot;OnlyFirstHit&quot; option
   * Refer &quot;SetOnlyFirstHit&quot; for more details on this option
   * @param oOnlyFirstHit
   *   Current state of the &quot;OnlyFirstHit&quot; option
   * @return
   *   &lt;code&gt;S_OK&lt;/code&gt; on success.
   *   &lt;code&gt;E_FAIL&lt;/code&gt; otherwise.
   */
  virtual HRESULT GetOnlyFirstHit(CATBoolean &amp;oOnlyFirstHit) const = 0;

};

//////////////
// CATCGMPickOperator creator function
//////////////

/**
 * Global function to create a picking operator.
 */
ExportedByCATGMModelInterfaces CATCGMPickOperator *CATCGMCreatePickOperator(CATSoftwareConfiguration &amp;iConfig);

#endif /* CATCGMPickOperator_h_ */
</div>
    
    <div class="navigation">
        <div><a href="CATCGMMathNurbsDimension.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATCGMMathNurbsDimension.h</a></div>
        <div><a href="CATCGMPickOperatorPickedObject.html">‰∏ã‰∏ÄÈ°µ: CATCGMPickOperatorPickedObject.h ‚Üí</a></div>
    </div>
</body>
</html>