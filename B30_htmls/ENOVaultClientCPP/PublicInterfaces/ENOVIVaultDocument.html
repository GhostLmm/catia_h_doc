<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ENOVaultClientCPP/PublicInterfaces/ENOVIVaultDocument.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ENOVaultClientCPP/PublicInterfaces/ENOVIVaultDocument.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="ENOVIVaultClientAPP.html">‚Üê ‰∏ä‰∏ÄÈ°µ: ENOVIVaultClientAPP.h</a></div>
        <div><a href="ENOVIVaultDocumentColl.html">‰∏ã‰∏ÄÈ°µ: ENOVIVaultDocumentColl.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">#include &quot;ENOVIVaultClientAPP.h&quot;
#ifndef _ENOVIVaultDocument_h
#define _ENOVIVaultDocument_h

// =================================================================
// COPYRIGHT DASSAULT SYSTEMES 2000
// =================================================================
// VPM (c) Copyright Dassault Systemes 2000
// -----------------------------------------------------------------
//
// Contents: ENOVIVaultDocument, process client side.
//
// =================================================================
// Historic
// Creation : 15/09/2000  OJH
// =================================================================

/**
 *  @CAA2Level L1
 *  @CAA2Usage U1
 */ 

//-----------------------------------------------------------------------------
// INCLUDES:
//-----------------------------------------------------------------------------


#include &quot;CATTypUtilit.h&quot;
#include &quot;CATDataType.h&quot;
#include &quot;CATUnicodeString.h&quot;
#include &quot;ENOVIDocMandAttHolder.h&quot;
#include &quot;ENOVIVaultError.h&quot;

class ENOVIVaultUserSession;
class VSDocumentRMI;

//-----------------------------------------------------------------------------
// CLASS: ENOVIVaultDocument
//-----------------------------------------------------------------------------

/**
 * This class supplies methods to manage documents.
 * &lt;b&gt;role&lt;/b&gt;: This class enables to access properties and content of a document
 */

// WARNING
// WARNING to bypas HP redefinition of read, write etc ... (/usr/include/dce/cma_ux.h)
// WARNING
//#ifdef _HPUX_SOURCE
#ifndef _CMA_NOWRAPPERS_
#define _CMA_NOWRAPPERS_
#endif
//#endif

class  ExportedByENOVIVaultClientAPP  ENOVIVaultDocument
{
  friend class  ENOVIVaultUserSession;
  friend class  ENOVIVaultSession;

//
// Class data member
//
public :
/**
 * @nodoc
 */
   static int  CREATED;
/**
 * @nodoc
 */
   static int  UPDATED;
/**
 * @nodoc
 */
   static int  DELETED;
/**
 * @nodoc
 */
   static int  COMMITTED;
/**
 * @nodoc
 */
   static int  EXCLUSIVELOCK;

//
public :

/**
 * @nodoc
 */
   ENOVIVaultDocument();

/**
 * @nodoc
 */
   ENOVIVaultDocument(ENOVIVaultUserSession  * ipFatherUserSession,
                      VSDocumentRMI          * ipReadVSDocumentRMI,
                      VSDocumentRMI          * ipWriteVSDocumentRMI);

//
// Destructor
//

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
   ~ENOVIVaultDocument();


public:
/**
 * Reads the whole document content into a bytes array. 
 * The current position is set to the document end after this operation. 
 * You are supposed to allocate and release the data buffer oReadBuffer.
 * This service uses the above @href #ReadBlock method to be efficient and performe the whole read sequence by
 * block. 
 * @param iSizeToRead [in] - data buffer to read size
 * @param oReadBuffer [out] - data buffer read from server.
 * @param oVaultError [out] - Details about the error.
 * @return S_OK, E_FAIL, VAULT_E_NOT_OPEN_READ
 */
   HRESULT read(const long              iSizeToRead, 
                      SEQUENCE_octet  &amp; oReadBuffer,
                      ENOVIVaultError &amp; oVaultError);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
   HRESULT read(const long               iSizeToRead, 
                      SEQUENCE_octet   &amp; oppReadBuffer,
                      CATUnicodeString &amp; iLocation,
                      ENOVIVaultError  &amp; ve);

/**
 * Supplies the ENOVIVaultDocument Unique Universal Identifier.
 * @param oURL [out] - ENOVIVaultDocument Unique Universal Identifier.
 */
   HRESULT getURL(SEQUENCE_octet &amp; oURL) const;

/**
 * Get the Father ENOVIVaultUserSession.
 * @param oFatherUserSession [out] - Father ENOVIVaultUserSession.
 */
   HRESULT getFatherUserSession(ENOVIVaultUserSession ** oppFatherUserSession) const;


/**
 * Supplies the ENOVIVaultDocument status.
 * @param oStatus [out] - ENOVIVaultDocument status. It can be: 
 *     &lt;br&gt;&lt;b&gt;Legal Values&lt;/b&gt;: &lt;tt&gt;iAction&lt;/tt&gt; may be set to:
 *         &lt;dl&gt;
 *         &lt;dt&gt;&lt;tt&gt;CREATED&lt;/tt&gt;  &lt;dd&gt;To indicate that the document have been created.
 *         &lt;dt&gt;&lt;tt&gt;UPDATED&lt;/tt&gt; &lt;dd&gt;To indicate that the document has been updated.
 *         &lt;dt&gt;&lt;tt&gt;DELETED&lt;/tt&gt;  &lt;dd&gt;To indicate that the document has been deleted.
 *         &lt;dt&gt;&lt;tt&gt;COMMITTED&lt;/tt&gt;  &lt;dd&gt;To indicate that there is no ongoing modification on the document.
 *         &lt;/dl&gt; 
 */
   HRESULT getStatus(int &amp; oStatus, ENOVIVaultError &amp; oVaultError) const;

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 * Try to get a lock of the requested type on the ENOVIVault Document Object. &lt;br&gt;
 * According to the requested lock type this call may failed if the vault document &lt;br&gt;
 * is already locked by an other ENOVIVault users. &lt;br&gt;
 * A lock cannot survive the transaction end.
 * @param iRequestedLockType [in] - requested lock type.
 * @param oVaultError [out] - Details about the error.
 * @return S_OK, E_FAIL, VAULT_E_LOCKED, VAULT_E_DELETED
 */
   HRESULT lock(const int iRequestedLockType,ENOVIVaultError &amp; oVaultError);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 * Unlock the vault document if no modification has been done, else the lock is &lt;br&gt;
 * released at transaction end.
 * @param oVaultError [out] - Details about the error.
 * @return S_OK, VAULT_E_OBJMODIFIED, E_FAIL
 */
   HRESULT unLock(ENOVIVaultError &amp; oVaultError);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 * Supplies the lock status of the vault document.
 * @param oVaultError [out] - Details about the error.
 */
   HRESULT getLockStatus(int &amp; oLockStatus,ENOVIVaultError &amp; oVaultError) const;

// 
// -&gt; Mandatory attributes
// 

/**
 * Supplies the document creation date.
 * @param oCreationTimestamp [out] - ENOVIVaultDocument creation date.
 * @param oVaultError [out] - Details about the error.
 */
   HRESULT getCreationTimestamp(CATUnicodeString &amp; oCreationTimestamp, 
                                ENOVIVaultError  &amp; oVaultError) const;

/**
 * Supplies the document last modification date.
 * @param oLastTimestamp [out] - ENOVIVaultDocument last modification date.
 * @param oVaultError [out] - Details about the error.
 */
   HRESULT getLastModTimestamp(CATUnicodeString &amp; oLastTimestamp,
                               ENOVIVaultError  &amp; oVaultError) const;

/**
 * Supplies the document last modification date in GMT time.
 * @param onvLastTimestamp [out] - ENOVIVaultDocument last modification date.
 * @param oVaultError [out] - Details about the error.
 */
   HRESULT getGMTLastModTimestamp(CATLONG64       &amp; onvLastTimestamp,
                                  ENOVIVaultError &amp; oVaultError) const;

/**
 * Supplies the document external object identifier.
 * @param oEXTOId [out] - ENOVIVaultDocument external object identifier.
 * @param oVaultError [out] - Details about the error.
 */
   HRESULT getEXTOId(SEQUENCE_octet   &amp; oEXTOId,
                     ENOVIVaultError  &amp; oVaultError) const;

/**
 * Supplies the document name.
 * @param oName [out] - ENOVIVaultDocument name.
 * @param oVaultError [out] - Details about the error.
 */
  HRESULT getName(CATUnicodeString &amp; oName, ENOVIVaultError &amp; oVaultError) const;
  
/**
 * Supplies the document original name.
 * @param oOriginalName [out] - ENOVIVaultDocument original name.
 * @param oVaultError [out] - Details about the error.
 */
  HRESULT getOriginalName (CATUnicodeString &amp; oOriginalName, ENOVIVaultError &amp; oVaultError) const;

/**
 * Supplies the document original path.
 * @param oOriginalPath [out] - ENOVIVaultDocument original path.
 * @param oVaultError [out] - Details about the error.
 */
  HRESULT getOriginalPath (CATUnicodeString &amp; oOriginalPath, ENOVIVaultError &amp; oVaultError) const;

/**
 * Supplies the document original host.
 * @param oOriginalHost [out] - ENOVIVaultDocument original host.
 * @param oVaultError [out] - Details about the error.
 */
  HRESULT getOriginalHost (CATUnicodeString &amp; oOriginalHost, ENOVIVaultError &amp; oVaultError) const;

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 * Supplies the document last content modification date.
 * @param oLCM [out] - ENOVIVaultDocument last content modification date in milliseconds since January 1, 1970, 00:00:00 GMT.
 * @param oVaultError [out] - Details about the error.
 */
  HRESULT getLCM(long &amp; oLCM, ENOVIVaultError &amp; oVaultError) const;

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
  HRESULT  getMandAttr(ENOVIDocMandAttHolder &amp; oENOVIDocMandAttHolder,
                       ENOVIVaultError       &amp; ve);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
  HRESULT  setMandAttr(ENOVIDocMandAttHolder &amp; iENOVIDocMandAttHolder,
                       ENOVIVaultError       &amp; ve);

/**
 * Sets the document original name.
 * @param iOriginalName [in] - ENOVIVaultDocument original name.
 * @param oVaultError [out] - Details about the error.
 */
  HRESULT setOriginalName (const CATUnicodeString &amp; iOriginalName, ENOVIVaultError &amp; oVaultError);

/**
 * Sets the document original path.
 * @param iOriginalPath [in] - ENOVIVaultDocument original path.
 * @param oVaultError [out] - Details about the error.
 */
  HRESULT setOriginalPath ( const CATUnicodeString &amp; oOriginalPath, ENOVIVaultError &amp; oVaultError);

/**
 * Sets the document original host.
 * @param iOriginalHost [out] - ENOVIVaultDocument original host.
 * @param oVaultError [out] - Details about the error.
 */
  HRESULT setOriginalHost ( const CATUnicodeString &amp; iOriginalHost , ENOVIVaultError &amp; oVaultError);

/**
 * Supplies the document description.
 * @param oDescription [out] - ENOVIVaultDocument description.
 * @param oVaultError [out] - Details about the error.
 */
   HRESULT getDescription(CATUnicodeString &amp; oDescription,ENOVIVaultError &amp; oVaultError) const;

/**
 * Supplies the document size.
 * @param  oDocumentSize [out] - ENOVIVaultDocument size.
 * @param oVaultError [out] - Details about the error.
 */
   HRESULT getSize(unsigned long &amp; oDocumentSize,ENOVIVaultError &amp; oVaultError) const;

/**
 * Supplies the document cksum.
 * @param  oDocumentCKSum [out] - ENOVIVaultDocument size.
 * @param oVaultError [out] - Details about the error.
 */
   HRESULT getCKSum(unsigned long   &amp; oDocumentCKSum,
                    ENOVIVaultError &amp; oVaultError) const;

/**
 * Supplies the document mimetype.
 * @param oMimetype [out] - ENOVIVaultDocument mimetype.
 * @param oVaultError [out] - Details about the error.
 */
   HRESULT getMimeType(CATUnicodeString &amp; oMimetype,ENOVIVaultError &amp; oVaultError) const;


/**
 * Sets the document external object identifier.
 * @param iEXTOId [in] - ENOVIVaultDocument external object identifier.
 * @param oVaultError [out] - Details about the error.
 */
   HRESULT setEXTOId(const SEQUENCE_octet   &amp; iEXTOId,
                           ENOVIVaultError  &amp; oVaultError) const;

/**
 * Sets the document name.
 * @param iName [in] - ENOVIVaultDocument name.
 * @param oVaultError [out] - Details about the error.
 */
   HRESULT setName(const CATUnicodeString &amp; iName,ENOVIVaultError &amp; oVaultError);

/**
 * Set the document description.
 * @param iDescription [in] - ENOVIVaultDocument description.
 * @param oVaultError [out] - Details about the error.
 */
   HRESULT setDescription(const CATUnicodeString &amp; iDescription,ENOVIVaultError &amp; oVaultError);

/**
 * Set the ENOVIVaultDocument mimetype.
 * @param iMimetype [in] - ENOVIVaultDocument mimetype.
 * @param oVaultError [out] - Details about the error.
 */
   HRESULT setMimeType(const CATUnicodeString &amp; iMimetype,ENOVIVaultError &amp; oVaultError);


//
// Document access
//
public :

/**
 * Initiates a document read operation. 
 * It gives access to the last committed view. At open time 
 * the current position is set to the document beginning (value zero).
 * @param oVaultError [out] - Details about the error.
 * @return S_OK, E_FAIL, VAULT_E_LOCKED, VAULT_E_ALREADY_OPEN
 */
   HRESULT openRead(ENOVIVaultError &amp; oVaultError);


/**
 * Initiates a document write operation. 
 * To be successful, it supposes that the document
 * is not under modification. Put the size of the document to write when it is possible.
 * It should always be the case, else put the value zero by default. At open time the current
 * position is set to the document beginning (value zero).
 * &lt;b&gt;Performance issue:&lt;/b&gt; Be carefull that this call trigger a document copy on ENOVIVault server side
 * off when the iFullDocWritePlanned parameter is set to false.
 * Set iFullDocWritePlanned to true each time it is possible.
 * @param iDocSize [in] - document size in bytes. 
 *     &lt;br&gt;&lt;b&gt;Legal Values&lt;/b&gt;: &lt;tt&gt;iDocSize&lt;/tt&gt; setted to zero means that you do not know the document size.
 * @param iFullDocWritePlanned [in] - indicates if you are planning to write the whole document.
 *     &lt;br&gt;&lt;b&gt;Legal Values&lt;/b&gt;: 
 *         &lt;dl&gt;
 *         &lt;dt&gt;&lt;tt&gt;CATTrue&lt;/tt&gt;  &lt;dd&gt;To indicate that the whole document will be written.
 *         &lt;dt&gt;&lt;tt&gt;CATFalse&lt;/tt&gt; &lt;dd&gt;To indicate that only part of the document will be written.
 *         &lt;/dl&gt; 
 * @param oVaultError [out] - Details about the error.
 * @return S_OK, E_FAIL, VAULT_E_LOCKED, VAULT_E_MEDIUM_FULL, VAULT_E_ALREADY_OPEN
 */
   HRESULT openWrite(const unsigned long     iDocSize,
                     const CATBoolean        iFullDocWritePlanned,
                           ENOVIVaultError &amp; oVaultError);


/**
 * Initiates a document read write operation. 
 * To be successful, it supposes that the document
 * is not under modification. It give access to the last committed view.
 * &lt;b&gt;Performance issue:&lt;/b&gt; Be carefull that this call trigger a document copy on server side
 * off. &lt;br&gt;
 * Prefer others read or write methods than this one if possible.
 * @param iFullDocWritePlanned [in] - indicates if you are planning to write the whole document.
 *     &lt;br&gt;&lt;b&gt;Legal Values&lt;/b&gt;: 
 *         &lt;dl&gt;
 *         &lt;dt&gt;&lt;tt&gt;CATTrue&lt;/tt&gt;  &lt;dd&gt;To indicate that the whole document will be written.
 *         &lt;dt&gt;&lt;tt&gt;CATFalse&lt;/tt&gt; &lt;dd&gt;To indicate that only part of the document will be written.
 *         &lt;/dl&gt; 
 * @param oVaultError [out] - Details about the error.
 * @return S_OK, E_FAIL, VAULT_E_LOCKED, VAULT_E_ALREADY_OPEN
 */
   HRESULT openReadWrite(const CATBoolean        iFullDocWritePlanned,
                               ENOVIVaultError &amp; oVaultError);

//
// -&gt; Current position methods
//

/**
 * Supplies the current position in the document you are accessing. 
 * &lt;br&gt;&lt;b&gt;Precondition&lt;/b&gt;: The document must have been openned
 * @param oCurPos [out] - current position in the document.
 * @param oVaultError [out] - Details about the error.
 * @return S_OK, E_FAIL, VAULT_E_NOT_OPEN
 */
   HRESULT getCurPos(unsigned long &amp; oCurPos, ENOVIVaultError &amp; oVaultError) const;

/**
 * Set the current position in the document you are accessing.
 * &lt;br&gt;&lt;b&gt;Precondition&lt;/b&gt;: The document must have been openned
 * @param iNewCurPos [in] - new current position in the document.
 * @param oVaultError [out] - Details about the error.
 * @return S_OK, E_FAIL, VAULT_E_NOT_OPEN
 */
   HRESULT setCurPos(const unsigned long iNewCurPos, ENOVIVaultError &amp; oVaultError);


// 
// Read methods
//

/**
 * Read a data block beginning at the current position from the server document&lt;br&gt;
 * into a bytes array. The current position is updated after the block read operation.&lt;br&gt;
 * You are suppose to allocate and release the data buffer oReadBuffer.
 * @param ioReadBuffer [inout] - data buffer read from server.
 * @param iOffset [in] - offset in the input/output buffer.
 * @param iSizeToRead [in] - data buffer to read size.
 * @return S_OK, E_FAIL, VAULT_E_NOT_OPEN
 */
   HRESULT readBlock(      SEQUENCE_octet  &amp; ioReadBuffer, 
                     const long              iOffset, 
                     const long              iSizeToRead,
                           long            &amp; oLengthRead,
                           ENOVIVaultError &amp; oVaultError); 

/**
 * Copy the server document into a local file. The local file full path name is not mandatory.&lt;br&gt;
 * You may give only the file name or even nothing. Then use the getLocationPath method to get&lt;br&gt;
 * the local file full path name. The current position is set to the document end after this
 * operation.
 * @param iLocalFullPathName [in] - full path name under which the consumer application want the
 * document to be copied.
 * @param iDeleteLocalFileAtClose [in] - if set ot true, the local file will be deleted at close
 * time. 
 * @return S_OK, E_FAIL, VAULT_E_NOT_OPEN_READ, VAULT_E_MEDIUM_FULL
 */
   HRESULT copyToLocalFile(const CATUnicodeString &amp; iLocalFullPathName, 
                           const CATBoolean         iDeleteLocalFileAtClose,
                                 ENOVIVaultError  &amp; oVaultError);

// 
// -&gt; Writting methods
//

/**
 * Write a data block on server beginning at the current position from a bytes array. The
 * current&lt;br&gt;
 * position is updated after the block write operation. You are suppose to allocate and release
 * the&lt;br&gt;
 * data buffer iBufferToWrite.&lt;br&gt;
 * @param iBufferToWrite [in] - data block to write on server.
 * @param iOffset [in] - offset in the input buffer.
 * @param iSizeToWrite [in] - number of bytes to write on server. 
 * @return S_OK, E_FAIL, VAULT_E_NOT_OPEN_WRITE, VAULT_E_MEDIUM_FULL
 */
   HRESULT writeBlock(const SEQUENCE_octet  &amp; iBufferToWrite,
                      const long              iOffset,
                      const long              iSizeToWrite,
                            ENOVIVaultError &amp; oVaultError);


/**
 * Copy the local document on server. The local file full path name is mandatory. The current
 * position&lt;br&gt;
 * is set to the document end after this operation.&lt;br&gt;
 * @param iLocalFullPathName [in] - local document to write full path name.
 * @param iDeleteLocalFileAtClose [in] - if set ot true, the local file will be deleted at close
 * time. 
 * @return S_OK, E_FAIL, VAULT_E_NOT_OPEN_WRITE, VAULT_E_NO_LOCALFILEFULLPATHNAME,
 * VAULT_E_MEDIUM_FULL
 */
   HRESULT copyFromLocalFile(const CATUnicodeString &amp; iLocalFullPathName, 
                             const CATBoolean         iDeleteLocalFileAtClose,
                                   ENOVIVaultError  &amp; oVaultError);


/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
  HRESULT copyDocValueFromDoc (const ENOVIVaultDocument * sourceDoc,
                                     ENOVIVaultError    &amp; oVaultError);

/**
 * Write the whole document on server from a bytes array. The current position is set to the
 * document end&lt;br&gt;
 * after this operation. You are suppose to allocate and release the data buffer iBufferToWrite.&lt;br&gt;
 * This service use the above WriteBlock call to be efficient and performe the whole write sequence
 * by block. 
 * @param iSizeToWrite [in] - number of bytes to write on server. 
 * @param iBufferToWrite [in] - data buffer to write on server.
 * @return S_OK, E_FAIL, VAULT_E_NOT_OPEN_WRITE, VAULT_E_MEDIUM_FULL
 */
   HRESULT write(const long              iSizeToWrite,
		           const SEQUENCE_octet  &amp; iBufferToWrite,
                       ENOVIVaultError &amp; oVaultError);

// 
// -&gt; General methods
//
/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
   HRESULT getLocationPathOnServer(CATUnicodeString &amp; oFullPath,
                                   ENOVIVaultError  &amp; oVaultError) const;

/**
 * Supplies when possible and according to transfer protocols, the full path name of the ENOVIVault
 * document.&lt;br&gt;
 * You will have an error if no open has been done on the document. If NFS transfer protocol is
 * switched&lt;br&gt;
 * on you will have the full path name on server side under which to write or read the document.&lt;br&gt;
 * After a CopyXXXLocalFile operation, it will return the given LocalFullPathName.&lt;br&gt;
 * @param oFullPath [out] - full path name of the vault document on the ENOVIVault server
 * @return S_OK, E_FAIL, VAULT_E_NOT_OPEN, VAULT_E_NO_LOCATION_AVAILABLE
 */
   HRESULT getLocationPath(CATUnicodeString &amp; oFullPath,
			   ENOVIVaultError  &amp; oVaultError) const;

/**
 * Specifies if the document is cached or not.
 * @param oIsDocCached [out] - true if the document is cached, false otherwise.
 * @return S_OK, E_FAIL
 * @since V5R10
 */
   HRESULT isCached(CATBoolean          &amp; oIsDocCached,
                    ENOVIVaultError     &amp; oVaultError);

/**
 * Refresh this document if it is a cached document and it is not up-to-date.
 * @since V5R10
 */
   HRESULT refresh(ENOVIVaultError &amp; oVaultError);

//
// -&gt; Closing Method
//

/**
 * Ends the Read, Write or ReadWrite sequence. Reset the current position to the document
 * beginning.&lt;br&gt;
 * Delete local file if needed.
 * @return S_OK, S_ALREADY_CLOSE, S_NOT_OPEN, E_FAIL
 */
   HRESULT close(ENOVIVaultError &amp; oVaultError);

/**
 * Supplies the ENOVIVaultDocument Object Identifier.
 * @param oOId [out] - ENOVIVaultDocument Object Identifier.
 * @return S_OK, E_FAIL
 */
   HRESULT getOId(SEQUENCE_octet &amp; oOId) const;

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 * Set the ENOVIVaultDocument Object Identifier.
 * @param iOId [in] - ENOVIVaultDocument Object Identifier.
 * @return S_OK, E_FAIL
 */
   HRESULT setOId(const SEQUENCE_octet &amp; iOId);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 * Set the ENOVIVaultDocument Unique Universal Identifier.
 * @param iURL [in] - ENOVIVaultDocument Unique Universal Identifier.
 * @return S_OK, E_FAIL
 */
   HRESULT setURL(const SEQUENCE_octet &amp; iURL);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 * Set the Father ENOVIVaultUserSession.
 * @param iFatherUserSession [in] - Father ENOVIVaultUserSession.
 * @return S_OK, E_FAIL
 */
   HRESULT setFatherUserSession(ENOVIVaultUserSession * ipFatherUserSession);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
   HRESULT setLocationPath(CATUnicodeString &amp; oFullPath,
			   ENOVIVaultError  &amp; oVaultError);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
   HRESULT setReadVSDocumentRMI(VSDocumentRMI     * ipReadVSDocumentRMI);
   
/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
   HRESULT setWriteVSDocumentRMI(VSDocumentRMI    * ipWriteVSDocumentRMI);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 * Set the ENOVIVaultDocument creation date.
 * @param iCreationTimestamp [in] - ENOVIVaultDocument creation date.
 * @return S_OK, E_FAIL
 */
   HRESULT setCreationTimestamp(const CATUnicodeString &amp; iCreationTimestamp,ENOVIVaultError &amp; oVaultError);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
   HRESULT getReadVSDocumentRMI(VSDocumentRMI    ** oppReadVSDocumentRMI);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
   HRESULT getWriteVSDocumentRMI(VSDocumentRMI   ** oppWriteVSDocumentRMI);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
   unsigned long AddRef();

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
   unsigned long Release();

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
   unsigned long RefCount();

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
   void BeMutable();

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
   void BeNotMutable();

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
HRESULT getGMTCreatLastModTimestamp(CATLONG64      &amp; onvGMTCreationTimestamp,
									CATLONG64      &amp; onvGMTLastTimestamp,
                                                     ENOVIVaultError  &amp; ve) const;

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
static HRESULT toURL (const CATUnicodeString &amp; alias,
                      const SEQUENCE_octet   &amp; oid,
                            SEQUENCE_octet   &amp; url,
                            CATUnicodeString &amp; oidhexa,
							CATBoolean       &amp; iNotMutableDoc,
                            ENOVIVaultError  &amp; oVaultError);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
static HRESULT fromURL(const SEQUENCE_octet   &amp; iURL,
                             CATUnicodeString &amp; alias,
                             SEQUENCE_octet   &amp; oid,
                             CATUnicodeString &amp; oidhexa,
                             ENOVIVaultError  &amp; oVaultError);

/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
static HRESULT fromURL(const SEQUENCE_octet   &amp; iURL,
                             CATUnicodeString &amp; alias,
                             SEQUENCE_octet   &amp; oid,
                             CATUnicodeString &amp; oidhexa,
							 CATBoolean       &amp; iNotMutableDoc,
                             ENOVIVaultError  &amp; oVaultError);
  
/**
 * @nodoc
 * ****************** CAUTION: INTERNAL USE ONLY *******************************
 */
static HRESULT addNotMutableToURL(SEQUENCE_octet   &amp; iURL,
                                  ENOVIVaultError  &amp; oVaultError);

protected:
//
// Instance data member
//
   SEQUENCE_octet          _OId;                 // Cached on client
   SEQUENCE_octet          _URL;                 // Cached on client

   ENOVIVaultUserSession  * _FatherUserSession;
   VSDocumentRMI          * _ReadRMI;
   VSDocumentRMI          * _WriteRMI;

//   int                 _Status;
//   int                 _LockStatus;

   CATUnicodeString         _CreationTimestamp;  // Cached on client

   CATUnicodeString         _dvLastModTimestamp;  // Cached on client between OpenRead and close.
   CATUnicodeString         _dvGMTLastModTimestamp;  // Cached on client between OpenRead and close.
   CATUnicodeString         _svName;              // Cached on client between OpenRead and close.
   CATUnicodeString         _svDescription;       // Cached on client between OpenRead and close.
   CATUnicodeString         _svMimeType;          // Cached on client between OpenRead and close.
   CATUnicodeString         _svOriginalName;      // Cached on client between OpenRead and close.
   CATUnicodeString         _svOriginalPath;      // Cached on client between OpenRead and close.
   CATUnicodeString         _svOriginalHost;      // Cached on client between OpenRead and close.
   unsigned long            _Size;                // Cached on client between OpenRead and close.
   long                     _nvLastContentAccess; // Cached on client between Open Read/Write
                                                  // and close.
   long                     _nvLastContentModif;  // Cached on client between Open Read/Write
                                                  // and close.

   unsigned long            _CurPos;              // Cached on client

   CATUnicodeString         _svLocalfullname;
   CATUnicodeString         _svLocationPathOnServer; // Cached on client between OpenRead and close.

   CATBoolean               _moderead;
   CATBoolean               _isLocalFileToDelete;
   CATBoolean               _IsOpenRead;
   CATBoolean               _IsOpenWrite;
   CATBoolean               _IsILB2Optimized;
   CATBoolean               _IsNotMutable;
   
   unsigned long            _refCount;
};

#endif
</div>
    
    <div class="navigation">
        <div><a href="ENOVIVaultClientAPP.html">‚Üê ‰∏ä‰∏ÄÈ°µ: ENOVIVaultClientAPP.h</a></div>
        <div><a href="ENOVIVaultDocumentColl.html">‰∏ã‰∏ÄÈ°µ: ENOVIVaultDocumentColl.h ‚Üí</a></div>
    </div>
</body>
</html>