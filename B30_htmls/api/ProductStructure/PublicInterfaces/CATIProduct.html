<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProductStructure/PublicInterfaces/CATIProduct.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ProductStructure/PublicInterfaces/CATIProduct.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATIPrdRepresentation.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIPrdRepresentation.h</a></div>
        <div><a href="CATIProductFileSelection.html">‰∏ã‰∏ÄÈ°µ: CATIProductFileSelection.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">/* -*-c++-*- */
#ifndef CATIProduct_h
#define CATIProduct_h

// COPYRIGHT DASSAULT SYSTEMES  1999

/**
 * @CAA2Level L1
 * @CAA2Usage U3
 */

#include &quot;AS0STARTUP.h&quot;
#include &quot;CATPrdDecls.h&quot;
#include &quot;CATBaseUnknown.h&quot;
#include &quot;CATUnicodeString.h&quot;
#include &quot;CATISpecDeclarations.h&quot;
#include &quot;CATLISTV_CATBaseUnknown.h&quot;
#include &quot;CATLISTV_CATISpecObject.h&quot;
#include &quot;CATIContainer.h&quot;
#include &quot;CATIConnector.h&quot;
#include &quot;CATIPrdRepresentation.h&quot;
#include &quot;IUnknown.h&quot;

class CATUnicodeString;
class CATILinkableObject_var;
class CATISpecObject_var;
class CATIContainer_var;
class CATIConnector_var;
class CATIPrdDiscipline_var;
class CATListValCATISpecObject_var;
class CATListValCATUnicodeString;
class CATListValCATBaseUnknown_var;
class CATNamingReference;

extern ExportedByAS0STARTUP IID IID_CATIProduct ;

class CATIProduct;
CATDeclareHandler(CATIProduct,CATBaseUnknown);

/**	
* Interface to manage products.
* &lt;b&gt;Role:&lt;/b&gt; this interface concerns components ( references products ) 
* or instances ( reuse of existing references ) agregated in upperproducts.
*/

class ExportedByAS0STARTUP CATIProduct : public CATBaseUnknown
{
  CATDeclareInterface;

  public:
   //-----------------------------------------------------------------
   // Product structure access
   //-----------------------------------------------------------------
   
   /**
    * Returns the reference product.
	* &lt;br&gt;&lt;b&gt;Note:&lt;/b&gt;Instance-reference management.
    */
   virtual CATIProduct_var 		   GetReferenceProduct() = 0;

   /**
    * Returns the owning product.
	* &lt;br&gt;&lt;b&gt;Note:&lt;/b&gt;Agregation management.    
    */
   virtual CATIProduct_var 		   GetFatherProduct   () = 0;

   /**
    * Returns number of direct subproducts.
	* &lt;br&gt;&lt;b&gt;Note:&lt;/b&gt;Agregation management.
    */
   virtual int  GetChildrenCount()   const = 0;

   /**
    * Returns list of subproducts directly concerned.
	* &lt;br&gt;&lt;b&gt;Note:&lt;/b&gt;Agregation management.
	* @param iIntfId
	*     name of the expected interface as handle for the children.
    */ 
   virtual CATListValCATBaseUnknown_var*   GetChildren(const char* iIntfId = &quot;CATIProduct&quot;)    const = 0;

   /**
    * Returns list of all subproducts.
	* &lt;br&gt;&lt;b&gt;Note:&lt;/b&gt;Agregation management.
	* @param iIntfId
	*     name of the expected interface as handle for the children.
    */ 
   virtual CATListValCATBaseUnknown_var*   GetAllChildren(const char* iIntfId = &quot;CATIProduct&quot;)    const = 0;

   /**
    * @nodoc
    */
   virtual CATListValCATISpecObject_var*   GetChild(const char* intfId = &quot;CATIProduct&quot;)    const = 0;


   //-----------------------------------------------------------------
   // Remove management
   //-----------------------------------------------------------------
   /**
	* Removes an instance of product.
	* @param iInstance
	*       instance of product to remove.
	* &lt;br&gt;&lt;b&gt;Note:&lt;/b&gt; It also removes the reference if it is the last 
	* instance of a local reference .
	*/
   virtual void                            RemoveProduct(CATIProduct_var &amp; iInstance) = 0;
   
   
   //-----------------------------------------------------------------
   // Adding SubProducts
   //-----------------------------------------------------------------
 
   /**
	* Adds subproduct.
	* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;Instanciates existing product and agregates it to this.
    * @param iProduct
    *      reference product to add. 
	*	   the reference has to be in the same document.
    * @param iCont
    *      do not use.
    * @return
	*      the instance product added.
   	*/
   virtual CATIProduct_var                 AddProduct   (CATIProduct_var &amp; iProduct, const CATIContainer_var&amp; iCont=NULL_var) = 0;

   /**
	* Adds subproducts. 
	* &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;Instanciates them and agregates them to this.
    * @param iReferences
    *      list of reference products to add. 
	*	   &lt;br&gt; the references have to be in the same document.
    * @param iCont
    *      do not use.
    * @param oResult
	*      list of instance products added.
	*/
  virtual HRESULT                         AddProducts  (  const CATListValCATBaseUnknown_var&amp;   iReferences
	                                                     ,       CATIContainer_var&amp;              iCont
										                 ,		 CATListValCATBaseUnknown_var*&amp;  oResult ) = 0;
   
   /**
	* Creates new product and adds it as subproduct.
    * @param iString
    *      part number of the subproduct to create.
    * @param cont
    *      do not use.
    * @return 
	*      the instance product added.
   	*/
   virtual CATIProduct_var                 AddProduct   (const CATUnicodeString&amp; iString, const CATIContainer_var&amp; cont = NULL_var) = 0;
   
     
   /**
    * @nodoc
	* The ReplaceProduct method allows to replace an instance
	* return code : 1 : success
	*               0 : OldInstance is not part of &quot;this&quot; product
    */
   virtual int      ReplaceProduct  (  CATIProduct_var &amp; OldInstance
									 , CATIProduct_var &amp; NewInstanceReference
									 , CATIProduct_var &amp; NewInstance) = 0;

   /**	
	* Returns the instance of this in context.
	* @param iProduct
	*        product context where to seek instance.
	* @return
	*        the instance of this in the given context.
	*/	
   virtual CATIProduct_var                 FindInstance (const CATIProduct_var&amp; iProduct ) = 0;

   /**	
	* Determine whether a product is a reference or not.
	* @return 
	*     S_OK if this is a reference
	*    &lt;br&gt; E_FAIL if not.
    */	
   virtual HRESULT IsReference() = 0;

   
   //-----------------------------------------------------------------
   // Representation Management.
   //-----------------------------------------------------------------

   /**
	* Adds a representation to the product with a specific behavior.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;A representation is the object that gives a geometric shape and allows
    * the visualization of the product. It can be a CATIA V4 model, a VRML or CGR file , or 
	* the part feature of a part document ( in this case we are just allowed to browse it, not
	* to add ).
    * @param iObj
	*    Geometric shape referenced by the representation
	* @param iShapeName
    *    The name that is given to the representation
	*    &lt;br&gt;This name is a user free choice
    * @param Id
    *   The behavior of the added representation.
	*   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
	*   &lt;br&gt; CATPrd3D if the representation is a 3D one,
    *   &lt;br&gt; CATPrd2D if the representation is a 2D one,
    *   &lt;br&gt;or CATPrdText if the representation is a text one.
	* @param iInCtxt
    *   do not use 
    */	
   virtual int /*HRESULT*/ AddShapeRepresentation(CATILinkableObject_var &amp; iObj,
	  const CATUnicodeString&amp; iShapeName = NULL_string, 
	  const CATRepMode &amp; Id = CATPrd3D,
	  const CATBoolean iInCtxt = TRUE)=0;

   /**
	* Adds a representation to the product with a specific behavior.
    * &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt; the representation is defined here by a document.
    * @param iType
	*      type of file where the representation can be found. 
	*   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
	*       model, VRML, cgr, but not CATPart.
    * @param iPath
	*   The path name where the representation can be found
	* @param iAltShapeName
    *   The name that is given to the representation
    *   This name is a user free choice
    * @param Id
    *   The behavior of the added representation.
	*   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
	*   &lt;br&gt;CATPrd3D if the representation is a 3D one,
    *   &lt;br&gt;CATPrd2D if the representation is a 2D one,
    *   &lt;br&gt;or CATPrdText if the representation is a text one.
	* @param iInCtxt
    *    do not use 
    */	
    virtual int /*HRESULT*/ AddShapeRepresentation(const CATUnicodeString&amp; iType,
			     const CATUnicodeString&amp; iPath,
			     const CATUnicodeString&amp; iAltShapeName = NULL_string,
				 const  CATRepMode &amp; Id = CATPrd3D,
				 const CATBoolean iInCtxt = TRUE)=0;

   /**
	* @nodoc.
	*/	
   virtual HRESULT SetDefaultRep(const CATUnicodeString &amp; iShapeName,
				   const CATRepMode &amp; Id = CATPrd3D,
				   const CATBoolean InCtxt = TRUE)=0 ;

   /**
	* @nodoc.
	*/	
  virtual HRESULT GetDefaultRepName(CATUnicodeString &amp; iShapeName,
									const CATRepMode &amp; Id = CATPrd3D,
									const CATBoolean InCtxt = TRUE)=0 ;


   /**
    * Returns whether the product has a representation of the given name with a given behavior.
 	* @param iShapeName
    *   The name of the representation of the product we search for.
	* @param Id
    *   The behavior of the representation.
	*   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
	*   &lt;br&gt;CATPrd3D if the representation is a 3D one,
    *   &lt;br&gt;CATPrd2D if the representation is a 2D one,
    *   &lt;br&gt;or CATPrdText if the representation is a text one.
	* @param InCtxt
    *    do not use 
    * @return
	*   an HRESULT
	*   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:S_OK if the product has such a representation. 
    */
   virtual HRESULT IsAssociatedToShape(const CATUnicodeString &amp; iShapeName,
				   const CATRepMode &amp; Id = CATPrd3D,
				   const CATBoolean InCtxt = TRUE)=0 ;

    /**
     * Removes a specific representation from the product.
	 * @param iShapeName
     *   The name of the representation to remove.
	 * @param Id
     *   The behavior of the representation.
     *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
	 *    &lt;br&gt;CATPrd3D if the representation is a 3D one,
     *   &lt;br&gt;CATPrd2D if the representation is a 2D one,
     *   &lt;br&gt;or CATPrdText if the representation is a text one.
	 * @param InCtxt
     *    do not use 
     */
   virtual HRESULT RemoveShapeRep(const CATUnicodeString &amp; iShapeName,
	  const CATRepMode &amp; Id = CATPrd3D,
	  const CATBoolean InCtxt = TRUE)=0;

     /**
     * Retrieves the product&#x27;s representation by its name.
     * @param oLinkShape
     *   geometry associated to the given representation.
	 * @param iShapeName
     *   The name of the representation of the product.
	 * @param Id
     *   The behavior of the representation.
	 *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
	 *   &lt;br&gt; CATPrd3D if the representation is a 3D one,
     *   &lt;br&gt; CATPrd2D if the representation is a 2D one,
     *   &lt;br&gt; or CATPrdText if the representation is a text one.
	 * @param InCtxt
     *    do not use 
	 * @return
	 *   an HRESULT
     *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;: S_OK if the shape is found.
     */
   virtual HRESULT GetShapeRep(CATILinkableObject_var &amp; oLinkShape,
	  const CATUnicodeString &amp; iShapeName=&quot;Default&quot;,
	  const CATRepMode &amp; Id = CATPrd3D,
	  const CATBoolean InCtxt = TRUE,
	  const CATBoolean ILoadIfNecessary = FALSE) =0;
  
    /**
     * Lists the product&#x27;s  representations.
     * @param oList
     *    list of names of the representations associated to the product.
	 * @param Id
     *   The behavior of the representation.
	 *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;:
	 *   &lt;br&gt; CATPrd3D if the representation is a 3D one,
     *   &lt;br&gt; CATPrd2D if the representation is a 2D one,
     *   &lt;br&gt; or CATPrdText if the representation is a text one.
	 * @param InCtxt
     *    do not use 
	 * @return
	 *   an HRESULT
     *   &lt;br&gt;&lt;b&gt;Legal values&lt;/b&gt;: S_OK if there is representation.
     */
   virtual HRESULT ListShapeRep(CATListValCATUnicodeString* &amp; oList, 
	   const CATRepMode &amp; Id = CATPrd3D,
	  const CATBoolean InCtxt = TRUE)=0 ;


  /**
    * @nodoc
    */
  virtual HRESULT GetRepresentation(CATUnicodeString &amp; iShapeName,
									CATIPrdRepresentation_var&amp; oRep,
									const CATRepMode &amp; Id = CATPrd3D,
									const CATBoolean InCtxt = TRUE)=0;
	


    //-----------------------------------------------------------------
    // ShapeRepresentation from a Discipline (Deprecated)
    //-----------------------------------------------------------------

    /**
     * @nodoc
     */
  virtual int IsAssociatedToShape(int LookForAlternate=-1) = 0;

	/**
	 * @nodoc
     */
  virtual void RemoveShapeRep(int index= -1) = 0;
	
    /**
     * @nodoc
     */
  virtual CATILinkableObject_var GetShapeRep(int index = 0) = 0;
	
    /**
     * @nodoc
     */
  virtual CATListValCATUnicodeString*	ListAlternateShapeRep() = 0;


   //-----------------------------------------------------------------
   // Disciplines (access CATIPrdDiscipline) ( Deprecated )
   //-----------------------------------------------------------------
    /**
     * @nodoc
     */
  virtual CATIPrdDiscipline_var GetDiscipline(  const CATUnicodeString&amp; iDisciplineName
					       , CATBoolean                 iCreateIfNecessary = TRUE)=0;

    /**
     * @nodoc
     */
  virtual HRESULT               AddDiscipline(   const  CATUnicodeString&amp; iDisciplineName
						, CATISpecObject_var&amp; iRefDiscipline 
				                , CATIPrdDiscipline_var &amp;oDiscipline) = 0;
    /**
     * @nodoc
     */
  virtual CATListValCATBaseUnknown_var* ListDisciplines() = 0;

  
   //-----------------------------------------------------------------
   // Connectors management                            
   //-----------------------------------------------------------------
    /**
	* Adds connector by agregating it to the product.
    * @param iObj 
    *      object refered by the connector.
	* @param iConnectorDefinition
    *      optionnal argument.
	*      &lt;br&gt; reference of the created connector.
    * @return
	*      the connector.
   	*/
   virtual CATIConnector_var AddConnector(CATILinkableObject_var &amp; iObj,const CATIConnector_var &amp; iConnectorDefinition = NULL_var)=0;

   /**
	* Returns connector.
	* &lt;br&gt;&lt;b&gt; Note: &lt;/b&gt; The connector returned is one of all connectors owned by the product which refers obj.
	* @param iObj 
    *      object refered by the searched connector.
    */
   virtual CATIConnector_var GetConnector(CATILinkableObject_var &amp; iObj)=0;
  

  //-----------------------------------------------------------------
  // Instance Name Management                           
  //-----------------------------------------------------------------
    /**
	* Returns the name of a product instance.
	* &lt;br&gt;&lt;b&gt;Note:&lt;/b&gt; InstanceName is valid for instance products only.
	* @param oName
    *      name of the instance.
    */
   virtual HRESULT GetPrdInstanceName( CATUnicodeString &amp; oName ) = 0;

   /**
	* Sets a name on a product instance.
	* &lt;br&gt;&lt;b&gt;Note:&lt;/b&gt; InstanceName is valid for instance products only.
	* @param iName
    *      name of the instance.
	* @return 
	*      E_FAIL if the father of this ever has an instance with iName name.
    */
   virtual HRESULT SetPrdInstanceName( const CATUnicodeString iName ) = 0;
  
   //-----------------------------------------------------------------
   // Identification and attributes management                            
   //-----------------------------------------------------------------
   /**
	* Returns the name of a product reference.
	* &lt;br&gt;&lt;b&gt;Note:&lt;/b&gt; PartNumber is valid for reference products only.
	* @return 
    *      name of the reference.
    */
  virtual CATUnicodeString     GetPartNumber() const = 0;

   /**
	* Sets the name on a product reference.
	* &lt;br&gt;&lt;b&gt;Note:&lt;/b&gt; PartNumber is valid for reference products only.
	* @param iPartNumber
    *      name of the reference.
    */
  virtual void                 SetPartNumber( const CATUnicodeString &amp; iPartNumber ) = 0;
 
   //-----------------------------------------------------------------
   // Journaling
   //-----------------------------------------------------------------
  /**
    * @nodoc
    */
  virtual CATNamingReference* GetNamingReference() const = 0; 

   //-----------------------------------------------------------------
   // Filtering
   //-----------------------------------------------------------------
  /**
    * @nodoc
    */
  virtual void    SetScanId(const FilterMode Mode, const CLSID &amp;NewId) = 0; 
  /**
    * @nodoc
    */
  virtual CLSID GetScanId(const FilterMode Mode) const = 0; 

  // -----------------------------------------------------------------
  // Management of context
  // -----------------------------------------------------------------
  // A context is one instance from &quot;this&quot; reference
  // To each context, one can associate some objects
  // The only supported objects at this time are connectors
  //------------------------------------------------------------------
  /**
    * @nodoc
    */
  virtual int  GetContextCount() = 0;

  /**
    * @nodoc
    */
  virtual HRESULT GetContext( int ContextIndex
							, CATIProduct*&amp; oCtx) = 0;

  /**
    * @nodoc
    */
  virtual HRESULT AddContext( CATIProduct* iCtx , int&amp; CtxIndex)  = 0;
  /**
    * @nodoc
    */
  virtual HRESULT RemoveContext( int ContextIndex ) = 0;

  /**
    * @nodoc
    */
  virtual HRESULT AddObjectToContext ( int             ContextIndex
	                                 , CATBaseUnknown* iObject ) = 0;
  /**
    * @nodoc
    */
  virtual HRESULT RemoveObjectFromContext ( int             ContextIndex
	                                      , CATBaseUnknown* iObject ) = 0;
  /**
    * @nodoc
    */
  virtual HRESULT GetObjectsFromContext( int             ContextIndex
	                                   , CATListValCATBaseUnknown_var*&amp; oList ) = 0;   

  
};


#endif 



















</div>
    
    <div class="navigation">
        <div><a href="CATIPrdRepresentation.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIPrdRepresentation.h</a></div>
        <div><a href="CATIProductFileSelection.html">‰∏ã‰∏ÄÈ°µ: CATIProductFileSelection.h ‚Üí</a></div>
    </div>
</body>
</html>