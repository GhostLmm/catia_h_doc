<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InteractiveInterfaces/PublicInterfaces/CATIFmuDocChooser.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>InteractiveInterfaces/PublicInterfaces/CATIFmuDocChooser.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATIFmuDialogFactory.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIFmuDialogFactory.h</a></div>
        <div><a href="CATIIcon.html">‰∏ã‰∏ÄÈ°µ: CATIIcon.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">/* -*-c++-*- */
#ifndef _CATIFmuDocChooser_h
#define _CATIFmuDocChooser_h
// COPYRIGHT DASSAULT SYSTEMES 2002, All rights reserved

/**
 * @CAA2Level L0
 * @CAA2Usage U0
 */


//--------------------------------------------------------------------------
// Document Acquisition Method
//--------------------------------------------------------------------------

#include &quot;CATFmuBasicDocChooser.h&quot;

class CATCommand;
class CATNotification;
class CATUnicodeString;
class CATString;
class CATListPtrCATIDocId;
class CATFmuDocChooserOptions;
class CATDialog;

/**
 * User interface for document selection.
 * &lt;b&gt;Role&lt;/b&gt;: The user can choose one or many documents in an environment.
 * The document chooser is hidden until you call @href #SetVisibility &lt;tt&gt;(CATDlgShow)&lt;/tt&gt;.
 * Please call @href #SetFilterStrings, @href #SetActiveFilterIndex, @href #SetTitle before calling @href #SetVisibility &lt;tt&gt;(CATDlgShow)&lt;/tt&gt;.&lt;br&gt;
 * If the caller is a @href CATCommand and not a @href CATDialog, you should call&lt;pre&gt;
 *    CATCommand *pCmd = NULL;
 *    HRESULT hr = pDocChooser-&gt;GetEventPublisher(pCmd);
 *    if (SUCCEEDED(hr) &amp;&amp; CATSysCheckExpression(pCmd != NULL))
 *      pCmd-&gt;SetFather(&lt;the caller&gt;);&lt;/pre&gt;
 * in order to let the caller recieve the notifications.&lt;br&gt;
 * WARNING for modal window opened during the event OK or CANCEL:&lt;br&gt;
 * You may open a pop-up window in order to warn the user or ask him what to do. For example, you may explain why the selected
 * document is refused with an error window. Take care to parent your modal window with the one returned by
 * @href #GetActiveWindow. If you don&#x27;t, the window hierarchy may be broken (known Dialog limitation).
 */
// Note for implementation
// -----------------------
// It&#x27;s recommended to implement this interface by deriving CATEFmuDocChooser.
// Nevertheless, if you implement this interface with an object that derives from CATCommand (Dialog...) whose destruction is performed by
// CATCommand::RequestDelayedDestruction(), you have:
// - to call AddRef() in the constructor -&gt; m_cRef = 2
// - to derive the method Release():
//   ULONG xxx::Release()
//   {
//     int NbRef = yyy::Release(); // Call the superclass&#x27;s method (class xxx : public yyy)
//     if (NbRef == 1)
//       RequestDelayedDestruction(); // -&gt; When the destruction will occur, a release will be run -&gt; m_cRef == 0 -&gt; destruction.
//   }

#include &quot;CATInteractiveInterfaces.h&quot;
#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATInteractiveInterfaces IID IID_CATIFmuDocChooser;
#else
extern &quot;C&quot; const IID IID_CATIFmuDocChooser;
#endif

class ExportedByCATInteractiveInterfaces CATIFmuDocChooser : public CATFmuBasicDocChooser
{
public:
  CATDeclareInterface;

#ifdef COMPILO_TIE_OK // The TIE compiler aggregates CATFmuBasicDocChooser and CATIFmuDocChooser !

  /**
   * Gets the count of the selected documents.
   * @param oSelectionCount
   *   The number of selected documents.
   * @return
   *   Error code.
   */
  virtual HRESULT GetSelectionCount(int &amp;oSelectionCount) const = 0;

  /**
   * Gets the selected documents identifiers.
   * @param oListOfDocId
   *   The list of the documents identifiers the user chooses (&lt;tt&gt;CATIDocId&lt;/tt&gt;).&lt;br&gt;
   *   The input list must be empty.&lt;br&gt;
   *   No element of the output list can be NULL.&lt;br&gt;
   *   Before destroying the list, you have to call &lt;tt&gt;Release&lt;/tt&gt; on each element of the list.
   * @return
   *   Error code.
   */
  virtual HRESULT GetSelectedDocId(CATListPtrCATIDocId &amp;oListOfDocId) const = 0;

  /**
   * Sets the selection&#x27;s available options.
   * @param iOptions
   *   The options definition or restriction
   * @return
   *   Error code.
   */
  virtual HRESULT SetOptions(const CATFmuDocChooserOptions &amp;iOptions) = 0;

  /**
   * Gets the selection&#x27;s options.
   * @param oOptions
   *   The returned options (ReadOnly...).
   * @return
   *   Error code.
   */
  virtual HRESULT GetOptions(CATFmuDocChooserOptions &amp;oOptions) const = 0;

  /**
   * Sets the type filter combo strings.
   * @param iTypeDescriptionList
   *   The type filter descriptions array.
   * @param iTypeExtensionsList
   *   The type filter extensions array.
   * @param iTypeFilterCount
   *   The type filter count.
   * @return
   *   Error code.
   */
  virtual HRESULT SetFilterStrings(
    CATUnicodeString *iTypeDescriptionList,
    CATString *iTypeExtensionsList,
    int iTypeFilterCount) = 0;

  /**
   * Set the active item in the type filter combo.
   * @param iActiveFilter
   *   The active filter.
   * @return
   *   Error code.
   */
  virtual HRESULT SetActiveFilterIndex(int iActiveFilter) = 0;

  /**
   * Get the active item in the type filter combo.
   * @param oActiveFilter
   *   The currently active filter.
   * @return
   *   Error code.
   */
  virtual HRESULT GetActiveFilterIndex(int&amp; oActiveFilter) const = 0;

  /**
   * Sets the title of the dialog object to the specified character string.
   * @param iTitle
   *   The title to be displayed.
   * @return
   *   Error code.
   */
  virtual HRESULT SetTitle(const CATUnicodeString &amp;iTitle) = 0;

#endif // COMPILO_TIE_OK

  /**
   * Returns the current display state of the dialog object.
   * @param oState
   *   The visibility state can be:
   *   &lt;dl&gt;
   *   &lt;dt&gt;&lt;tt&gt;CATDlgShow&lt;/tt&gt;&lt;dd&gt; if the dialog object is shown,
   *   &lt;dt&gt;&lt;tt&gt;CATDlgHide&lt;/tt&gt;&lt;dd&gt; if the dialog object is hidden.
   *   &lt;/dl&gt;
   * @return
   *   Error code.
   */
  virtual HRESULT GetVisibility(unsigned long &amp;oState) const = 0;

  /**
   * Sets the display state of the dialog object.
   * @param iState
   * The visibility state to set.
   *   &lt;br&gt;
   *   &lt;b&gt;Legal values&lt;/b&gt; : It can be set to either :
   *   &lt;dl&gt;
   *   &lt;dt&gt;&lt;tt&gt;CATDlgShow&lt;/tt&gt;&lt;dd&gt; to show the dialog object,
   *   &lt;dt&gt;&lt;tt&gt;CATDlgHide&lt;/tt&gt;&lt;dd&gt; to hide the dialog object.
   *   &lt;/dl&gt;
   * @return
   *   Error code.
   */
  virtual HRESULT SetVisibility(unsigned long iState) = 0;

  /**
   * Gets the event publisher.
   * @param opEventPublisher
   *   The event publisher.&lt;br&gt;
   *   Call neither &lt;tt&gt;Release&lt;/tt&gt; nor delete.
   * @return
   *   Error code.
   */
  virtual HRESULT GetEventPublisher(CATCommand *&amp;opEventPublisher) const = 0;

  /**
   * Gets the ok notification.
   * @param opDiaOKNotification
   *   The ok notification.w&lt;br&gt;
   *   Call neither &lt;tt&gt;Release&lt;/tt&gt; nor delete.
   * @return
   *   Error code.
   */
  virtual HRESULT GetDiaOKNotification(CATNotification *&amp;opDiaOKNotification) const = 0;

  /**
   * Gets the cancel notification.
   * @param opDiaCANCELNotification
   *   The cancel notification.&lt;br&gt;
   *   Call neither &lt;tt&gt;Release&lt;/tt&gt; nor delete.
   * @return
   *   Error code.
   */
  virtual HRESULT GetDiaCANCELNotification(CATNotification *&amp;opDiaCANCELNotification) const = 0;

  /**
   * Gets the active window.
   * @param opActiveWindow
   *   The document chooser&#x27;s active window. You may use it to parent a modal window for the OK or CANCEL event.
   * @return
   *   Error code
   */
  virtual HRESULT GetActiveWindow(CATDialog *&amp;opActiveWindow) const = 0;
};

#endif
</div>
    
    <div class="navigation">
        <div><a href="CATIFmuDialogFactory.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATIFmuDialogFactory.h</a></div>
        <div><a href="CATIIcon.html">‰∏ã‰∏ÄÈ°µ: CATIIcon.h ‚Üí</a></div>
    </div>
</body>
</html>