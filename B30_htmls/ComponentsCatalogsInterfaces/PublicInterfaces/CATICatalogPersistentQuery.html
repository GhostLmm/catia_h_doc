<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ComponentsCatalogsInterfaces/PublicInterfaces/CATICatalogPersistentQuery.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ComponentsCatalogsInterfaces/PublicInterfaces/CATICatalogPersistentQuery.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="CATICatalogLink.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATICatalogLink.h</a></div>
        <div><a href="CATICatalogQuery.html">‰∏ã‰∏ÄÈ°µ: CATICatalogQuery.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">/* -*-c++-*- */
#ifndef CATICatalogPersistentQuery_H
#define CATICatalogPersistentQuery_H
// COPYRIGHT Dassault Systemes 2001
/**
* @CAA2Level L1
* @CAA2Usage U3
*/


#include &quot;CATCclInterfaces.h&quot;
#include &quot;CATBaseUnknown.h&quot;
#include &quot;CATUnicodeString.h&quot;
#include &quot;booleanDef.h&quot;
#include &quot;CATBoolean.h&quot;

class CATICatalogChapter;
class CATICkeExpression;
class CATICatalogQueryResult;
class CATListValCATICatalogDescription_var;
class CATTime;

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedByCATCclInterfaces IID IID_CATICatalogPersistentQuery ;
#else
extern &quot;C&quot; const IID IID_CATICatalogPersistentQuery ;
#endif

/**
* Interface to manage a persistent query.
* &lt;b&gt;Role&lt;/b&gt;:The persistent query is used for creating a new family of 
* descriptions. The @href CATICatalogChapter#AddPersistentQuery method
* enables to create an &quot;empty&quot; query. This method returns a pointer on this
* interface to complete and execute the query:
* &lt;ul&gt;
* &lt;li&gt;@href #SetResolutionChapter &lt;/li&gt;
* &lt;p&gt;It is the root chapter of the catalog to filter. &lt;/p&gt;
* &lt;li&gt;@href #SetExpression &lt;/li&gt;
* &lt;p&gt;It is the expression of the query &lt;p&gt;
* &lt;li&gt;@href #ResolveQuery &lt;/li&gt;
* &lt;p&gt;It launches the filtering on the external root chapter.
* &lt;/ul&gt; 
* The result, that you have as output argument of the
* @href #ResolveQuery method, by the @href #GetGeneratedQueryResult method or by
* the @href #GetListGeneratedDescriptions, are descriptions of the external catalog.
*  
* &lt;p&gt;For each external description resolving the expression, a description is created on the
* family which has this persistent query. The only one keyword automatically valuated on 
* this family is the &quot;Name&quot; keyword.&lt;/p&gt;
* &lt;p&gt; It is possible for each persistent query of a family to set new default values on 
* each keywords of this family. It means that the value of a keyword of a description
* of such family can be:
* &lt;ul&gt;
* &lt;li&gt;The own value of the keyword, set by the @href CATICatalogDescription#SetValue method&lt;/li&gt;
* &lt;li&gt;if no own value, the default value set by the @href #SetDefaultValue 
*  method of this interface&lt;/li&gt;
* &lt;li&gt;otherwise, the default value set on the family by the 
*  @href CATICatalogChapter#SetDefaultValue method &lt;/li&gt;
* &lt;/ul&gt;&lt;/p&gt;
*/

class ExportedByCATCclInterfaces CATICatalogPersistentQuery: public CATBaseUnknown
{
  CATDeclareInterface;

  public:
   /**
    *   Returns the chapter which contain this current persistent query.
    *   @return
    *      The chapter containing this query.
    */
   virtual CATICatalogChapter* GetChapter () = 0 ;

   /**
    *   Retrieves the chapter on which the query would be solved.
    *   @param oChapter
    *      The chapter on which the query would be solved.
    *   @param iMode
    *      0: search chapter only in session.&lt;/br&gt;
    *      1: default try to load chapter.
    */
   virtual HRESULT GetResolutionChapter (CATICatalogChapter*&amp; oChapter, int iMode=1) = 0 ;

   /**
    *   Sets the chapter on which the query would be solved to the current query.
    *   &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;It is the root chapter of an another catalog.
    *   @param iChapter
    *      The chapter on which the query would be solved.
    */
   virtual HRESULT SetResolutionChapter (CATICatalogChapter* iChapter) = 0 ;

   /**
    *   Retrieves the knowledge expression defining the query.
    *   @param oExpression
    *      The defined query expression.
    */
   virtual HRESULT GetExpression (CATUnicodeString&amp; oExpression) = 0 ;

   /**
   *   Sets the knowledge expression defining the query.
   *   @param iExpression
   *      The defined query expression.
   */
   virtual HRESULT SetExpression (const CATUnicodeString&amp; iExpression) = 0 ;

   /**
    *   Resolves the query that is defined by the knowledge expression.
    *   @param iResolveMode
    *      Options to output the result of the query: &lt;/br&gt;
    *           0 = Simuluation : generate the result in the output list only.&lt;/br&gt;
    *           1 = Generation  : the generated result will be output and stored 
    *                             in the document.
    *   @param ListOfDescriptions
    *      The output list of the generated result.
    */
   virtual HRESULT ResolveQuery (const int iResolveMode,
                                 CATListValCATICatalogDescription_var*&amp; ListOfDescriptions ) = 0 ;

   /**
    *   Retrieves the time/date of the resulting descriptions when the query is resolved.
    *   @param oResolutionTime
    *      The query resolved time stamp.
    */
   virtual HRESULT GetResolutionDate(CATTime&amp; oResolutionTime) = 0 ;

   /**
    *   Sets the time/date of the resulting descriptions when the query is resolved.
    *   @param oResolutionTime
    *      The query resolved time stamp to be set.
    */
   virtual HRESULT SetResolutionDate(const CATTime &amp;iResolutionTime) = 0 ;

   /**
    *   Retrieves the list of the resulting descriptions.
    *   &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method retrieves the descriptions which have resolved
    *   the query. The other way is to use the @href #GetGeneratedQueryResult method
    *   @param oListOfGeneratedDescriptions
    *      The generated list of description. 
    */
   virtual HRESULT GetListGeneratedDescriptions(CATListValCATICatalogDescription_var*&amp; oListOfGeneratedDescriptions) = 0 ;

   /**
    *   Retrieves the result of the resolved query.
    *   &lt;br&gt;&lt;b&gt;Role:&lt;/b&gt;This method retrieves the descriptions which have resolved
    *   the query. The other way is to use the @href #GetListGeneratedDescriptions method
    *   @param oQueryResult
    *      The generated descriptions.
    */
   virtual HRESULT GetGeneratedQueryResult(CATICatalogQueryResult*&amp; oQueryResult) = 0 ;

   /**
    *   Sets keyword Default Value for resolved attribute (integer).
    *   @param ikwdName
    *      The name of the keyword. It is a keyword of the family which
    *       contains this persistent query.
    *   @param odefaultValue
    *      The default value for the keyword.
    */
   virtual HRESULT SetDefaultValue (const CATUnicodeString &amp; ikwdName,
      int                      odefaultValue) = 0 ;

      /**
    *   Sets keyword Default Value for resolved attribute (real).
    *   @param ikwdName
    *      The name of the keyword.It is a keyword of the family which
    *       contains this persistent query.
    *   @param odefaultValue
    *      The default value for the keyword.
    */
   virtual HRESULT SetDefaultValue (const CATUnicodeString &amp; ikwdName,
                                    double                   odefaultValue) = 0 ;

      /**
    *   Sets keyword Default Value for resolved attribute (boolean).
    *   @param ikwdName
    *      The name of the keyword.It is a keyword of the family which
    *       contains this persistent query.
    *   @param odefaultValue
    *      The default value for the keyword.
    */
   virtual HRESULT SetDefaultValue (const CATUnicodeString &amp; ikwdName,
                                    CATBoolean                  odefaultValue) = 0 ;

      /**
    *   Sets keyword Default Value for resolved attribute (string).
    *   @param ikwdName
    *      The name of the keyword.It is a keyword of the family which
    *       contains this persistent query.
    *   @param odefaultValue
    *      The default value for the keyword.
    */
   virtual HRESULT SetDefaultValue (const CATUnicodeString &amp; ikwdName,
                                    CATUnicodeString       &amp; odefaultValue) = 0 ;

  // No constructors or destructors on this pure virtual base class
  // --------------------------------------------------------------

   //-----------------------------------------------------------------------
   // methods nodoc or deprecated
   //-----------------------------------------------------------------------
   
    /**
    * @nodoc
    *   Retrieves the knowledge expression that the query is to defined.
    *   @param oExpression
    *      The defined query expression.
    */
   virtual HRESULT GetExpression (CATICkeExpression*&amp; oExpression) = 0 ;

   /**
    * @nodoc
    *   Sets the knowledge expression that the query is to be defined.
    *   @param iExpression
    *      The defined query expression.
    */
   virtual HRESULT SetExpression (CATICkeExpression* iExpression) = 0 ;
  
};
CATDeclareHandler( CATICatalogPersistentQuery, CATBaseUnknown );

//------------------------------------------------------------------

#endif
</div>
    
    <div class="navigation">
        <div><a href="CATICatalogLink.html">‚Üê ‰∏ä‰∏ÄÈ°µ: CATICatalogLink.h</a></div>
        <div><a href="CATICatalogQuery.html">‰∏ã‰∏ÄÈ°µ: CATICatalogQuery.h ‚Üí</a></div>
    </div>
</body>
</html>