<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNBHumanModelingInterfaces/PublicInterfaces/SWKIRULASpecs.h</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .navigation a {
            color: #2980b9;
            text-decoration: none;
            padding: 5px 10px;
            background-color: white;
            border-radius: 3px;
            border: 1px solid #bdc3c7;
        }
        .navigation a:hover {
            background-color: #3498db;
            color: white;
        }
        .content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
            overflow-x: auto;
        }
        .back-to-index {
            text-align: center;
            margin: 15px 0;
        }
        .back-to-index a {
            color: #27ae60;
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>DNBHumanModelingInterfaces/PublicInterfaces/SWKIRULASpecs.h</h1>
    </div>
    
    <div class="navigation">
        <div><a href="SWKIPrefAngle.html">‚Üê ‰∏ä‰∏ÄÈ°µ: SWKIPrefAngle.h</a></div>
        <div><a href="SWKISegment.html">‰∏ã‰∏ÄÈ°µ: SWKISegment.h ‚Üí</a></div>
    </div>
    
    <div class="back-to-index">
        <a href="index.html">üìÅ ËøîÂõûÁõÆÂΩï</a>
    </div>
    
    <div class="content">// COPYRIGHT DASSAULT SYSTEMES 2004

#ifndef SWKIRULASpecs_h
#define SWKIRULASpecs_h

/**
 * @CAA2Level L0
 * @CAA2Usage U0
 */

// *****************************************************************************
// Framework DNBHumanModelingInterfaces
// Copyright Safework Inc.
// *****************************************************************************
//  Abstract:
//  ---------
//
//    This interface is used to set up input specifications for the RULA 
//    ergonomic analysis.
//
// *****************************************************************************
//  Usage:
//  ------
//
//    Use in conjunction with interface SWKIErgoAnalysis.
//
// *****************************************************************************
//  Inheritance:
//  ------------
//
//    CATBaseUnknown
//
// *****************************************************************************
//  Main Methods:
//  -------------
// 
//    SetSpec
//    GetScore
//    GetSpec
//    GetDefaultPercentage
//    Reset
//    GetNumberOfAngleRanges
//    GetAngleRangeAtIndex
//    GetColor
//    GetColor
//    IsArmAbducted
//    IsShoulderRaised
//    IsArmOutToSide
//    IsWristBent
//    IsWristTwisted
//    IsNeckTwisted
//    IsNeckSideBending
//    IsTrunkTwisted
//    IsTrunkSideBending
//    IsInWristAndArm
//    IsInNeckTrunkAndLeg
//    IsInRULAColoring
//    HasMaxScore
// *****************************************************************************
//  History
//  -------
//
//  Author: Jean-Guy AUGUSTIN
//  Date  : 04/09/09
//  Goal  : Creation
// *****************************************************************************
//
// --- System
#include &quot;CATBaseUnknown.h&quot;
#include &quot;CATBooleanDef.h&quot;
//
// --- DNBHumanModelingInterfaces
#include &quot;SWKEnums.h&quot;
#include &quot;SWShortNames.h&quot;
//
//
// --- DNBHumanModeling
class SWAnalysisResults;

#ifdef _WINDOWS_SOURCE
#ifdef __SWKHumanModelingItf
#define ExportedBySWKHumanModelingItf __declspec(dllexport)
#else
#define ExportedBySWKHumanModelingItf __declspec(dllimport)
#endif
#else
#define ExportedBySWKHumanModelingItf
#endif

#ifndef LOCAL_DEFINITION_FOR_IID
extern ExportedBySWKHumanModelingItf IID IID_SWKIRULASpecs;
#else
extern &quot;C&quot; const IID IID_SWKIRULASpecs;
#endif

/**
  * This interface is used to initialize the RULA specifications
  * for a RULA analysis to be conducted on a manikin.
  * A RULA specifications object is associated to one manikin.
  * The application may choose to run the RULA analysis with
  * the default values in the RULA specifications, or it
  * can customize the specifications by overriding the value of
  * one or several attributes.
  **/
class ExportedBySWKHumanModelingItf SWKIRULASpecs : public CATBaseUnknown
{
	CATDeclareInterface;

 public:

	enum SWKRULAScores
	{
		FinalUpperArmScore = 0,
		FinalForearmScore = 1,
		FinalWristScore = 2,
		FinalWristTwistScore = 3,
		FinalPostureAScore = 4,
		FinalMuscleScore = 5,
		FinalForceLoadScore = 6,
		FinalWristAndArmScore = 7,
		FinalNeckScore = 8,
		FinalTrunkScore = 9,
		FinalLegScore = 10,
		FinalPostureBScore = 11,
		FinalNeckTrunkAndLegScore = 12,
		FinalScoreOverall = 13
	};

	/**
	  * Set a score for a specific angle range on one body part.
	  *
	  * @param piBodyPart The body part
	  * @param piMinAngleValue The lower value of the range, in radians.
	  * @param piMaxAngleValue The upper value of the range, in radians.
	  * @param piScore The associated score, which must be a non-negative
	  * number between 1 and 6.
	  *
	  * @return A status indicating whether the input parameters are valid or not.
	  **/
	virtual HRESULT SetSpec(const SWKEBodyPart &amp; piBodyPart, double piMinAngleValue,
							double piMaxAngleValue, unsigned piScore) = 0;

	/**
	  * Set a value to a RULA-specific attribute.
	  *
	  * @param piRULAAttribute The RULA attribute to set.
	  * @param piValue The new value for the attribute.
	  *
	  * @return A status indicating whether the input parameters are valid or not.
	  **/
	virtual HRESULT SetSpec(const SWKERULAAttr &amp; piRULAAttribute, 
							const SWKERULAValue &amp; piValue) = 0;

	/**
	  * Set a value to a RULA-specific attribute.
	  *
	  * @param piRULAAttribute The RULA attribute to set.
	  * @param piValue The new value for the attribute.
	  *
	  * @return A status indicating whether the input parameters are valid or not.
	  **/
	virtual HRESULT SetSpec(const SWKERULAAttr &amp; piRULAAttribute, double piValue) = 0;

	/**
	  * Get the score corresponding to the segment &quot;piShortName&quot;
	  *
	  * @param piShortName The concerned body part.
	  * @param piResults Results coming from the call to
	  * &lt;code&gt;SWKIErgoAnalysis::PerformRULAAnalysis()&lt;/code&gt;.
	  * @param poScore The score corresponding to the segment, given as output.
	  *
	  * @return A status indicating whether the input parameters are valid or not.
	  **/
	virtual HRESULT GetScore(const SWShortName &amp; piShortName,
							 const SWAnalysisResults &amp; piResults, int &amp; poScore) const = 0;

	/**
	  * Get the score corresponding to the DOF value on the body.
	  *
	  * @param piBodyPart The concerned body part.
	  * @param poValue The current value found on the body, from which the score is calculated.
	  * @param poScore The score corresponding to that value, given as output.
	  *
	  * @return A status indicating whether the input parameters are valid or not.
	  **/
	virtual HRESULT GetScore(const SWKEBodyPart &amp; piBodyPart, double &amp; poValue, 
							 unsigned &amp; poScore) const = 0;

	/**
	  * Get the value of a special RULA attribute.
	  *
	  * @param piRULAAttribute The attribute name.
	  * @param poValue The value of that attribute, given as output.
	  *
	  * @return A status indicating whether the input parameters are valid or not.
	  **/
	virtual HRESULT GetSpec(const SWKERULAAttr &amp; piRULAAttribute,
							SWKERULAValue &amp; poValue) const = 0;

	/**
	  * Get the value of a special RULA attribute.
	  *
	  * @param piRULAAttribute The attribute name.
	  * @param poValue The value of that attribute, given as output.
	  *
	  * @return A status indicating whether the input parameters are valid or not.
	  **/
	virtual HRESULT GetSpec(const SWKERULAAttr &amp; piRULAAttribute, double &amp; poValue) const = 0;

	/**
	  * Get the default value of a special RULA attribute, as a percentage.
	  *
	  * @param piRULAAttribute The attribute name.
	  * @param poValue The percentage for that attribute, given as output.
	  *
	  * @return A status indicating whether the input parameters are valid or not.
	  **/
	virtual HRESULT GetDefaultPercentage(const SWKERULAAttr &amp; piRULAAttribute,
										 double &amp; poPercentage) = 0;

	/**
	  * Resets all the angle values of the RULA specs.&lt;br&gt;
	  * &lt;br&gt;
	  * &lt;strong&gt;N.B.&lt;/strong&gt; : Not all RULA inputs are reset by this method.
	  * The reset inputs include : ShoulderElevation, ArmAbduction, ArmRotation,
	  * WristDeviation, WristTwist, NeckTwist, NeckSideBend, TrunkTwist,
	  * TrunkSideBend, ShouldersSupported, WorkAcrossMidLine and CenterOfGravity.
	  **/
	virtual void Reset() = 0;

	/**
	  * @return The number of angle ranges for a specified body part.
	  *
	  * @param piBodyPart The body part for which the information is to be returned.
	  **/
	virtual unsigned GetNumberOfAngleRanges(const SWKEBodyPart &amp; piBodyPart) = 0;

	/**
	  * Retrieve the angle range at the specified index.
	  *
	  * @param piBodyPart The concerned body part.
	  * This parameter can only take the following values:
	  * SWKEBodyPartUpperArm, SWKEBodyPartForearm, SWKEBodyPartWrist,
	  * SWKEBodyPartNeck and SWKEBodyPartTrunk.
	  *
	  * @param piIndex The index of the range to be read.
	  * @param poMinValue The lower limit of the angle range read.
	  * @param poMaxValue The upper limit of the angle range read.
	  * @param poScore  The score associated with the range.
	  *
	  * @return A status indicating whether the input parameters are valid or not.
	  **/
	virtual HRESULT GetAngleRangeAtIndex(const SWKEBodyPart &amp; piBodyPart, unsigned piIndex,
										 double &amp; poMinValue, double &amp; poMaxValue,
										 unsigned &amp; poScore) const = 0;

	/**
	  * @return The color of the RULA analysis.
	  */
	virtual unsigned GetColor(const SWKIRULASpecs::SWKRULAScores &amp; piScore) const = 0;
	
	/**
	  * This function returns the color of the RULA analysis for a specific segment.
	  *
	  * @param piShortName The segment to find the color in the RULA analysis.
	  * @param piColoredValue To know if we are in General/Detailed mode.
	  * @return The color of the RULA analysis for the specific segment.
	  */
	virtual unsigned GetColor(const SWShortName &amp; piShortname,
					  SWKERULATypeColoring piColoredValue) const = 0;

	/**
	  * @return &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;true&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt;
	  * if the arm is abducted,
	  * &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;false&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt; otherwise.
	  *
	  * The arm used depends on the current side of study.
	  **/
	virtual boolean IsArmAbducted() const = 0;

	/**
	  * @return &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;true&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt;
	  * if the shoulder is raised,
	  * &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;false&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt; otherwise.
	  *
	  * The shoulder used depends on the current side of study.
	  **/
	virtual boolean IsShoulderRaised() const = 0;

	/**
	  * @return &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;true&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt;
	  * if the arm is out to the side of the body,
	  * &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;false&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt; otherwise.
	  *
	  * The arm used depends on the current side of study.
	  **/
	virtual boolean IsArmOutToSide() const = 0;

	/**
	  * @return &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;true&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt;
	  * if the wrist is bent,
	  * &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;false&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt; otherwise.
	  *
	  * The wrist used depends on the current side of study.
	  **/
	virtual boolean IsWristBent() const = 0;

	/**
	  * @return &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;true&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt;
	  * if the wrist is twisted,
	  * &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;false&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt; otherwise.
	  *
	  * The wrist used depends on the current side of study.
	  **/
	virtual boolean IsWristTwisted() const = 0;

	/**
	  * @return &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;true&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt;
	  * if the neck is twisted,
	  * &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;false&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt; otherwise.
	  **/
	virtual boolean IsNeckTwisted() const = 0;

	/**
	  * @return &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;true&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt;
	  * if the neck is side-bending,
	  * &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;false&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt; otherwise.
	  **/
	virtual boolean IsNeckSideBending() const = 0;

	/**
	  * @return &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;true&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt;
	  * if the trunk is twisted,
	  * &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;false&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt; otherwise.
	  **/
	virtual boolean IsTrunkTwisted() const = 0;

	/**
	  * @return &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;true&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt;
	  * if the trunk is side-bending,
	  * &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;false&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt; otherwise.
	  **/
	virtual boolean IsTrunkSideBending() const = 0;

	/**
	  * @return &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;true&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt;
	  * if piShortName is included in &quot;Wrist And Arm&quot; (Upperarm, Forearm, Wrist),
	  * &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;false&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt; otherwise.
	  *
	  * @param piShortName The short name of the segment to check.
	  **/
	virtual boolean IsInWristAndArm(const SWShortName &amp; piShortName) const = 0;

	/**
	  * @return &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;true&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt;
	  * if piShortName is included in &quot;Posture B&quot; (Neck, Trunk, Leg),
	  * &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;false&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt; otherwise.
	  *
	  * @param piShortName The short name of the segment to check.
	  **/
	virtual boolean IsInNeckTrunkAndLeg(const SWShortName &amp; piShortName) const = 0;

	/**
	  * @return &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;true&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt;
	  * if piShortName can be colored regarding the RULA Analysis,
	  * &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;false&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt; otherwise.
	  *
	  * @param piShortName The short name of the segment to check.
	  **/
	virtual boolean IsInRULAColoring(const SWShortName &amp; piShortName) const = 0;

	/**
	  * @return &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;true&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt;
	  * if piShortName has the max score value for the RULA analysis,
	  * &lt;code&gt;&lt;strong&gt;&lt;font color=&quot;blue&quot;&gt;false&lt;/font&gt;&lt;/strong&gt;&lt;/code&gt; otherwise.
	  *
	  * @param piShortName The short name of the segment to check.
	  * @param piResults Contains the results of the RULA analysis.
	  * @param piRULATypeColoring RULA type for coloring. If this is general, the function
	  *        should check score for &quot;Wrist and Arm&quot; or &quot;Neck, Trunk and Leg&quot;.
	  **/
	virtual boolean HasMaxScore(const SWShortName &amp; piShortName,
						const SWAnalysisResults &amp; piResults,
						const SWKERULATypeColoring &amp; piRULATypeColoring = SWKERULATypeColoringDetailed) const = 0;

	/**
	  *  Reserved for internal use.
	  **/
	virtual void * InternalSettings(void * piSettings = NULL) = 0;
};

CATDeclareHandler(SWKIRULASpecs, CATBaseUnknown);

#endif
</div>
    
    <div class="navigation">
        <div><a href="SWKIPrefAngle.html">‚Üê ‰∏ä‰∏ÄÈ°µ: SWKIPrefAngle.h</a></div>
        <div><a href="SWKISegment.html">‰∏ã‰∏ÄÈ°µ: SWKISegment.h ‚Üí</a></div>
    </div>
</body>
</html>